var F=(n,m,o)=>new Promise((t,r)=>{var c=a=>{try{p(o.next(a))}catch(i){r(i)}},g=a=>{try{p(o.throw(a))}catch(i){r(i)}},p=a=>a.done?t(a.value):Promise.resolve(a.value).then(c,g);p((o=o.apply(n,m)).next())});import{u as N,P as U,i as j,_ as A}from"./index-CsaBZZ8X.js";import{p as M,r as h,q as O,w as T,u as R,v as W,aQ as $,x as d,as as w,y as q,aC as z,aD as C,k as b,G as f,aX as B,z as E,A as P,aF as D,ae as x,bb as G,B as I,C as Q,az as X}from"./index-D5efkW8k.js";const H={class:"plus-drawer-form__footer"};var J=M({name:"PlusDrawerForm",__name:"index",props:{modelValue:{default:()=>({})},visible:{type:Boolean,default:!1},drawer:{default:()=>({})},size:{default:"540px"},form:{default:()=>({})},hasFooter:{type:Boolean,default:!0},cancelText:{default:""},confirmText:{default:""},confirmLoading:{type:Boolean,default:!1},hasErrorTip:{type:Boolean,default:!0}},emits:["update:modelValue","update:visible","confirm","change","cancel","confirmError"],setup(n,{expose:m,emit:o}){const t=n,r=o,{t:c}=N(),g=h(null),p=O(()=>{var e;return(e=g.value)==null?void 0:e.formInstance}),a=h(),i=h({}),v=h(!1);T(()=>t.visible,e=>{v.value=e},{immediate:!0}),T(()=>t.modelValue,e=>{i.value=e},{immediate:!0});const L=(e,s)=>{r("update:modelValue",e),r("change",e,s)},k=()=>F(null,null,function*(){var e,s,l;try{(yield(e=p.value)==null?void 0:e.validate())&&r("confirm",i.value)}catch(u){if(t.hasErrorTip){I.closeAll();const y=j(u)&&Object.values(u),_=y?(l=(s=y[0])==null?void 0:s[0])==null?void 0:l.message:void 0;I.warning(_||c("plus.form.errorTip"))}r("confirmError",u)}}),S=()=>{V(),r("update:visible",v.value),r("cancel")},V=()=>{v.value=!1};return m({drawerInstance:a,formInstance:p}),(e,s)=>(W(),R(f(G),D({ref_key:"drawerInstance",ref:a,modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=l=>v.value=l),class:"plus-drawer-form",size:e.size||"540px",title:f(c)("plus.drawerForm.title"),"close-on-click-modal":!1,"close-on-press-escape":!1},e.$attrs,{onClose:S}),$({default:d(()=>[b(f(U),D({ref_key:"formInstance",ref:g,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=l=>i.value=l),"has-footer":!1},e.form,{onChange:L}),$({_:2},[e.$slots["form-footer"]?{name:"footer",fn:d(()=>[w(e.$slots,"form-footer")]),key:"0"}:void 0,e.$slots["form-group-header"]?{name:"group-header",fn:d(l=>[w(e.$slots,"form-group-header",z(C(l)))]),key:"1"}:void 0,x(e.$slots,(l,u)=>({name:u,fn:d(y=>[w(e.$slots,u,z(C(y)))])}))]),1040,["modelValue"])]),_:2},[e.$slots["drawer-header"]?{name:"header",fn:d(()=>[w(e.$slots,"drawer-header")]),key:"0"}:void 0,e.hasFooter?{name:"footer",fn:d(()=>[q("div",H,[w(e.$slots,"drawer-footer",z(C({handleConfirm:k,handleCancel:V})),()=>[b(f(B),{onClick:V},{default:d(()=>[E(P(e.cancelText||f(c)("plus.drawerForm.cancelText")),1)]),_:1}),b(f(B),{type:"primary",loading:e.confirmLoading,onClick:k},{default:d(()=>[E(P(e.confirmText||f(c)("plus.drawerForm.confirmText")),1)]),_:1},8,["loading"])])])]),key:"1"}:void 0]),1040,["modelValue","size","title"]))}}),K=A(J,[["__file","index.vue"]]);const ae=K;function oe(){const n=h(520),m=()=>{const t=window.innerWidth;t>2080?n.value="25%":t>=520?n.value=520:n.value="90%"},o=()=>{m()};return Q(()=>{m(),window.addEventListener("resize",o)}),X(()=>{window.removeEventListener("resize",o)}),{drawerSize:n}}export{ae as P,oe as u};
