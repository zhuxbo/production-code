var Se=Object.defineProperty,Ie=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var ne=(z,s,d)=>s in z?Se(z,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):z[s]=d,oe=(z,s)=>{for(var d in s||(s={}))Ee.call(s,d)&&ne(z,d,s[d]);if(se)for(var d of se(s))He.call(s,d)&&ne(z,d,s[d]);return z},ae=(z,s)=>Ie(z,Me(s));var _t=(z,s,d)=>new Promise((u,i)=>{var l=v=>{try{w(d.next(v))}catch(k){i(k)}},c=v=>{try{w(d.throw(v))}catch(k){i(k)}},w=v=>v.done?u(v.value):Promise.resolve(v.value).then(l,c);w((d=d.apply(z,s)).next())});import{u as Bt,B as $e,O as Ce,C as Rt,m as kt,n as Wt,D as rt,o as jt,E as Oe,p as we,r as xe,F as Pe,k as ft,j as Mt,h as Et,G as Ut,f as Ht,d as Ot,e as he,g as Le,l as Ae,q as Be}from"./detail-DORHeSmr.js";import{p as R,N as $t,aK as M,q as K,r as A,l as _,F as f,v as r,ad as tt,k as o,x as n,z as m,A as a,G as t,aL as Nt,u as $,J as p,aM as qt,y as e,m as I,aN as vt,X as Kt,an as Pt,aO as it,f as lt,aP as Re,ae as It,_ as F,w as bt,g as We,C as ut,aQ as Zt,aR as je,aS as ze,aT as Ue,aU as De,T as Ne,aV as qe,aW as ht,j as W,aX as Ft,aY as at,e as Ke,aZ as Te,az as Gt,a_ as Fe,aa as Ge,a$ as St}from"./index-D5efkW8k.js";import{a as re}from"./psl-D8AmD7_c.js";import{v as Je,a as Jt}from"./product-CqZQfo2c.js";import"./isIP-De3RazRf.js";import"./dialog-DRVOK9xO.js";const Xe={class:"dialog-footer"},Ze=R({__name:"operate",setup(z){var D;const{toDetail:s}=Bt(),d=$t(),u=d.path,i=d.params,l=M("order"),c=M("cert"),w=M("sync"),v=M("get"),k=K(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),{action:y,openAction:b}=$e(),g=P=>{if(P)switch(P){case"send":Y.value=!0;break;case"commit":N();break;case"sync":w(!0);break;case"commitCancel":S();break;case"revokeCancel":E();break;case"renew":b("renew",l.id);break;case"reissue":b("reissue",l.id);break}},T=A((D=l==null?void 0:l.user)==null?void 0:D.email),Y=A(!1),j=()=>{Rt(l.id,T.value).then(()=>{Y.value=!1,I("发送成功",{type:"success"})})},N=()=>{kt(l.id).then(()=>{I("提交成功",{type:"success"}),v()})},S=()=>{vt.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let P=i.ids.toString().split(",");P.length>1?(P=P.filter(C=>C!==l.id.toString()),s({ids:P.join(",")},"params")):Pt.push({name:"Order"})}else rt(l.id).then(P=>{P.data.sync=it(),Object.assign(l,lt(P.data))})})})},E=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),rt(l.id).then(P=>{P.data.sync=it(),Object.assign(l,lt(P.data))})})};return(P,C)=>{const G=_("el-icon"),st=_("el-button"),q=_("el-dropdown-item"),ct=_("el-dropdown-menu"),V=_("el-dropdown"),x=_("el-input"),H=_("el-form-item"),J=_("el-dialog");return r(),f(tt,null,[o(V,{style:{"margin-top":"7px"},onCommand:g},{dropdown:n(()=>[o(ct,null,{default:n(()=>[t(c).status=="active"?(r(),$(q,{key:0,command:"send"},{default:n(()=>[...C[8]||(C[8]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(r(),$(q,{key:1,command:"commit"},{default:n(()=>[...C[9]||(C[9]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(r(),$(q,{key:2,command:"sync"},{default:n(()=>[...C[10]||(C[10]=[m(a("同步"),-1)])]),_:1})):p("",!0),k.value?(r(),$(q,{key:3,command:"commitCancel",divided:""},{default:n(()=>[...C[11]||(C[11]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(r(),$(q,{key:4,command:"revokeCancel"},{default:n(()=>[...C[12]||(C[12]=[m(a("撤回"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(r(),$(q,{key:5,command:"renew",divided:""},{default:n(()=>[...C[13]||(C[13]=[m(a("续费"),-1)])]),_:1})):p("",!0),["active","expired"].includes(t(c).status)?(r(),$(q,{key:6,command:"reissue",divided:""},{default:n(()=>[...C[14]||(C[14]=[m(a("重签"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(st,{type:"primary",size:"small"},{default:n(()=>[C[7]||(C[7]=m(a("操作")+" ",-1)),o(G,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(st,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:C[0]||(C[0]=O=>t(v)(!0))},{default:n(()=>[o(G,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(qt))]),_:1})]),_:1}),o(J,{modelValue:Y.value,"onUpdate:modelValue":C[4]||(C[4]=O=>Y.value=O),title:"发送邮件"},{footer:n(()=>[e("span",Xe,[o(st,{onClick:C[2]||(C[2]=O=>Y.value=!1)},{default:n(()=>[...C[15]||(C[15]=[m(a("取消"),-1)])]),_:1}),o(st,{type:"primary",onClick:C[3]||(C[3]=O=>j())},{default:n(()=>[...C[16]||(C[16]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(H,{label:"邮箱","label-width":100},{default:n(()=>[o(x,{modelValue:T.value,"onUpdate:modelValue":C[1]||(C[1]=O=>T.value=O),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(Ce,{visible:t(y).visible,"onUpdate:visible":C[5]||(C[5]=O=>t(y).visible=O),actionType:t(y).type,orderId:t(y).id,onSuccess:C[6]||(C[6]=O=>t(v)(!0))},null,8,["visible","actionType","orderId"])],64)}}}),gt=R({__name:"copy",props:["copied"],setup(z){const s=z,d=()=>{navigator.clipboard.writeText(s.copied).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return(u,i)=>{const l=_("el-icon");return r(),$(l,{color:"var(--el-text-color-secondary)",style:{cursor:"pointer"},onClick:d},{default:n(()=>[o(t(Re))]),_:1})}}}),Qe=R({__name:"validationMethods",props:{modelValue:{type:String},methods:{type:Object}},emits:["update:modelValue"],setup(z,{emit:s}){const d=z,u=s,i=K({get(){var l;return(l=d.modelValue)!=null?l:""},set(l){u("update:modelValue",l)}});return(l,c)=>{const w=_("el-option"),v=_("el-select");return r(),$(v,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=k=>i.value=k),placeholder:"请选择验证方法",class:"select"},{default:n(()=>[(r(!0),f(tt,null,It(d.methods,k=>(r(),$(w,{key:k,label:t(Je)[k],value:k},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])}}}),tl=F(Qe,[["__scopeId","data-v-825785f3"]]),el={key:0,class:"descriptions"},ll={style:{"margin-top":"18px"}},sl={key:0,style:{width:"100%"}},nl={key:0,style:{padding:"0"}},ol={key:1,class:"descriptions"},al={style:{"margin-top":"18px"}},rl={class:"descriptions"},il={style:{margin:"10px 0"}},dl={class:"descriptions"},ul={style:{width:"100%"}},cl={key:0,class:"index"},pl={key:0},ml={style:{"text-align":"right"}},_l={key:0,class:"check-result-dialog"},vl={key:0},yl={style:{"max-height":"200px","overflow-y":"auto","word-break":"break-all"}},fl={style:{color:"var(--el-color-danger)"}},gl=R({__name:"validation",setup(z){var st,q,ct;const s=M("get"),d=M("order"),u=M("cert"),i=K(()=>{var x;let V=!1;return(x=u.value)!=null&&x.validation&&u.value.validation.forEach(H=>{var J,O;H.host&&H.host!==((O=(J=u.value.dcv)==null?void 0:J.dns)==null?void 0:O.host)&&(V=!0)}),V}),l=K(()=>{let V=!0;return u.value.validation&&u.value.validation.forEach(x=>{x.verified!=1&&(V=!1)}),V}),c=A((st=u.value.dcv)==null?void 0:st.method);bt(()=>u.value,V=>{var x;V&&(c.value=(x=V.dcv)==null?void 0:x.method)});const w=A(!1),v=$t(),k=!!Number((ct=(q=v.query.issue_verify)!=null?q:v.query.verify)!=null?ct:v.query.pay!==void 0?0:1),y=()=>{we(d.id,{commit:!0,issue_verify:k}).then(V=>{I(V.msg?V.msg:"支付成功",{type:"success"}),s()})},b=()=>{kt(d.id).then(V=>{I(V.msg?V.msg:"提交成功",{type:"success"}),s()})},g=()=>{w.value||(w.value=!0,xe(d.id).then(V=>{I(V.msg?V.msg:"开始验证，请等待几分钟后刷新页面查看结果",{type:"success"})}).finally(()=>{w.value=!1}))},T=V=>{w.value||(w.value=!0,Pe(d.id,V).then(x=>{I(x.msg?x.msg:"修改成功",{type:"success"}),s()}).finally(()=>{w.value=!1}))},Y=()=>{const V=[];i.value?u.value.validation.forEach(H=>{(H.method==="cname"||H.method==="txt")&&V.push(`域名：${H.domain}
主机记录：${H.host}
解析类型：${u.value.dcv.dns.type}
记录值：${u.value.dcv.dns.value}`)}):V.push(`域名：${u.value.validation[0].domain}
主机记录：${u.value.dcv.dns.host}
解析类型：${u.value.dcv.dns.type}
记录值：${u.value.dcv.dns.value}`);const x=V.join(`

`);navigator.clipboard.writeText(x).then(()=>{I("解析记录已复制到剪贴板",{type:"success"})})};function j(V,x){return _t(this,null,function*(){var Ct,Lt;if(!(V!=null&&V.length))return V;const H=V.map(Z=>{var nt,yt,et,pt,mt,dt,wt,xt,zt,Dt,Tt;const Q={domain:Z.domain,method:(nt=Z.method)==null?void 0:nt.toLowerCase()};if(["txt","cname"].includes(Q.method))Q.host=Z.host||((et=(yt=u.value.dcv)==null?void 0:yt.dns)==null?void 0:et.host)||"@",Q.value=Z.value||((mt=(pt=u.value.dcv)==null?void 0:pt.dns)==null?void 0:mt.value);else if(["file","http","https"].includes(Q.method)){const At=Q.method==="file"?"":Q.method+":";Q.link=Z.link||`${At}//${Z.domain}/.well-known/pki-validation/${(wt=(dt=u.value.dcv)==null?void 0:dt.file)==null?void 0:wt.name}`,Q.name=Z.name||((zt=(xt=u.value.dcv)==null?void 0:xt.file)==null?void 0:zt.name),Q.content=Z.content||((Tt=(Dt=u.value.dcv)==null?void 0:Dt.file)==null?void 0:Tt.content)}return Q}),O=(((Ct=Ne())==null?void 0:Ct.DnsTools)||["https://dns-tools-cn.cnssl.com","https://dns-tools-us.cnssl.com"]).map(Z=>`${Z}/api/dcv/verify`);let ot,X;for(const Z of O)try{if(ot=yield qe.post(Z,H,{timeout:1e4}),ot.data!==void 0)break}catch(Q){X=Q,console.debug(`Failed to connect to ${Z}, trying next...`);continue}if(ot!=null&&ot.data){const Z=((Lt=ot.data.data)==null?void 0:Lt.results)||{},Q=ot.data.errors||[];return Q.length>0&&Q.forEach(nt=>{nt.domain&&(Z[nt.domain]=nt)}),V.map(nt=>{var pt,mt;const yt=nt.domain,et=Z[yt];if(et){const dt=ae(oe({},nt),{checked:et.matched==="true",error:et.matched==="false"?"验证失败":""});return["txt","cname"].includes((pt=nt.method)==null?void 0:pt.toLowerCase())?(dt.detected_value=et.value||"",dt.query=et.query||"",dt.query_sub=et.query_sub||"",dt.value_sub=et.value_sub||""):["file","http","https"].includes((mt=nt.method)==null?void 0:mt.toLowerCase())&&(dt.detected_value=et.content||"",dt.link=et.link||et.link_https||et.link_http||nt.link),dt}return nt})}return X&&console.error("All DCV verify endpoints failed:",X),V})}const N=A(!1),S=A(null),E=A(!1);function D(V){return _t(this,null,function*(){S.value=V,N.value=!0,V.checked||(yield C())})}function P(){return _t(this,null,function*(){if(S.value){E.value=!0;try{const V=yield j([S.value],d.product.ca);if(V!=null&&V[0]){const x=V[0];x.checked&&(x.error="",x.detected_value=x.detected_value||"",x.errors=void 0);const H=u.value.validation.findIndex(J=>J.domain===S.value.domain&&J.method===S.value.method);H!==-1&&(u.value.validation[H]=x,S.value=x)}}catch(V){I("检测失败，请稍后重试",{type:"error"})}finally{E.value=!1}}})}bt(N,V=>{V||(S.value=null,E.value=!1)});const C=We(P,500);function G(){return _t(this,null,function*(){var V,x,H,J,O,ot,X;if(!(!((x=(V=u.value)==null?void 0:V.validation)!=null&&x.length)||!["cname","txt","file","http","https"].includes((H=u.value.dcv)==null?void 0:H.method)||l.value||!((O=(J=u.value.dcv)==null?void 0:J.dns)!=null&&O.value)&&!((X=(ot=u.value.dcv)==null?void 0:ot.file)!=null&&X.content)||!["unpaid","pending","processing"].includes(u.value.status)))try{E.value=!0,u.value.validation=yield j(u.value.validation,d.product.ca)}catch(Ct){}finally{E.value=!1}})}return ut(()=>_t(null,null,function*(){yield G()})),(V,x)=>{var Q,nt,yt,et,pt,mt,dt,wt,xt,zt,Dt,Tt,At,Qt,te,ee;const H=_("el-input"),J=_("el-form-item"),O=_("el-button"),ot=_("el-icon"),X=_("el-descriptions-item"),Ct=_("el-tag"),Lt=_("el-descriptions"),Z=_("el-dialog");return r(),f(tt,null,[["cname","txt"].includes((Q=t(u).dcv)==null?void 0:Q.method)&&((yt=(nt=t(u).dcv)==null?void 0:nt.dns)!=null&&yt.value)?(r(),f("div",el,[e("div",ll,[o(J,{label:"主机记录：","label-width":"82px"},{default:n(()=>{var h,U;return[i.value?(r(),f("table",sl,[e("tbody",null,[(r(!0),f(tt,null,It(t(u).validation,(L,B)=>{var Vt,Yt;return r(),f("tr",{key:B},[["cname","txt"].includes((Vt=L.method)==null?void 0:Vt.toLowerCase())?(r(),f("td",nl,[o(H,{"model-value":L.host,spellcheck:"false",style:{width:"100%"}},Zt({suffix:n(()=>[o(gt,{copied:L.host},null,8,["copied"])]),_:2},[((Yt=t(u).validation)==null?void 0:Yt.length)>1?{name:"append",fn:n(()=>[m("."+a(t(re)(L.domain.replace("*.",""))),1)]),key:"0"}:void 0]),1032,["model-value"])])):p("",!0)])}),128))])])):(r(),$(H,{key:1,"model-value":(U=(h=t(u).dcv)==null?void 0:h.dns)==null?void 0:U.host,spellcheck:"false"},{suffix:n(()=>{var L,B;return[o(gt,{copied:(B=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:B.host},null,8,["copied"])]}),_:1},8,["model-value"]))]}),_:1}),o(J,{label:"解析类型：","label-width":"82px"},{default:n(()=>{var h,U;return[o(H,{"model-value":(U=(h=t(u).dcv)==null?void 0:h.dns)==null?void 0:U.type.toUpperCase(),disabled:!0,style:{width:"73px"}},null,8,["model-value"])]}),_:1}),o(J,{label:"记录值：","label-width":"82px"},{default:n(()=>{var h,U;return[o(H,{"model-value":(U=(h=t(u).dcv)==null?void 0:h.dns)==null?void 0:U.value,spellcheck:"false"},{suffix:n(()=>{var L,B;return[o(gt,{copied:(B=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:B.value},null,8,["copied"])]}),_:1},8,["model-value"])]}),_:1})])])):p("",!0),["file","http","https"].includes((et=t(u).dcv)==null?void 0:et.method)&&((mt=(pt=t(u).dcv)==null?void 0:pt.file)!=null&&mt.content)?(r(),f("div",ol,[e("div",al,[o(J,{label:"文件名：","label-width":"82px"},{default:n(()=>{var h,U;return[o(H,{"model-value":(U=(h=t(u).dcv)==null?void 0:h.file)==null?void 0:U.name,spellcheck:"false"},{suffix:n(()=>{var L,B;return[o(gt,{copied:(B=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:B.name},null,8,["copied"])]}),_:1},8,["model-value"])]}),_:1}),o(J,{label:"文件内容：","label-width":"82px"},{default:n(()=>{var h,U,L,B;return[o(H,{rows:3,type:"textarea",class:"file-content","model-value":(U=(h=t(u).dcv)==null?void 0:h.file)==null?void 0:U.content,spellcheck:"false"},null,8,["model-value"]),o(gt,{copied:(B=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:B.content,style:{position:"absolute",right:"12px",bottom:"7px"}},null,8,["copied"])]}),_:1}),o(J,{label:"路径：","label-width":"82px"},{default:n(()=>{var h,U;return[o(H,{"model-value":(U=(h=t(u).dcv)==null?void 0:h.file)==null?void 0:U.path,spellcheck:"false"},{suffix:n(()=>{var L,B;return[o(gt,{copied:(B=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:B.path},null,8,["copied"])]}),prepend:n(()=>[o(O,{type:"primary",onClick:x[0]||(x[0]=L=>Oe(t(d).id))},{default:n(()=>[...x[7]||(x[7]=[m("下 载",-1)])]),_:1})]),_:1},8,["model-value"])]}),_:1})])])):p("",!0),e("div",rl,[e("div",il,[o(tl,{modelValue:c.value,"onUpdate:modelValue":x[1]||(x[1]=h=>c.value=h),methods:t(d).product.validation_methods},null,8,["modelValue","methods"]),o(O,{disable:!["unpaid","pending","processing"].includes(t(u).status)||l.value,style:{"border-left":"0","border-top-left-radius":"0","border-bottom-left-radius":"0"},onClick:x[2]||(x[2]=h=>T(c.value))},{default:n(()=>[...x[8]||(x[8]=[m("修改",-1)])]),_:1},8,["disable"]),["processing"].includes(t(u).status)&&!["admin","administrator","postmaster","hostmaster","webmaster"].includes(t(u).dcv.method)?(r(),$(O,{key:0,disable:l.value,type:"primary",style:{"margin-left":"16px"},onClick:x[3]||(x[3]=h=>g())},{default:n(()=>[...x[9]||(x[9]=[m("验证",-1)])]),_:1},8,["disable"])):p("",!0),["cname","txt"].includes((dt=t(u).dcv)==null?void 0:dt.method)&&((xt=(wt=t(u).dcv)==null?void 0:wt.dns)!=null&&xt.value)&&["unpaid","pending","processing"].includes(t(u).status)&&!l.value?(r(),$(O,{key:1,type:"primary",style:{"margin-left":"16px"},onClick:x[4]||(x[4]=h=>Y())},{default:n(()=>[...x[10]||(x[10]=[m("复制解析",-1)])]),_:1})):p("",!0),((zt=t(u).validation)==null?void 0:zt.length)>1&&["cname","txt","file","http","https"].includes((Dt=t(u).dcv)==null?void 0:Dt.method)&&!l.value&&((At=(Tt=t(u).dcv)==null?void 0:Tt.dns)!=null&&At.value||(te=(Qt=t(u).dcv)==null?void 0:Qt.file)!=null&&te.content)&&["unpaid","pending","processing"].includes(t(u).status)?(r(),$(O,{key:2,disabled:E.value,type:"primary",loading:E.value,onClick:G},{default:n(()=>[...x[11]||(x[11]=[m(" 检测所有 ",-1)])]),_:1},8,["disabled","loading"])):p("",!0),["unpaid"].includes(t(u).status)?(r(),$(O,{key:3,type:"warning",onClick:y},{default:n(()=>[...x[12]||(x[12]=[m(" 支付 ",-1)])]),_:1})):p("",!0),["pending"].includes(t(u).status)?(r(),$(O,{key:4,type:"warning",onClick:b},{default:n(()=>[...x[13]||(x[13]=[m(" 提交 ",-1)])]),_:1})):p("",!0)])]),e("div",dl,[e("table",ul,[e("tbody",null,[e("tr",null,[((ee=t(u).validation)==null?void 0:ee.length)>1?(r(),f("td",cl,"序号")):p("",!0),x[14]||(x[14]=e("td",{class:"domain"},"域名",-1)),x[15]||(x[15]=e("td",{style:{"text-align":"right"}},"状态",-1))]),(r(!0),f(tt,null,It(t(u).validation,(h,U)=>{var L,B,Vt,Yt,le;return r(),f("tr",{key:U},[((L=t(u).validation)==null?void 0:L.length)>1?(r(),f("td",pl,a(U+1),1)):p("",!0),e("td",null,[m(a(h.domain)+" ",1),!["admin","administrator","postmaster","hostmaster","webmaster"].includes(h.method)&&["unpaid","pending","processing"].includes(t(u).status)&&((Vt=(B=t(u).dcv)==null?void 0:B.dns)!=null&&Vt.value||(le=(Yt=t(u).dcv)==null?void 0:Yt.file)!=null&&le.content)?(r(),$(O,{key:0,link:"",onClick:Pr=>D(h)},{default:n(()=>[h.checked?(r(),$(ot,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(je))]),_:1})):(r(),$(O,{key:1,type:"primary",link:""},{default:n(()=>[...x[16]||(x[16]=[m("检测",-1)])]),_:1}))]),_:2},1032,["onClick"])):p("",!0)]),e("td",ml,[h.verified==1||["active","approving"].includes(t(u).status)?(r(),$(ot,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(ze))]),_:1})):["unpaid","pending","processing"].includes(t(u).status)?(r(),f(tt,{key:1},[h.verified==2?(r(),$(ot,{key:0,color:"var(--el-color-warning)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Ue))]),_:1})):p("",!0),h.verified!=2?(r(),$(ot,{key:1,class:"is-loading",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(De))]),_:1})):p("",!0)],64)):p("",!0)])])}),128))])])]),o(Z,{modelValue:N.value,"onUpdate:modelValue":x[6]||(x[6]=h=>N.value=h),title:"验证检测结果",class:"validation-check-dialog"},{footer:n(()=>[o(O,{onClick:x[5]||(x[5]=h=>N.value=!1)},{default:n(()=>[...x[17]||(x[17]=[m("关闭",-1)])]),_:1}),o(O,{type:"primary",loading:E.value,onClick:t(C)},{default:n(()=>[...x[18]||(x[18]=[m("重新检测",-1)])]),_:1},8,["loading","onClick"])]),default:n(()=>[S.value?(r(),f("div",_l,[o(Lt,{column:1,border:""},{default:n(()=>{var h,U;return[o(X,{label:"域名","label-align":"right"},{default:n(()=>[m(a(S.value.domain),1)]),_:1}),o(X,{label:"验证方式","label-align":"right"},{default:n(()=>[m(a(S.value.method),1)]),_:1}),["cname","txt"].includes((h=S.value.method)==null?void 0:h.toLowerCase())?(r(),f(tt,{key:0},[o(X,{label:"验证记录","label-align":"right"},{default:n(()=>{var L,B;return[m(a(S.value.query||(S.value.host||((B=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:B.host))+"."+t(re)(S.value.domain.replace("*.",""))),1)]}),_:1}),o(X,{label:"需要的值","label-align":"right"},{default:n(()=>{var L,B;return[m(a(S.value.value||((B=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:B.value)),1)]}),_:1}),S.value.detected_value?(r(),$(X,{key:0,label:"检测到的值","label-align":"right"},{default:n(()=>[m(a(S.value.detected_value),1)]),_:1})):p("",!0),S.value.query_sub?(r(),$(X,{key:1,label:"子域查询","label-align":"right"},{default:n(()=>[m(a(S.value.query_sub)+" ",1),S.value.value_sub?(r(),f("span",vl," → "+a(S.value.value_sub),1)):p("",!0)]),_:1})):p("",!0)],64)):p("",!0),["file","http","https"].includes((U=S.value.method)==null?void 0:U.toLowerCase())?(r(),f(tt,{key:1},[o(X,{label:"验证链接","label-align":"right"},{default:n(()=>{var L,B;return[m(a(S.value.link||`${S.value.method==="file"?"https:":S.value.method+":"}//${S.value.domain}/.well-known/pki-validation/${(B=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:B.name}`),1)]}),_:1}),o(X,{label:"需要的内容","label-align":"right"},{default:n(()=>{var L,B;return[m(a(S.value.content||((B=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:B.content)),1)]}),_:1}),S.value.detected_value?(r(),$(X,{key:0,label:"检测到的内容","label-align":"right"},{default:n(()=>[e("div",yl,a(S.value.detected_value),1)]),_:1})):p("",!0)],64)):p("",!0),o(X,{label:"检测状态","label-align":"right"},{default:n(()=>[o(Ct,{type:S.value.checked?"success":"danger"},{default:n(()=>[m(a(S.value.checked?"验证通过":"验证失败"),1)]),_:1},8,["type"])]),_:1}),S.value.error?(r(),$(X,{key:2,label:"错误信息","label-align":"right"},{default:n(()=>[e("div",fl,a(S.value.error),1)]),_:1})):p("",!0)]}),_:1})])):p("",!0)]),_:1},8,["modelValue"])],64)}}}),bl=F(gl,[["__scopeId","data-v-27e4e424"]]),kl={class:"descriptions"},$l={style:{float:"right"}},Cl={style:{float:"right"}},wl=R({__name:"install",setup(z){const s=M("order"),d=M("cert"),u=A(""),i=l=>{navigator.clipboard.writeText(l).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return ht(()=>{d.value.private_key=d.value.private_key||"",d.value.cert=d.value.cert||"",d.value.intermediate_cert=d.value.intermediate_cert||""}),(l,c)=>{const w=_("el-button"),v=_("el-text"),k=_("el-input"),y=_("el-col"),b=_("el-row"),g=_("el-dialog");return r(),f("div",null,[e("table",kl,[o(v,{style:{margin:"10px 20px"}},{default:n(()=>[o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[0]||(c[0]=T=>u.value="bt")},{default:n(()=>[...c[11]||(c[11]=[m("宝塔面板",-1)])]),_:1},8,["disabled"]),o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[1]||(c[1]=T=>ft(t(s).id,"nginx"))},{default:n(()=>[...c[12]||(c[12]=[m("Nginx",-1)])]),_:1},8,["disabled"]),o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[2]||(c[2]=T=>ft(t(s).id,"apache"))},{default:n(()=>[...c[13]||(c[13]=[m("Apache",-1)])]),_:1},8,["disabled"]),t(d).private_key?(r(),$(w,{key:0,type:"primary",link:"",disabled:t(d).status!="active",onClick:c[3]||(c[3]=T=>ft(t(s).id,"iis"))},{default:n(()=>[...c[14]||(c[14]=[m(" IIS ",-1)])]),_:1},8,["disabled"])):p("",!0),t(d).private_key?(r(),$(w,{key:1,type:"primary",link:"",disabled:t(d).status!="active",onClick:c[4]||(c[4]=T=>ft(t(s).id,"tomcat"))},{default:n(()=>[...c[15]||(c[15]=[m(" Tomcat ",-1)])]),_:1},8,["disabled"])):p("",!0),o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[5]||(c[5]=T=>ft(t(s).id,"pem"))},{default:n(()=>[...c[16]||(c[16]=[m("Pem",-1)])]),_:1},8,["disabled"]),o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[6]||(c[6]=T=>ft(t(s).id,"txt"))},{default:n(()=>[...c[17]||(c[17]=[m("Txt",-1)])]),_:1},8,["disabled"]),o(w,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[7]||(c[7]=T=>ft(t(s).id))},{default:n(()=>[...c[18]||(c[18]=[m("全部",-1)])]),_:1},8,["disabled"])]),_:1})]),o(g,{"model-value":u.value=="bt","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:c[10]||(c[10]=T=>u.value="")},Zt({default:n(()=>[u.value=="bt"?(r(),$(b,{key:0,gutter:20},{default:n(()=>[o(y,{span:12},{default:n(()=>[c[21]||(c[21]=e("span",null,"密钥(KEY)",-1)),e("span",$l,[o(w,{type:"primary",link:"",size:"small",onClick:c[8]||(c[8]=T=>i(t(d).private_key))},{default:n(()=>[...c[20]||(c[20]=[m("点击复制",-1)])]),_:1})]),o(k,{type:"textarea",rows:20,"model-value":t(d).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(y,{span:12},{default:n(()=>[c[23]||(c[23]=e("span",null,"证书(PEM格式)",-1)),e("span",Cl,[o(w,{type:"primary",link:"",size:"small",onClick:c[9]||(c[9]=T=>i((t(d).cert+`
`+t(d).intermediate_cert).trim()))},{default:n(()=>[...c[22]||(c[22]=[m("点击复制",-1)])]),_:1})]),o(k,{type:"textarea",rows:20,"model-value":(t(d).cert+`
`+t(d).intermediate_cert).trim(),spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:2},[u.value=="bt"?{name:"header",fn:n(()=>[c[19]||(c[19]=e("div",{class:"title",style:{"margin-bottom":"0"}},"宝塔面板",-1))]),key:"0"}:void 0]),1032,["model-value"])])}}}),xl=F(wl,[["__scopeId","data-v-5224f3b8"]]),zl={class:"documents"},Dl=R({__name:"documents",setup(z){const s=M("cert"),d={APPLICANT:"申请人文档",ORGANIZATION:"企业文档",AUTHORIZATION:"授权文档",ADDITIONAL:"附加文档",VERIFICATION_REPORT:"验证报告",ATTESTATION_LETTER:"证明函"},u={NEW:"待审核",ACCEPTED:"已通过",REJECTED:"已拒绝"},i={NEW:"warning",ACCEPTED:"success",REJECTED:"danger"},l=v=>i[v]||"info",c=K(()=>{var k;const v=(k=s.value)==null?void 0:k.documents;return v?Array.isArray(v)?v:[v]:[]}),w=v=>v?new Date(v).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return(v,k)=>{const y=_("el-table-column"),b=_("el-tag"),g=_("el-table"),T=_("el-empty");return r(),f("div",zl,[c.value.length>0?(r(),$(g,{key:0,data:c.value,size:"small",style:{width:"100%"}},{default:n(()=>[o(y,{prop:"type",label:"类型",width:"140"},{default:n(({row:Y})=>[m(a(d[Y.type]||Y.type),1)]),_:1}),o(y,{prop:"state",label:"状态",width:"80"},{default:n(({row:Y})=>[o(b,{type:l(Y.state),size:"small"},{default:n(()=>[m(a(u[Y.state]||Y.state),1)]),_:2},1032,["type"])]),_:1}),o(y,{prop:"createDate",label:"上传时间",width:"160"},{default:n(({row:Y})=>[m(a(w(Y.createDate)),1)]),_:1}),o(y,{prop:"expireDate",label:"过期时间",width:"160"},{default:n(({row:Y})=>[m(a(w(Y.expireDate)),1)]),_:1})]),_:1},8,["data"])):(r(),$(T,{key:1,description:"暂无验证文档","image-size":60}))])}}}),Xt=F(Dl,[["__scopeId","data-v-b5164e11"]]),Tl={class:"title"},Vl={style:{"margin-left":"15px"}},Yl={class:"descriptions",style:{width:"100%"}},Sl={class:"label"},Il={key:0},Ml={class:"label"},El={key:1},Hl={class:"content"},Ol={class:"label"},Pl={class:"content"},hl={class:"label"},Ll={class:"content"},Al=R({__name:"process",setup(z){const s=M("order"),d=M("cert"),u=y=>K(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[y]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),i=u("cert_apply_status"),l=u("org_verify_status"),c=u("domain_verify_status"),w=K(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),v=K(()=>{var g,T;if(!["unpaid","pending","processing","active","expired","approving","cancelling"].includes((g=d.value)==null?void 0:g.status))return!1;if(!((T=s.value)!=null&&T.period_till))return!0;const b=W(s.value.period_till);return b.isValid()&&b.isAfter(W())}),k=A(null);return ut(()=>{if(k.value){const y=k.value.$el,b=window.getComputedStyle(y),g=b.backgroundColor,T=b.borderColor,Y=b.color;y.style.setProperty("--original-bg-color",g),y.style.setProperty("--original-border-color",T),y.style.setProperty("--original-text-color",Y)}}),(y,b)=>{const g=_("el-icon"),T=_("el-card");return r(),$(T,{shadow:"never",style:{border:"none"}},{default:n(()=>{var Y,j;return[e("h2",Tl,[b[0]||(b[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Ft),{ref_key:"statusButton",ref:k,type:t(Mt)[(Y=t(d))==null?void 0:Y.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var N;return[m(a(t(Et)[(N=t(d))==null?void 0:N.status]),1)]}),_:1},8,["type"]),e("span",Vl,[v.value?(r(),$(Ze,{key:0})):p("",!0)])]),e("table",Yl,[e("tbody",null,[e("tr",null,[e("td",Sl,[o(g,{size:16,class:"icon",color:t(i)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[1]||(b[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(r(),f("tr",Il,[e("td",Ml,[o(g,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[2]||(b[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((j=t(s).brand)==null?void 0:j.toLowerCase())==="certum"?(r(),f("tr",El,[b[3]||(b[3]=e("td",{class:"label"},null,-1)),e("td",Hl,[o(Xt)])])):p("",!0),e("tr",null,[e("td",Ol,[o(g,{size:16,class:"icon",color:t(c)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[4]||(b[4]=e("td",{class:"content"},"域名验证",-1))]),e("tr",null,[b[5]||(b[5]=e("td",{class:"label"},null,-1)),e("td",Pl,[o(bl)])]),e("tr",null,[e("td",hl,[o(g,{size:16,class:"icon",color:w.value},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[6]||(b[6]=e("td",{class:"content"},"下载证书",-1))]),e("tr",null,[b[7]||(b[7]=e("td",{class:"label"},null,-1)),e("td",Ll,[o(xl)])])])])]}),_:1})}}}),ie=F(Al,[["__scopeId","data-v-2217514b"]]),Bl={class:"descriptions"},Rl={class:"content"},Wl={class:"content"},jl={class:"content"},Ul={class:"content"},Nl={class:"content"},ql={class:"content"},Kl={class:"content"},Fl={class:"content"},Gl={key:0},Jl={class:"content"},Xl={key:1},Zl={class:"content"},Ql={class:"content"},ts=R({__name:"order",setup(z){const s=M("order"),d=()=>{vt.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{Ut(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),rt(s.id).then(i=>{i.data.sync=it(),Object.assign(s,lt(i.data))})})})};return(u,i)=>{const l=_("el-button"),c=_("el-card");return r(),$(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[i[14]||(i[14]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",Bl,[e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("td",{class:"label"},"订单ID",-1)),e("td",Rl,a(t(s).id),1)]),e("tr",null,[i[1]||(i[1]=e("td",{class:"label"},"品牌",-1)),e("td",Wl,a(t(s).brand),1)]),e("tr",null,[i[2]||(i[2]=e("td",{class:"label"},"产品",-1)),e("td",jl,a(t(s).product.name),1)]),e("tr",null,[i[3]||(i[3]=e("td",{class:"label"},"金额",-1)),e("td",Ul,a(t(s).amount),1)]),e("tr",null,[i[4]||(i[4]=e("td",{class:"label"},"购买时长",-1)),e("td",Nl,a(t(Jt)[t(s).period]),1)]),e("tr",null,[i[5]||(i[5]=e("td",{class:"label"},"有效期从",-1)),e("td",ql,a(t(s).period_from?t(W)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),e("tr",null,[i[6]||(i[6]=e("td",{class:"label"},"有效期到",-1)),e("td",Kl,a(t(s).period_till?t(W)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),e("tr",null,[i[7]||(i[7]=e("td",{class:"label"},"已购",-1)),e("td",Fl,a(t(s).purchased_standard_count?t(s).purchased_standard_count+"个标准域名":"")+" "+a(t(s).purchased_standard_count&&t(s).purchased_wildcard_count?"/":"")+" "+a(t(s).purchased_wildcard_count?t(s).purchased_wildcard_count+"个通配符":""),1)]),t(s).organization?(r(),f("tr",Gl,[i[10]||(i[10]=e("td",{class:"label"},"组织",-1)),e("td",Jl,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),i[8]||(i[8]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),i[9]||(i[9]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(r(),f("tr",Xl,[i[12]||(i[12]=e("td",{class:"label"},"联系人",-1)),e("td",Zl,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),i[11]||(i[11]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[i[13]||(i[13]=e("td",{class:"label"},"备注",-1)),e("td",Ql,[m(a(t(s).remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),de=F(ts,[["__scopeId","data-v-fbcb6164"]]),es={class:"descriptions"},ls={class:"content"},ss={class:"content"},ns={class:"content"},os={key:0},as={class:"content"},rs={key:0},is={class:"content"},ds={key:1},us={class:"content"},cs={key:2},ps={class:"content"},ms={class:"content"},_s={key:3},vs={class:"content"},ys={key:4},fs={class:"content"},gs={key:5},bs={class:"content"},ks={key:6},$s={class:"content"},Cs={key:7},ws={class:"content"},xs={key:8},zs={class:"content"},Ds={key:9},Ts={class:"content"},Vs={class:"content"},Ys={key:10},Ss={class:"content"},Is={key:11},Ms={class:"content"},Es={key:0,class:"title",style:{"margin-bottom":"0"}},Hs={key:1,class:"title",style:{"margin-bottom":"0"}},Os={style:{float:"right"}},Ps={style:{float:"right"}},hs={style:{float:"right"}},Ls={style:{float:"right"}},As=R({__name:"cert",setup(z){const s=M("cert"),d=A(""),u=i=>{navigator.clipboard.writeText(i).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return ht(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(i,l)=>{const c=_("el-button"),w=_("el-card"),v=_("el-input"),k=_("el-col"),y=_("el-row"),b=_("el-dialog");return r(),f(tt,null,[o(w,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[30]||(l[30]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",es,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",ls,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"通用名称",-1)),e("td",ss,a(t(s).common_name),1)]),e("tr",null,[l[11]||(l[11]=e("td",{class:"label"},"备用名称",-1)),e("td",ns,[t(s).alternative_names?(r(),f("ul",os,[(r(!0),f(tt,null,It(t(s).alternative_names.split(","),g=>(r(),f("li",{key:g},a(g),1))),128))])):p("",!0)])]),e("tr",null,[l[12]||(l[12]=e("td",{class:"label"},"域名数量",-1)),e("td",as,a(t(s).standard_count?t(s).standard_count+"个标准域名":"")+" "+a(t(s).standard_count&&t(s).wildcard_count?"/":"")+" "+a(t(s).wildcard_count?t(s).wildcard_count+"个通配符":""),1)]),t(s).vendor_id?(r(),f("tr",rs,[l[13]||(l[13]=e("td",{class:"label"},"CA订单ID",-1)),e("td",is,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(r(),f("tr",ds,[l[14]||(l[14]=e("td",{class:"label"},"动作",-1)),e("td",us,a(t(Ht)[t(s).action]),1)])):p("",!0),t(s).channel?(r(),f("tr",cs,[l[15]||(l[15]=e("td",{class:"label"},"来源",-1)),e("td",ps,a(t(Ot)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[16]||(l[16]=e("td",{class:"label"},"金额",-1)),e("td",ms,a(t(s).amount),1)]),t(s).issuer?(r(),f("tr",_s,[l[17]||(l[17]=e("td",{class:"label"},"签发者",-1)),e("td",vs,a(t(s).issuer),1)])):p("",!0),t(s).issuer?(r(),f("tr",ys,[l[18]||(l[18]=e("td",{class:"label"},"序列号",-1)),e("td",fs,a(t(s).serial_number),1)])):p("",!0),t(s).issuer?(r(),f("tr",gs,[l[19]||(l[19]=e("td",{class:"label"},"指纹",-1)),e("td",bs,a(t(s).fingerprint),1)])):p("",!0),t(s).issuer?(r(),f("tr",ks,[l[20]||(l[20]=e("td",{class:"label"},"加密算法",-1)),e("td",$s,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).issuer?(r(),f("tr",Cs,[l[21]||(l[21]=e("td",{class:"label"},"摘要算法",-1)),e("td",ws,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(r(),f("tr",xs,[l[22]||(l[22]=e("td",{class:"label"},"签发时间",-1)),e("td",zs,a(t(s).issued_at?t(W)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(r(),f("tr",Ds,[l[23]||(l[23]=e("td",{class:"label"},"到期时间",-1)),e("td",Ts,a(t(s).expires_at?t(W)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),e("tr",null,[l[25]||(l[25]=e("td",{class:"label"},"CSR",-1)),e("td",Vs,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=g=>d.value="csr")},{default:n(()=>[...l[24]||(l[24]=[m("查看",-1)])]),_:1})])]),t(s).private_key?(r(),f("tr",Ys,[l[27]||(l[27]=e("td",{class:"label"},"私钥",-1)),e("td",Ss,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=g=>d.value="private_key")},{default:n(()=>[...l[26]||(l[26]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(r(),f("tr",Is,[l[29]||(l[29]=e("td",{class:"label"},"证书",-1)),e("td",Ms,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=g=>d.value="cert")},{default:n(()=>[...l[28]||(l[28]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(b,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=g=>d.value="")},{header:n(()=>[d.value=="csr"?(r(),f("div",Es," 查看CSR ")):p("",!0),d.value=="private_key"?(r(),f("div",Hs," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(r(),$(y,{key:0},{default:n(()=>[o(k,null,{default:n(()=>[l[32]||(l[32]=e("span",null,"请求文件(CSR)",-1)),e("span",Os,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=g=>u(t(s).csr))},{default:n(()=>[...l[31]||(l[31]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(r(),$(y,{key:1},{default:n(()=>[o(k,null,{default:n(()=>[l[34]||(l[34]=e("span",null,"私钥(KEY)",-1)),e("span",Ps,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=g=>u(t(s).private_key))},{default:n(()=>[...l[33]||(l[33]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(b,{"model-value":["cert","bt"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=g=>d.value="")},Zt({default:n(()=>[d.value=="cert"?(r(),$(y,{key:0,gutter:20},{default:n(()=>[o(k,{span:12},{default:n(()=>[l[37]||(l[37]=e("span",null,"证书(CERT)",-1)),e("span",hs,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=g=>u(t(s).cert))},{default:n(()=>[...l[36]||(l[36]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(k,{span:12},{default:n(()=>[l[39]||(l[39]=e("span",null,"证书链(CHAIN)",-1)),e("span",Ls,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=g=>u(t(s).intermediate_cert))},{default:n(()=>[...l[38]||(l[38]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:2},[d.value=="cert"?{name:"header",fn:n(()=>[l[35]||(l[35]=e("div",{class:"title",style:{"margin-bottom":"0"}}," 查看证书 (宝塔面板需要复制证书+证书链) ",-1))]),key:"0"}:void 0]),1032,["model-value"])],64)}}}),ue=F(As,[["__scopeId","data-v-ff16825d"]]);function Ve(z){return Ke.get("/cert",{params:z})}const Ye=[{label:"证书ID",prop:"id",minWidth:140},{label:"订单ID",prop:"order_id",minWidth:140},{label:"通用名称",prop:"common_name",minWidth:150},{label:"金额(元)",prop:"amount",minWidth:90,cellRenderer:({row:z})=>z.amount>0?z.amount:"-"},{label:"渠道",prop:"channel",minWidth:80,cellRenderer:({row:z})=>o(_("el-tag"),{type:he[z.channel]},{default:()=>[Ot[z.channel]]})},{label:"操作",prop:"action",minWidth:80,cellRenderer:({row:z})=>o(_("el-tag"),{type:Le[z.action]},{default:()=>[Ht[z.action]]})},{label:"状态",prop:"status",minWidth:80,cellRenderer:({row:z})=>o(_("el-tag"),{type:Mt[z.status]||"info"},{default:()=>[Et[z.status]]})},{label:"签发时间",prop:"issued_at",minWidth:170,formatter:({issued_at:z})=>z?W(z).format("YYYY-MM-DD HH:mm:ss"):"-"},{label:"到期时间",prop:"expires_at",minWidth:170,formatter:({expires_at:z})=>z?W(z).format("YYYY-MM-DD HH:mm:ss"):"-"}],Bs=R({__name:"issueList",props:{activeTab:{type:String,required:!0}},setup(z){const s=z,d=M("order"),u=A([]),i=lt({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]}),l=()=>_t(null,null,function*(){s.activeTab==="issueList"&&Ve({currentPage:i.currentPage,pageSize:i.pageSize,order_id:d.id}).then(v=>{v.code===1&&(u.value=v.data.items,i.total=v.data.total)})}),c=v=>{i.pageSize=v,l()},w=v=>{i.currentPage=v,l()};return bt(()=>d.sync,()=>{l()}),bt(()=>s.activeTab,v=>{v==="issueList"&&l()}),(v,k)=>{const y=_("el-card");return r(),$(y,{shadow:"never",style:{border:"none"}},{default:n(()=>[k[0]||(k[0]=e("h2",{class:"title"},[e("span",null,"颁发记录")],-1)),o(t(Te),{columns:t(Ye),data:u.value,pagination:i,"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:c,onPageCurrentChange:w},null,8,["columns","data","pagination"])]),_:1})}}}),Rs=F(Bs,[["__scopeId","data-v-1581e633"]]),ce=R({__name:"index",setup(z){const s=A("detail"),d=A(window.innerWidth),u=()=>{d.value=window.innerWidth};return ut(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(i,l)=>{const c=_("el-col"),w=_("el-row"),v=_("el-tab-pane"),k=_("el-tabs");return r(),$(k,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(v,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(r(),$(w,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(ie)]),_:1}),o(c,{span:12},{default:n(()=>[o(de),o(ue)]),_:1})]),_:1})):(r(),$(w,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(ie),o(de),o(ue)]),_:1})]),_:1}))]),_:1}),o(v,{label:"颁发记录",name:"issueList"},{default:n(()=>[o(Rs,{"active-tab":s.value},null,8,["active-tab"])]),_:1})]),_:1},8,["modelValue"])}}}),Ws={class:"dialog-footer"},js=R({__name:"operate",setup(z){var D;const{toDetail:s}=Bt(),d=$t(),u=d.path,i=d.params,l=M("order"),c=M("cert"),w=M("sync"),v=M("get"),k=K(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),{action:y,openAction:b}=$e(),g=P=>{if(P)switch(P){case"send":Y.value=!0;break;case"commit":N();break;case"sync":w(!0);break;case"commitCancel":S();break;case"revokeCancel":E();break;case"renew":b("renew",l.id);break;case"reissue":b("reissue",l.id);break}},T=A((D=l==null?void 0:l.user)==null?void 0:D.email),Y=A(!1),j=()=>{Rt(l.id,T.value).then(()=>{Y.value=!1,I("发送成功",{type:"success"})})},N=()=>{kt(l.id).then(()=>{I("提交成功",{type:"success"}),v()})},S=()=>{vt.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let P=i.ids.toString().split(",");P.length>1?(P=P.filter(C=>C!==l.id.toString()),s({ids:P.join(",")},"params")):Pt.push({name:"Order"})}else rt(l.id).then(P=>{P.data.sync=it(),Object.assign(l,lt(P.data))})})})},E=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),rt(l.id).then(P=>{P.data.sync=it(),Object.assign(l,lt(P.data))})})};return(P,C)=>{const G=_("el-icon"),st=_("el-button"),q=_("el-dropdown-item"),ct=_("el-dropdown-menu"),V=_("el-dropdown"),x=_("el-input"),H=_("el-form-item"),J=_("el-dialog");return r(),f(tt,null,[o(V,{style:{"margin-top":"7px"},onCommand:g},{dropdown:n(()=>[o(ct,null,{default:n(()=>[t(c).status=="active"?(r(),$(q,{key:0,command:"send"},{default:n(()=>[...C[8]||(C[8]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(r(),$(q,{key:1,command:"commit"},{default:n(()=>[...C[9]||(C[9]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(r(),$(q,{key:2,command:"sync"},{default:n(()=>[...C[10]||(C[10]=[m(a("同步"),-1)])]),_:1})):p("",!0),k.value?(r(),$(q,{key:3,command:"commitCancel",divided:""},{default:n(()=>[...C[11]||(C[11]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(r(),$(q,{key:4,command:"revokeCancel"},{default:n(()=>[...C[12]||(C[12]=[m(a("撤回"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(r(),$(q,{key:5,command:"renew",divided:""},{default:n(()=>[...C[13]||(C[13]=[m(a("续费"),-1)])]),_:1})):p("",!0),["active","expired"].includes(t(c).status)?(r(),$(q,{key:6,command:"reissue",divided:""},{default:n(()=>[...C[14]||(C[14]=[m(a("重签"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(st,{type:"primary",size:"small"},{default:n(()=>[C[7]||(C[7]=m(a("操作")+" ",-1)),o(G,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(st,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:C[0]||(C[0]=O=>t(v)(!0))},{default:n(()=>[o(G,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(qt))]),_:1})]),_:1}),o(J,{modelValue:Y.value,"onUpdate:modelValue":C[4]||(C[4]=O=>Y.value=O),title:"发送邮件"},{footer:n(()=>[e("span",Ws,[o(st,{onClick:C[2]||(C[2]=O=>Y.value=!1)},{default:n(()=>[...C[15]||(C[15]=[m(a("取消"),-1)])]),_:1}),o(st,{type:"primary",onClick:C[3]||(C[3]=O=>j())},{default:n(()=>[...C[16]||(C[16]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(H,{label:"邮箱","label-width":100},{default:n(()=>[o(x,{modelValue:T.value,"onUpdate:modelValue":C[1]||(C[1]=O=>T.value=O),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(Ce,{visible:t(y).visible,"onUpdate:visible":C[5]||(C[5]=O=>t(y).visible=O),actionType:t(y).type,orderId:t(y).id,onSuccess:C[6]||(C[6]=O=>t(v)(!0))},null,8,["visible","actionType","orderId"])],64)}}}),Us={class:"descriptions"},Ns={style:{margin:"10px 0"}},qs={class:"descriptions"},Ks={style:{width:"100%"}},Fs={style:{"text-align":"right"}},Gs=R({__name:"validation",setup(z){var y,b;const s=M("get"),d=M("order"),u=M("cert"),i=A(!1),l=$t(),c=!!Number((b=(y=l.query.issue_verify)!=null?y:l.query.verify)!=null?b:l.query.pay!==void 0?0:1),w=()=>{we(d.id,{commit:!0,issue_verify:c}).then(g=>{I(g.msg?g.msg:"支付成功",{type:"success"}),s()})},v=()=>{kt(d.id).then(g=>{I(g.msg?g.msg:"提交成功",{type:"success"}),s()})},k=()=>{i.value||(i.value=!0,xe(d.id).then(g=>{I(g.msg?g.msg:"验证邮件已重发，请检查邮箱",{type:"success"}),s()}).finally(()=>{i.value=!1}))};return(g,T)=>{var N;const Y=_("el-button"),j=_("el-icon");return r(),f(tt,null,[e("div",Us,[e("div",Ns,[["unpaid"].includes(t(u).status)?(r(),$(Y,{key:0,type:"warning",onClick:w},{default:n(()=>[...T[0]||(T[0]=[m(" 支付 ",-1)])]),_:1})):p("",!0),["pending"].includes(t(u).status)?(r(),$(Y,{key:1,type:"warning",onClick:v},{default:n(()=>[...T[1]||(T[1]=[m(" 提交 ",-1)])]),_:1})):p("",!0),["processing"].includes(t(u).status)?(r(),$(Y,{key:2,type:"primary",loading:i.value,onClick:k},{default:n(()=>[...T[2]||(T[2]=[m(" 重发验证邮件 ",-1)])]),_:1},8,["loading"])):p("",!0)])]),e("div",qs,[e("table",Ks,[e("tbody",null,[T[3]||(T[3]=e("tr",null,[e("td",{class:"domain"},"邮箱"),e("td",{style:{"text-align":"right"}},"状态")],-1)),e("tr",null,[e("td",null,a(((N=t(d).contact)==null?void 0:N.email)||t(u).common_name),1),e("td",Fs,[["active","approving"].includes(t(u).status)?(r(),$(j,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(ze))]),_:1})):["unpaid","pending","processing"].includes(t(u).status)?(r(),$(j,{key:1,class:"is-loading",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(De))]),_:1})):p("",!0)])])])])])],64)}}}),Js=F(Gs,[["__scopeId","data-v-be0ebd02"]]),Xs={class:"title"},Zs={style:{"margin-left":"15px"}},Qs={class:"descriptions",style:{width:"100%"}},tn={class:"label"},en={key:0},ln={class:"label"},sn={key:1},nn={class:"content"},on={class:"label"},an={class:"content"},rn={class:"label"},dn=R({__name:"process",setup(z){const s=M("order"),d=M("cert"),u=y=>K(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[y]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),i=u("cert_apply_status"),l=u("org_verify_status"),c=u("domain_verify_status"),w=K(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),v=K(()=>{var g,T;if(!["unpaid","pending","processing","active","expired","approving","cancelling"].includes((g=d.value)==null?void 0:g.status))return!1;if(!((T=s.value)!=null&&T.period_till))return!0;const b=W(s.value.period_till);return b.isValid()&&b.isAfter(W())}),k=A(null);return ut(()=>{if(k.value){const y=k.value.$el,b=window.getComputedStyle(y),g=b.backgroundColor,T=b.borderColor,Y=b.color;y.style.setProperty("--original-bg-color",g),y.style.setProperty("--original-border-color",T),y.style.setProperty("--original-text-color",Y)}}),(y,b)=>{const g=_("el-icon"),T=_("el-card");return r(),$(T,{shadow:"never",style:{border:"none"}},{default:n(()=>{var Y,j;return[e("h2",Xs,[b[0]||(b[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Ft),{ref_key:"statusButton",ref:k,type:t(Mt)[(Y=t(d))==null?void 0:Y.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var N;return[m(a(t(Et)[(N=t(d))==null?void 0:N.status]),1)]}),_:1},8,["type"]),e("span",Zs,[v.value?(r(),$(js,{key:0})):p("",!0)])]),e("table",Qs,[e("tbody",null,[e("tr",null,[e("td",tn,[o(g,{size:16,class:"icon",color:t(i)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[1]||(b[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(r(),f("tr",en,[e("td",ln,[o(g,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[2]||(b[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((j=t(s).brand)==null?void 0:j.toLowerCase())==="certum"?(r(),f("tr",sn,[b[3]||(b[3]=e("td",{class:"label"},null,-1)),e("td",nn,[o(Xt)])])):p("",!0),e("tr",null,[e("td",on,[o(g,{size:16,class:"icon",color:t(c)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[4]||(b[4]=e("td",{class:"content"},"邮箱验证",-1))]),e("tr",null,[b[5]||(b[5]=e("td",{class:"label"},null,-1)),e("td",an,[o(Js)])]),e("tr",null,[e("td",rn,[o(g,{size:16,class:"icon",color:w.value},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),b[6]||(b[6]=e("td",{class:"content"},"下载证书",-1))])])])]}),_:1})}}}),pe=F(dn,[["__scopeId","data-v-6bbfbb98"]]),un={class:"descriptions"},cn={class:"content"},pn={class:"content"},mn={class:"content"},_n={class:"content"},vn={class:"content"},yn={class:"content"},fn={class:"content"},gn={key:0},bn={class:"content"},kn={key:1},$n={class:"content"},Cn={class:"content"},wn=R({__name:"order",setup(z){const s=M("order"),d=()=>{vt.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{Ut(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),rt(s.id).then(i=>{i.data.sync=it(),Object.assign(s,lt(i.data))})})})};return(u,i)=>{const l=_("el-button"),c=_("el-card");return r(),$(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[i[13]||(i[13]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",un,[e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("td",{class:"label"},"订单ID",-1)),e("td",cn,a(t(s).id),1)]),e("tr",null,[i[1]||(i[1]=e("td",{class:"label"},"品牌",-1)),e("td",pn,a(t(s).brand),1)]),e("tr",null,[i[2]||(i[2]=e("td",{class:"label"},"产品",-1)),e("td",mn,a(t(s).product.name),1)]),e("tr",null,[i[3]||(i[3]=e("td",{class:"label"},"金额",-1)),e("td",_n,a(t(s).amount),1)]),e("tr",null,[i[4]||(i[4]=e("td",{class:"label"},"购买时长",-1)),e("td",vn,a(t(Jt)[t(s).period]),1)]),e("tr",null,[i[5]||(i[5]=e("td",{class:"label"},"有效期从",-1)),e("td",yn,a(t(s).period_from?t(W)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),e("tr",null,[i[6]||(i[6]=e("td",{class:"label"},"有效期到",-1)),e("td",fn,a(t(s).period_till?t(W)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),t(s).organization?(r(),f("tr",gn,[i[9]||(i[9]=e("td",{class:"label"},"组织",-1)),e("td",bn,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),i[7]||(i[7]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),i[8]||(i[8]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(r(),f("tr",kn,[i[11]||(i[11]=e("td",{class:"label"},"联系人",-1)),e("td",$n,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),i[10]||(i[10]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[i[12]||(i[12]=e("td",{class:"label"},"备注",-1)),e("td",Cn,[m(a(t(s).remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),me=F(wn,[["__scopeId","data-v-bcf3772f"]]),xn={class:"descriptions"},zn={class:"content"},Dn={class:"content"},Tn={key:0},Vn={class:"content"},Yn={key:1},Sn={class:"content"},In={key:2},Mn={class:"content"},En={class:"content"},Hn={key:3},On={class:"content"},Pn={key:4},hn={class:"content"},Ln={key:5},An={class:"content"},Bn={key:6},Rn={class:"content"},Wn={key:7},jn={class:"content"},Un={key:8},Nn={class:"content"},qn={key:9},Kn={class:"content"},Fn={key:10},Gn={class:"content"},Jn={key:11},Xn={class:"content"},Zn={key:12},Qn={class:"content"},to={key:0,class:"title",style:{"margin-bottom":"0"}},eo={key:1,class:"title",style:{"margin-bottom":"0"}},lo={style:{float:"right"}},so={style:{float:"right"}},no={style:{float:"right"}},oo={style:{float:"right"}},ao=R({__name:"cert",setup(z){const s=M("cert"),d=A(""),u=i=>{navigator.clipboard.writeText(i).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return ht(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(i,l)=>{const c=_("el-button"),w=_("el-card"),v=_("el-input"),k=_("el-col"),y=_("el-row"),b=_("el-dialog");return r(),f(tt,null,[o(w,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[28]||(l[28]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",xn,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",zn,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"通用名称",-1)),e("td",Dn,a(t(s).common_name),1)]),t(s).vendor_id?(r(),f("tr",Tn,[l[11]||(l[11]=e("td",{class:"label"},"CA订单ID",-1)),e("td",Vn,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(r(),f("tr",Yn,[l[12]||(l[12]=e("td",{class:"label"},"动作",-1)),e("td",Sn,a(t(Ht)[t(s).action]),1)])):p("",!0),t(s).channel?(r(),f("tr",In,[l[13]||(l[13]=e("td",{class:"label"},"来源",-1)),e("td",Mn,a(t(Ot)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[14]||(l[14]=e("td",{class:"label"},"金额",-1)),e("td",En,a(t(s).amount),1)]),t(s).issuer?(r(),f("tr",Hn,[l[15]||(l[15]=e("td",{class:"label"},"签发者",-1)),e("td",On,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(r(),f("tr",Pn,[l[16]||(l[16]=e("td",{class:"label"},"序列号",-1)),e("td",hn,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(r(),f("tr",Ln,[l[17]||(l[17]=e("td",{class:"label"},"指纹",-1)),e("td",An,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(r(),f("tr",Bn,[l[18]||(l[18]=e("td",{class:"label"},"加密算法",-1)),e("td",Rn,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(r(),f("tr",Wn,[l[19]||(l[19]=e("td",{class:"label"},"摘要算法",-1)),e("td",jn,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(r(),f("tr",Un,[l[20]||(l[20]=e("td",{class:"label"},"签发时间",-1)),e("td",Nn,a(t(s).issued_at?t(W)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(r(),f("tr",qn,[l[21]||(l[21]=e("td",{class:"label"},"到期时间",-1)),e("td",Kn,a(t(s).expires_at?t(W)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(r(),f("tr",Fn,[l[23]||(l[23]=e("td",{class:"label"},"CSR",-1)),e("td",Gn,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=g=>d.value="csr")},{default:n(()=>[...l[22]||(l[22]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(r(),f("tr",Jn,[l[25]||(l[25]=e("td",{class:"label"},"私钥",-1)),e("td",Xn,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=g=>d.value="private_key")},{default:n(()=>[...l[24]||(l[24]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(r(),f("tr",Zn,[l[27]||(l[27]=e("td",{class:"label"},"证书",-1)),e("td",Qn,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=g=>d.value="cert")},{default:n(()=>[...l[26]||(l[26]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(b,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=g=>d.value="")},{header:n(()=>[d.value=="csr"?(r(),f("div",to," 查看CSR ")):p("",!0),d.value=="private_key"?(r(),f("div",eo," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(r(),$(y,{key:0},{default:n(()=>[o(k,null,{default:n(()=>[l[30]||(l[30]=e("span",null,"请求文件(CSR)",-1)),e("span",lo,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=g=>u(t(s).csr))},{default:n(()=>[...l[29]||(l[29]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(r(),$(y,{key:1},{default:n(()=>[o(k,null,{default:n(()=>[l[32]||(l[32]=e("span",null,"私钥(KEY)",-1)),e("span",so,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=g=>u(t(s).private_key))},{default:n(()=>[...l[31]||(l[31]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(b,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=g=>d.value="")},{header:n(()=>[...l[33]||(l[33]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(k,{span:12},{default:n(()=>[l[35]||(l[35]=e("span",null,"证书(CERT)",-1)),e("span",no,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=g=>u(t(s).cert))},{default:n(()=>[...l[34]||(l[34]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(k,{span:12},{default:n(()=>[l[37]||(l[37]=e("span",null,"证书链(CHAIN)",-1)),e("span",oo,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=g=>u(t(s).intermediate_cert))},{default:n(()=>[...l[36]||(l[36]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),_e=F(ao,[["__scopeId","data-v-e7a5ed59"]]),ro=R({__name:"issueList",props:{activeTab:{type:String,required:!0}},setup(z){const s=z,d=M("order"),u=A([]),i=lt({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]}),l=()=>_t(null,null,function*(){s.activeTab==="issueList"&&Ve({currentPage:i.currentPage,pageSize:i.pageSize,order_id:d.id}).then(v=>{v.code===1&&(u.value=v.data.items,i.total=v.data.total)})}),c=v=>{i.pageSize=v,l()},w=v=>{i.currentPage=v,l()};return bt(()=>d.sync,()=>{l()}),bt(()=>s.activeTab,v=>{v==="issueList"&&l()}),(v,k)=>{const y=_("el-card");return r(),$(y,{shadow:"never",style:{border:"none"}},{default:n(()=>[k[0]||(k[0]=e("h2",{class:"title"},[e("span",null,"颁发记录")],-1)),o(t(Te),{columns:t(Ye),data:u.value,pagination:i,"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:c,onPageCurrentChange:w},null,8,["columns","data","pagination"])]),_:1})}}}),io=F(ro,[["__scopeId","data-v-525cd7a6"]]),uo=R({__name:"index",setup(z){const s=A("detail"),d=A(window.innerWidth),u=()=>{d.value=window.innerWidth};return ut(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(i,l)=>{const c=_("el-col"),w=_("el-row"),v=_("el-tab-pane"),k=_("el-tabs");return r(),$(k,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(v,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(r(),$(w,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(pe)]),_:1}),o(c,{span:12},{default:n(()=>[o(me),o(_e)]),_:1})]),_:1})):(r(),$(w,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(pe),o(me),o(_e)]),_:1})]),_:1}))]),_:1}),o(v,{label:"颁发记录",name:"issueList"},{default:n(()=>[o(io,{"active-tab":s.value},null,8,["active-tab"])]),_:1})]),_:1},8,["modelValue"])}}}),co={class:"dialog-footer"},po=R({__name:"operate",setup(z){var S;const{toDetail:s}=Bt(),d=$t(),u=d.path,i=d.params,l=M("order"),c=M("cert"),w=M("sync"),v=M("get"),k=K(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),y=E=>{if(E)switch(E){case"send":g.value=!0;break;case"commit":Y();break;case"sync":w(!0);break;case"commitCancel":j();break;case"revokeCancel":N();break}},b=A((S=l==null?void 0:l.user)==null?void 0:S.email),g=A(!1),T=()=>{Rt(l.id,b.value).then(()=>{g.value=!1,I("发送成功",{type:"success"})})},Y=()=>{kt(l.id).then(()=>{I("提交成功",{type:"success"}),v()})},j=()=>{vt.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let E=i.ids.toString().split(",");E.length>1?(E=E.filter(D=>D!==l.id.toString()),s({ids:E.join(",")},"params")):Pt.push({name:"Order"})}else rt(l.id).then(E=>{E.data.sync=it(),Object.assign(l,lt(E.data))})})})},N=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),rt(l.id).then(E=>{E.data.sync=it(),Object.assign(l,lt(E.data))})})};return(E,D)=>{const P=_("el-icon"),C=_("el-button"),G=_("el-dropdown-item"),st=_("el-dropdown-menu"),q=_("el-dropdown"),ct=_("el-input"),V=_("el-form-item"),x=_("el-dialog");return r(),f(tt,null,[o(q,{style:{"margin-top":"7px"},onCommand:y},{dropdown:n(()=>[o(st,null,{default:n(()=>[t(c).status=="active"?(r(),$(G,{key:0,command:"send"},{default:n(()=>[...D[6]||(D[6]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(r(),$(G,{key:1,command:"commit"},{default:n(()=>[...D[7]||(D[7]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(r(),$(G,{key:2,command:"sync"},{default:n(()=>[...D[8]||(D[8]=[m(a("同步"),-1)])]),_:1})):p("",!0),k.value?(r(),$(G,{key:3,command:"commitCancel",divided:""},{default:n(()=>[...D[9]||(D[9]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(r(),$(G,{key:4,command:"revokeCancel"},{default:n(()=>[...D[10]||(D[10]=[m(a("撤回"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(C,{type:"primary",size:"small"},{default:n(()=>[D[5]||(D[5]=m(a("操作")+" ",-1)),o(P,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(C,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:D[0]||(D[0]=H=>t(v)(!0))},{default:n(()=>[o(P,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(qt))]),_:1})]),_:1}),o(x,{modelValue:g.value,"onUpdate:modelValue":D[4]||(D[4]=H=>g.value=H),title:"发送邮件"},{footer:n(()=>[e("span",co,[o(C,{onClick:D[2]||(D[2]=H=>g.value=!1)},{default:n(()=>[...D[11]||(D[11]=[m(a("取消"),-1)])]),_:1}),o(C,{type:"primary",onClick:D[3]||(D[3]=H=>T())},{default:n(()=>[...D[12]||(D[12]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(V,{label:"邮箱","label-width":100},{default:n(()=>[o(ct,{modelValue:b.value,"onUpdate:modelValue":D[1]||(D[1]=H=>b.value=H),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])],64)}}}),mo={class:"title"},_o={style:{"margin-left":"15px"}},vo={class:"descriptions",style:{width:"100%"}},yo={class:"label"},fo={key:0},go={class:"label"},bo={key:1},ko={class:"content"},$o={class:"label"},Co=R({__name:"process",setup(z){const s=M("order"),d=M("cert"),u=k=>K(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[k]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),i=u("cert_apply_status"),l=u("org_verify_status"),c=K(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),w=K(()=>{var b,g;if(!["unpaid","pending","processing","active","expired","approving","cancelling"].includes((b=d.value)==null?void 0:b.status))return!1;if(!((g=s.value)!=null&&g.period_till))return!0;const y=W(s.value.period_till);return y.isValid()&&y.isAfter(W())}),v=A(null);return ut(()=>{if(v.value){const k=v.value.$el,y=window.getComputedStyle(k),b=y.backgroundColor,g=y.borderColor,T=y.color;k.style.setProperty("--original-bg-color",b),k.style.setProperty("--original-border-color",g),k.style.setProperty("--original-text-color",T)}}),(k,y)=>{const b=_("el-icon"),g=_("el-card");return r(),$(g,{shadow:"never",style:{border:"none"}},{default:n(()=>{var T,Y;return[e("h2",mo,[y[0]||(y[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Ft),{ref_key:"statusButton",ref:v,type:t(Mt)[(T=t(d))==null?void 0:T.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var j;return[m(a(t(Et)[(j=t(d))==null?void 0:j.status]),1)]}),_:1},8,["type"]),e("span",_o,[w.value?(r(),$(po,{key:0})):p("",!0)])]),e("table",vo,[e("tbody",null,[e("tr",null,[e("td",yo,[o(b,{size:16,class:"icon",color:t(i)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[1]||(y[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(r(),f("tr",fo,[e("td",go,[o(b,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[2]||(y[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((Y=t(s).brand)==null?void 0:Y.toLowerCase())==="certum"?(r(),f("tr",bo,[y[3]||(y[3]=e("td",{class:"label"},null,-1)),e("td",ko,[o(Xt)])])):p("",!0),e("tr",null,[e("td",$o,[o(b,{size:16,class:"icon",color:c.value},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[4]||(y[4]=e("td",{class:"content"},"签发证书",-1))])])])]}),_:1})}}}),ve=F(Co,[["__scopeId","data-v-1d93f6e5"]]),wo={class:"descriptions"},xo={class:"content"},zo={class:"content"},Do={class:"content"},To={class:"content"},Vo={class:"content"},Yo={class:"content"},So={class:"content"},Io={key:0},Mo={class:"content"},Eo={key:1},Ho={class:"content"},Oo={class:"content"},Po=R({__name:"order",setup(z){const s=M("order"),d=()=>{vt.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{Ut(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),rt(s.id).then(i=>{i.data.sync=it(),Object.assign(s,lt(i.data))})})})};return(u,i)=>{const l=_("el-button"),c=_("el-card");return r(),$(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[i[13]||(i[13]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",wo,[e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("td",{class:"label"},"订单ID",-1)),e("td",xo,a(t(s).id),1)]),e("tr",null,[i[1]||(i[1]=e("td",{class:"label"},"品牌",-1)),e("td",zo,a(t(s).brand),1)]),e("tr",null,[i[2]||(i[2]=e("td",{class:"label"},"产品",-1)),e("td",Do,a(t(s).product.name),1)]),e("tr",null,[i[3]||(i[3]=e("td",{class:"label"},"金额",-1)),e("td",To,a(t(s).amount),1)]),e("tr",null,[i[4]||(i[4]=e("td",{class:"label"},"购买时长",-1)),e("td",Vo,a(t(Jt)[t(s).period]),1)]),e("tr",null,[i[5]||(i[5]=e("td",{class:"label"},"有效期从",-1)),e("td",Yo,a(t(s).period_from?t(W)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),e("tr",null,[i[6]||(i[6]=e("td",{class:"label"},"有效期到",-1)),e("td",So,a(t(s).period_till?t(W)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),t(s).organization?(r(),f("tr",Io,[i[9]||(i[9]=e("td",{class:"label"},"组织",-1)),e("td",Mo,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),i[7]||(i[7]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),i[8]||(i[8]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(r(),f("tr",Eo,[i[11]||(i[11]=e("td",{class:"label"},"联系人",-1)),e("td",Ho,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),i[10]||(i[10]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[i[12]||(i[12]=e("td",{class:"label"},"备注",-1)),e("td",Oo,[m(a(t(s).remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),ye=F(Po,[["__scopeId","data-v-19367f48"]]),ho={class:"descriptions"},Lo={class:"content"},Ao={class:"content"},Bo={key:0},Ro={class:"content"},Wo={key:1},jo={class:"content"},Uo={key:2},No={class:"content"},qo={class:"content"},Ko={key:3},Fo={class:"content"},Go={key:4},Jo={class:"content"},Xo={key:5},Zo={class:"content"},Qo={key:6},ta={class:"content"},ea={key:7},la={class:"content"},sa={key:8},na={class:"content"},oa={key:9},aa={class:"content"},ra={key:10},ia={class:"content"},da={key:11},ua={class:"content"},ca={key:12},pa={class:"content"},ma={key:0,class:"title",style:{"margin-bottom":"0"}},_a={key:1,class:"title",style:{"margin-bottom":"0"}},va={style:{float:"right"}},ya={style:{float:"right"}},fa={style:{float:"right"}},ga={style:{float:"right"}},ba=R({__name:"cert",setup(z){const s=M("cert"),d=A(""),u=i=>{navigator.clipboard.writeText(i).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return ht(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(i,l)=>{const c=_("el-button"),w=_("el-card"),v=_("el-input"),k=_("el-col"),y=_("el-row"),b=_("el-dialog");return r(),f(tt,null,[o(w,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[28]||(l[28]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",ho,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",Lo,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"组织名称",-1)),e("td",Ao,a(t(s).common_name),1)]),t(s).vendor_id?(r(),f("tr",Bo,[l[11]||(l[11]=e("td",{class:"label"},"CA订单ID",-1)),e("td",Ro,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(r(),f("tr",Wo,[l[12]||(l[12]=e("td",{class:"label"},"动作",-1)),e("td",jo,a(t(Ht)[t(s).action]),1)])):p("",!0),t(s).channel?(r(),f("tr",Uo,[l[13]||(l[13]=e("td",{class:"label"},"来源",-1)),e("td",No,a(t(Ot)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[14]||(l[14]=e("td",{class:"label"},"金额",-1)),e("td",qo,a(t(s).amount),1)]),t(s).issuer?(r(),f("tr",Ko,[l[15]||(l[15]=e("td",{class:"label"},"签发者",-1)),e("td",Fo,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(r(),f("tr",Go,[l[16]||(l[16]=e("td",{class:"label"},"序列号",-1)),e("td",Jo,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(r(),f("tr",Xo,[l[17]||(l[17]=e("td",{class:"label"},"指纹",-1)),e("td",Zo,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(r(),f("tr",Qo,[l[18]||(l[18]=e("td",{class:"label"},"加密算法",-1)),e("td",ta,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(r(),f("tr",ea,[l[19]||(l[19]=e("td",{class:"label"},"摘要算法",-1)),e("td",la,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(r(),f("tr",sa,[l[20]||(l[20]=e("td",{class:"label"},"签发时间",-1)),e("td",na,a(t(s).issued_at?t(W)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(r(),f("tr",oa,[l[21]||(l[21]=e("td",{class:"label"},"到期时间",-1)),e("td",aa,a(t(s).expires_at?t(W)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(r(),f("tr",ra,[l[23]||(l[23]=e("td",{class:"label"},"CSR",-1)),e("td",ia,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=g=>d.value="csr")},{default:n(()=>[...l[22]||(l[22]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(r(),f("tr",da,[l[25]||(l[25]=e("td",{class:"label"},"私钥",-1)),e("td",ua,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=g=>d.value="private_key")},{default:n(()=>[...l[24]||(l[24]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(r(),f("tr",ca,[l[27]||(l[27]=e("td",{class:"label"},"证书",-1)),e("td",pa,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=g=>d.value="cert")},{default:n(()=>[...l[26]||(l[26]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(b,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=g=>d.value="")},{header:n(()=>[d.value=="csr"?(r(),f("div",ma," 查看CSR ")):p("",!0),d.value=="private_key"?(r(),f("div",_a," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(r(),$(y,{key:0},{default:n(()=>[o(k,null,{default:n(()=>[l[30]||(l[30]=e("span",null,"请求文件(CSR)",-1)),e("span",va,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=g=>u(t(s).csr))},{default:n(()=>[...l[29]||(l[29]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(r(),$(y,{key:1},{default:n(()=>[o(k,null,{default:n(()=>[l[32]||(l[32]=e("span",null,"私钥(KEY)",-1)),e("span",ya,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=g=>u(t(s).private_key))},{default:n(()=>[...l[31]||(l[31]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(b,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=g=>d.value="")},{header:n(()=>[...l[33]||(l[33]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(k,{span:12},{default:n(()=>[l[35]||(l[35]=e("span",null,"证书(CERT)",-1)),e("span",fa,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=g=>u(t(s).cert))},{default:n(()=>[...l[34]||(l[34]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(k,{span:12},{default:n(()=>[l[37]||(l[37]=e("span",null,"证书链(CHAIN)",-1)),e("span",ga,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=g=>u(t(s).intermediate_cert))},{default:n(()=>[...l[36]||(l[36]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),fe=F(ba,[["__scopeId","data-v-17b84eb5"]]),ka=R({__name:"index",setup(z){const s=A("detail"),d=A(window.innerWidth),u=()=>{d.value=window.innerWidth};return ut(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(i,l)=>{const c=_("el-col"),w=_("el-row"),v=_("el-tab-pane"),k=_("el-tabs");return r(),$(k,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(v,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(r(),$(w,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(ve)]),_:1}),o(c,{span:12},{default:n(()=>[o(ye),o(fe)]),_:1})]),_:1})):(r(),$(w,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(ve),o(ye),o(fe)]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])}}}),$a={class:"dialog-footer"},Ca=R({__name:"operate",setup(z){var S;const{toDetail:s}=Bt(),d=$t(),u=d.path,i=d.params,l=M("order"),c=M("cert"),w=M("sync"),v=M("get"),k=K(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),y=E=>{if(E)switch(E){case"send":g.value=!0;break;case"commit":Y();break;case"sync":w(!0);break;case"commitCancel":j();break;case"revokeCancel":N();break}},b=A((S=l==null?void 0:l.user)==null?void 0:S.email),g=A(!1),T=()=>{Rt(l.id,b.value).then(()=>{g.value=!1,I("发送成功",{type:"success"})})},Y=()=>{kt(l.id).then(()=>{I("提交成功",{type:"success"}),v()})},j=()=>{vt.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let E=i.ids.toString().split(",");E.length>1?(E=E.filter(D=>D!==l.id.toString()),s({ids:E.join(",")},"params")):Pt.push({name:"Order"})}else rt(l.id).then(E=>{E.data.sync=it(),Object.assign(l,lt(E.data))})})})},N=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),rt(l.id).then(E=>{E.data.sync=it(),Object.assign(l,lt(E.data))})})};return(E,D)=>{const P=_("el-icon"),C=_("el-button"),G=_("el-dropdown-item"),st=_("el-dropdown-menu"),q=_("el-dropdown"),ct=_("el-input"),V=_("el-form-item"),x=_("el-dialog");return r(),f(tt,null,[o(q,{style:{"margin-top":"7px"},onCommand:y},{dropdown:n(()=>[o(st,null,{default:n(()=>[t(c).status=="active"?(r(),$(G,{key:0,command:"send"},{default:n(()=>[...D[6]||(D[6]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(r(),$(G,{key:1,command:"commit"},{default:n(()=>[...D[7]||(D[7]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(r(),$(G,{key:2,command:"sync"},{default:n(()=>[...D[8]||(D[8]=[m(a("同步"),-1)])]),_:1})):p("",!0),k.value?(r(),$(G,{key:3,command:"commitCancel",divided:""},{default:n(()=>[...D[9]||(D[9]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(r(),$(G,{key:4,command:"revokeCancel"},{default:n(()=>[...D[10]||(D[10]=[m(a("撤回"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(C,{type:"primary",size:"small"},{default:n(()=>[D[5]||(D[5]=m(a("操作")+" ",-1)),o(P,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(C,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:D[0]||(D[0]=H=>t(v)(!0))},{default:n(()=>[o(P,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(qt))]),_:1})]),_:1}),o(x,{modelValue:g.value,"onUpdate:modelValue":D[4]||(D[4]=H=>g.value=H),title:"发送邮件"},{footer:n(()=>[e("span",$a,[o(C,{onClick:D[2]||(D[2]=H=>g.value=!1)},{default:n(()=>[...D[11]||(D[11]=[m(a("取消"),-1)])]),_:1}),o(C,{type:"primary",onClick:D[3]||(D[3]=H=>T())},{default:n(()=>[...D[12]||(D[12]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(V,{label:"邮箱","label-width":100},{default:n(()=>[o(ct,{modelValue:b.value,"onUpdate:modelValue":D[1]||(D[1]=H=>b.value=H),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])],64)}}}),wa={class:"title"},xa={style:{"margin-left":"15px"}},za={class:"descriptions",style:{width:"100%"}},Da={class:"label"},Ta={key:0},Va={class:"label"},Ya={key:1},Sa={class:"content"},Ia={class:"label"},Ma=R({__name:"process",setup(z){const s=M("order"),d=M("cert"),u=k=>K(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[k]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),i=u("cert_apply_status"),l=u("org_verify_status"),c=K(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),w=K(()=>{var b,g;if(!["unpaid","pending","processing","active","expired","approving","cancelling"].includes((b=d.value)==null?void 0:b.status))return!1;if(!((g=s.value)!=null&&g.period_till))return!0;const y=W(s.value.period_till);return y.isValid()&&y.isAfter(W())}),v=A(null);return ut(()=>{if(v.value){const k=v.value.$el,y=window.getComputedStyle(k),b=y.backgroundColor,g=y.borderColor,T=y.color;k.style.setProperty("--original-bg-color",b),k.style.setProperty("--original-border-color",g),k.style.setProperty("--original-text-color",T)}}),(k,y)=>{const b=_("el-icon"),g=_("el-card");return r(),$(g,{shadow:"never",style:{border:"none"}},{default:n(()=>{var T,Y;return[e("h2",wa,[y[0]||(y[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Ft),{ref_key:"statusButton",ref:v,type:t(Mt)[(T=t(d))==null?void 0:T.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var j;return[m(a(t(Et)[(j=t(d))==null?void 0:j.status]),1)]}),_:1},8,["type"]),e("span",xa,[w.value?(r(),$(Ca,{key:0})):p("",!0)])]),e("table",za,[e("tbody",null,[e("tr",null,[e("td",Da,[o(b,{size:16,class:"icon",color:t(i)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[1]||(y[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(r(),f("tr",Ta,[e("td",Va,[o(b,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[2]||(y[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((Y=t(s).brand)==null?void 0:Y.toLowerCase())==="certum"?(r(),f("tr",Ya,[y[3]||(y[3]=e("td",{class:"label"},null,-1)),e("td",Sa,[o(Xt)])])):p("",!0),e("tr",null,[e("td",Ia,[o(b,{size:16,class:"icon",color:c.value},{default:n(()=>[o(t(at))]),_:1},8,["color"])]),y[4]||(y[4]=e("td",{class:"content"},"签发证书",-1))])])])]}),_:1})}}}),ge=F(Ma,[["__scopeId","data-v-055ca139"]]),Ea={class:"descriptions"},Ha={class:"content"},Oa={class:"content"},Pa={class:"content"},ha={class:"content"},La={class:"content"},Aa={class:"content"},Ba={class:"content"},Ra={key:0},Wa={class:"content"},ja={key:1},Ua={class:"content"},Na={class:"content"},qa=R({__name:"order",setup(z){const s=M("order"),d=()=>{vt.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{Ut(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),rt(s.id).then(i=>{i.data.sync=it(),Object.assign(s,lt(i.data))})})})};return(u,i)=>{const l=_("el-button"),c=_("el-card");return r(),$(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[i[13]||(i[13]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",Ea,[e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("td",{class:"label"},"订单ID",-1)),e("td",Ha,a(t(s).id),1)]),e("tr",null,[i[1]||(i[1]=e("td",{class:"label"},"品牌",-1)),e("td",Oa,a(t(s).brand),1)]),e("tr",null,[i[2]||(i[2]=e("td",{class:"label"},"产品",-1)),e("td",Pa,a(t(s).product.name),1)]),e("tr",null,[i[3]||(i[3]=e("td",{class:"label"},"金额",-1)),e("td",ha,a(t(s).amount),1)]),e("tr",null,[i[4]||(i[4]=e("td",{class:"label"},"购买时长",-1)),e("td",La,a(t(Jt)[t(s).period]),1)]),e("tr",null,[i[5]||(i[5]=e("td",{class:"label"},"有效期从",-1)),e("td",Aa,a(t(s).period_from?t(W)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),e("tr",null,[i[6]||(i[6]=e("td",{class:"label"},"有效期到",-1)),e("td",Ba,a(t(s).period_till?t(W)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]),t(s).organization?(r(),f("tr",Ra,[i[9]||(i[9]=e("td",{class:"label"},"组织",-1)),e("td",Wa,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),i[7]||(i[7]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),i[8]||(i[8]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(r(),f("tr",ja,[i[11]||(i[11]=e("td",{class:"label"},"联系人",-1)),e("td",Ua,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),i[10]||(i[10]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[i[12]||(i[12]=e("td",{class:"label"},"备注",-1)),e("td",Na,[m(a(t(s).remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),be=F(qa,[["__scopeId","data-v-7c2ff1a1"]]),Ka={class:"descriptions"},Fa={class:"content"},Ga={class:"content"},Ja={key:0},Xa={class:"content"},Za={key:1},Qa={class:"content"},tr={key:2},er={class:"content"},lr={class:"content"},sr={key:3},nr={class:"content"},or={key:4},ar={class:"content"},rr={key:5},ir={class:"content"},dr={key:6},ur={class:"content"},cr={key:7},pr={class:"content"},mr={key:8},_r={class:"content"},vr={key:9},yr={class:"content"},fr={key:10},gr={class:"content"},br={key:11},kr={class:"content"},$r={key:12},Cr={class:"content"},wr={key:0,class:"title",style:{"margin-bottom":"0"}},xr={key:1,class:"title",style:{"margin-bottom":"0"}},zr={style:{float:"right"}},Dr={style:{float:"right"}},Tr={style:{float:"right"}},Vr={style:{float:"right"}},Yr=R({__name:"cert",setup(z){const s=M("cert"),d=A(""),u=i=>{navigator.clipboard.writeText(i).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return ht(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(i,l)=>{const c=_("el-button"),w=_("el-card"),v=_("el-input"),k=_("el-col"),y=_("el-row"),b=_("el-dialog");return r(),f(tt,null,[o(w,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[28]||(l[28]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",Ka,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",Fa,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"组织名称",-1)),e("td",Ga,a(t(s).common_name),1)]),t(s).vendor_id?(r(),f("tr",Ja,[l[11]||(l[11]=e("td",{class:"label"},"CA订单ID",-1)),e("td",Xa,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(r(),f("tr",Za,[l[12]||(l[12]=e("td",{class:"label"},"动作",-1)),e("td",Qa,a(t(Ht)[t(s).action]),1)])):p("",!0),t(s).channel?(r(),f("tr",tr,[l[13]||(l[13]=e("td",{class:"label"},"来源",-1)),e("td",er,a(t(Ot)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[14]||(l[14]=e("td",{class:"label"},"金额",-1)),e("td",lr,a(t(s).amount),1)]),t(s).issuer?(r(),f("tr",sr,[l[15]||(l[15]=e("td",{class:"label"},"签发者",-1)),e("td",nr,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(r(),f("tr",or,[l[16]||(l[16]=e("td",{class:"label"},"序列号",-1)),e("td",ar,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(r(),f("tr",rr,[l[17]||(l[17]=e("td",{class:"label"},"指纹",-1)),e("td",ir,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(r(),f("tr",dr,[l[18]||(l[18]=e("td",{class:"label"},"加密算法",-1)),e("td",ur,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(r(),f("tr",cr,[l[19]||(l[19]=e("td",{class:"label"},"摘要算法",-1)),e("td",pr,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(r(),f("tr",mr,[l[20]||(l[20]=e("td",{class:"label"},"签发时间",-1)),e("td",_r,a(t(s).issued_at?t(W)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(r(),f("tr",vr,[l[21]||(l[21]=e("td",{class:"label"},"到期时间",-1)),e("td",yr,a(t(s).expires_at?t(W)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(r(),f("tr",fr,[l[23]||(l[23]=e("td",{class:"label"},"CSR",-1)),e("td",gr,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=g=>d.value="csr")},{default:n(()=>[...l[22]||(l[22]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(r(),f("tr",br,[l[25]||(l[25]=e("td",{class:"label"},"私钥",-1)),e("td",kr,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=g=>d.value="private_key")},{default:n(()=>[...l[24]||(l[24]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(r(),f("tr",$r,[l[27]||(l[27]=e("td",{class:"label"},"证书",-1)),e("td",Cr,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=g=>d.value="cert")},{default:n(()=>[...l[26]||(l[26]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(b,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=g=>d.value="")},{header:n(()=>[d.value=="csr"?(r(),f("div",wr," 查看CSR ")):p("",!0),d.value=="private_key"?(r(),f("div",xr," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(r(),$(y,{key:0},{default:n(()=>[o(k,null,{default:n(()=>[l[30]||(l[30]=e("span",null,"请求文件(CSR)",-1)),e("span",zr,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=g=>u(t(s).csr))},{default:n(()=>[...l[29]||(l[29]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(r(),$(y,{key:1},{default:n(()=>[o(k,null,{default:n(()=>[l[32]||(l[32]=e("span",null,"私钥(KEY)",-1)),e("span",Dr,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=g=>u(t(s).private_key))},{default:n(()=>[...l[31]||(l[31]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(b,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=g=>d.value="")},{header:n(()=>[...l[33]||(l[33]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(k,{span:12},{default:n(()=>[l[35]||(l[35]=e("span",null,"证书(CERT)",-1)),e("span",Tr,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=g=>u(t(s).cert))},{default:n(()=>[...l[34]||(l[34]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(k,{span:12},{default:n(()=>[l[37]||(l[37]=e("span",null,"证书链(CHAIN)",-1)),e("span",Vr,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=g=>u(t(s).intermediate_cert))},{default:n(()=>[...l[36]||(l[36]=[m("点击复制",-1)])]),_:1})]),o(v,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),ke=F(Yr,[["__scopeId","data-v-03349d64"]]),Sr=R({__name:"index",setup(z){const s=A("detail"),d=A(window.innerWidth),u=()=>{d.value=window.innerWidth};return ut(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(i,l)=>{const c=_("el-col"),w=_("el-row"),v=_("el-tab-pane"),k=_("el-tabs");return r(),$(k,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(v,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(r(),$(w,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(ge)]),_:1}),o(c,{span:12},{default:n(()=>[o(be),o(ke)]),_:1})]),_:1})):(r(),$(w,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(ge),o(be),o(ke)]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])}}}),Ir={class:"box"},Mr=R({__name:"index",props:["modelValue"],setup(z){const d=lt(z.modelValue);St("order",d);const u=K(()=>{var v;return((v=d.product)==null?void 0:v.product_type)||"ssl"});St("productType",u);const{latest_cert:i}=Fe(d);St("cert",i);const l=(v=!1)=>{Ae(d.id).then(()=>{rt(d.id).then(k=>{k.data.sync=it(),Object.assign(d,lt(k.data)),v&&I("同步成功",{type:"success"})})})},c=(v=!1)=>{rt(d.id).then(k=>{k.data.sync=it(),Object.assign(d,lt(k.data)),v&&I("刷新成功",{type:"success"})})};St("sync",l),St("get",c);let w=null;return ut(()=>{w=setInterval(()=>{c()},180*1e3)}),Ge(()=>{w!==null&&(clearInterval(w),w=null)}),(v,k)=>{const y=_("el-scrollbar");return r(),$(y,{class:"horizontal-scrollbar","wrap-class":"scroll-wrapper"},{default:n(()=>[e("div",Ir,[u.value==="ssl"?(r(),$(ce,{key:0})):u.value==="smime"?(r(),$(uo,{key:1})):u.value==="codesign"?(r(),$(ka,{key:2})):u.value==="docsign"?(r(),$(Sr,{key:3})):(r(),$(ce,{key:4}))])]),_:1})}}}),Er=F(Mr,[["__scopeId","data-v-86af38ad"]]),Hr={class:"main"},Or=R({name:"OrderDetails",__name:"details",setup(z){const s=A([]),d=()=>{const u=Pt.currentRoute.value.params.ids;u&&Be(u.toString()).then(i=>{s.value=i.data})};return ut(()=>{d()}),(u,i)=>(r(),f("div",Hr,[(r(!0),f(tt,null,It(s.value,(l,c)=>(r(),f("div",{key:c,class:"layout-main bg-bg_color"},[o(Er,{modelValue:s.value[c],"onUpdate:modelValue":w=>s.value[c]=w},null,8,["modelValue","onUpdate:modelValue"])]))),128))]))}}),Ur=F(Or,[["__scopeId","data-v-f4087d9b"]]);export{Ur as default};
