var z=Object.defineProperty,R=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var x=(n,t,a)=>t in n?z(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,b=(n,t)=>{for(var a in t||(t={}))D.call(t,a)&&x(n,a,t[a]);if(S)for(var a of S(t))T.call(t,a)&&x(n,a,t[a]);return n},C=(n,t)=>R(n,k(t));import{e as I,r as g,f as L,t as Y,n as M,g as V,k as d,l as h,z as B,M as F,j as N,p as U,C as E,F as H,v as j,y as O,G as l,H as q,x as A,P as G,_ as W}from"./index-D5efkW8k.js";import{c as $,g as J}from"./utils-BPqdEplT.js";import{P as K}from"./plus-search-Cl3d-rfH.js";import"./index-CsaBZZ8X.js";function Q(n){return I.get("/invoice-limit",{params:n})}function X(n){const t=g({}),a=g([]),e=g(!0),o=L({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]});function c(i){o.pageSize=i,u()}function p(i){o.currentPage=i,u()}function u(){e.value=!0;const i=C(b({},Y(t.value)),{pageSize:o.pageSize,currentPage:o.currentPage});i.created_at&&(i.created_at=$(i.created_at)),Q(i).then(({data:f})=>{a.value=f.items,o.total=f.total,o.pageSize=f.pageSize,o.currentPage=f.currentPage,M(()=>{n.value&&n.value.getTableRef().clearSelection()})}).finally(()=>{e.value=!1})}return{loading:e,search:t,dataList:a,pagination:o,handleSizeChange:c,handleCurrentChange:p,onSearch:u,onReset:()=>{u()},onCollapse:()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},500)}}}const y=[{label:"开票",value:"issue"},{label:"作废",value:"void"},{label:"充值",value:"addfunds"},{label:"退款",value:"refunds"}],Z={issue:"success",void:"danger",addfunds:"primary",refunds:"warning"};function ee(n){const t=V(()=>{n()},500);return{searchColumns:[{label:"类型",prop:"type",valueType:"select",fieldProps:{placeholder:"请选择类型"},options:y,onChange:()=>{t()}},{label:"限额ID",prop:"limit_id",valueType:"input",fieldProps:{placeholder:"请输入限额ID"}},{label:"金额",prop:"amount",renderField:(e,o)=>{var p,u;const c=(s,r)=>{s!==void 0&&r!==void 0&&s>r||o([s,r])};return d("div",{class:"flex items-center gap-2 w-full"},[d(h("el-input"),{class:"flex-1",modelValue:(p=e==null?void 0:e[0])==null?void 0:p.toString(),"onUpdate:modelValue":s=>{const r=s===""?void 0:Number(s);c(r,e==null?void 0:e[1])},placeholder:"最小金额",clearable:!0},null),d("span",{class:"flex-none"},[B("至")]),d(h("el-input"),{class:"flex-1",modelValue:(u=e==null?void 0:e[1])==null?void 0:u.toString(),"onUpdate:modelValue":s=>{const r=s===""?void 0:Number(s);c(e==null?void 0:e[0],r)},placeholder:"最大金额",clearable:!0},null)])}},{label:"创建时间",prop:"created_at",valueType:"date-picker",fieldProps:{type:"daterange",rangeSeparator:"至",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD",shortcuts:J()}}]}}function te(){const n=g(),t=F();return{tableRef:n,tableColumns:[{label:"类型",prop:"type",width:80,cellRenderer:({row:e,props:o})=>d(h("el-tag"),{size:o.size,type:Z[e.type],effect:"plain"},{default:()=>{var c;return[(c=y.find(p=>p.value===e.type))==null?void 0:c.label]}})},{label:"限额ID",prop:"limit_id",minWidth:100,cellRenderer:({row:e})=>d("span",{class:"cursor-pointer",onClick:()=>{t.push({path:["addfunds","refunds"].includes(e.type)?"/funds":"/invoice",query:{id:e.limit_id}})}},[e.limit_id])},{label:"金额",prop:"amount",width:100},{label:"操作前",prop:"limit_before",width:100},{label:"操作后",prop:"limit_after",width:100},{label:"创建时间",prop:"created_at",width:170,formatter:({created_at:e})=>e?N(e).format("YYYY-MM-DD HH:mm:ss"):"-"}]}}const ne={class:"main"},ae={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[12px] overflow-auto"},oe=U({name:"InvoiceLimit",__name:"index",setup(n){const{tableRef:t,tableColumns:a}=te(),{loading:e,search:o,dataList:c,pagination:p,handleSizeChange:u,handleCurrentChange:s,onSearch:r,onReset:i,onCollapse:f}=X(t),{searchColumns:v}=ee(()=>r());return E(()=>{r()}),(le,_)=>{const P=h("pure-table");return j(),H("div",ne,[O("div",ae,[d(l(K),{modelValue:l(o),"onUpdate:modelValue":_[0]||(_[0]=m=>q(o)?o.value=m:null),columns:l(v),"show-number":2,"row-props":{gutter:12},"col-props":{xs:24,sm:12,md:8,lg:6,xl:4},"label-width":"80","label-position":"right","label-suffix":"","search-text":"搜索","reset-text":"重置","expand-text":"展开","retract-text":"收起",onSearch:l(r),onReset:l(i),onCollapse:l(f)},null,8,["modelValue","columns","onSearch","onReset","onCollapse"])]),d(l(G),{title:"发票额度",columns:l(a),onRefresh:l(r)},{default:A(({size:m,dynamicColumns:w})=>[d(P,{ref_key:"tableRef",ref:t,"row-key":"id","align-whole":"left","table-layout":"auto",loading:l(e),size:m,adaptive:"",adaptiveConfig:{offsetBottom:108},data:l(c),columns:w,pagination:C(b({},l(p)),{size:m}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:l(u),onPageCurrentChange:l(s)},null,8,["loading","size","data","columns","pagination","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"])])}}}),de=W(oe,[["__scopeId","data-v-2d2a2d35"]]);export{de as default};
