import{g as h,u as v,a as x}from"./auth-7YzjxY7J.js";import{p as y}from"./utils-C-gUDCcE.js";import{r as c,o as V,m as b,e as _,f as U,g as C,i as R,j as t,w as p,u as e,k as m}from"./index-2C-ofHV5.js";import{u as k}from"./user-CdZZLQxG.js";import{P as f}from"./index-CaJyLCRQ.js";const S=()=>{const s=c({email:"",mobile:""}),o=[{label:"邮箱",prop:"email",valueType:"input",fieldProps:{placeholder:"请输入邮箱"}},{label:"手机号",prop:"mobile",valueType:"input",fieldProps:{placeholder:"请输入手机号"}}],r={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}]};return V(()=>{h().then(u=>{s.value=y(u.data,["email","mobile"])})}),{profileValues:s,profileColumns:o,profileRules:r,handleProfileUpdate:()=>{v(s.value).then(()=>{b("更新成功",{type:"success"})})}}},q=()=>{const s=c({oldPassword:"",newPassword:""});return{passwordValues:s,passwordColumns:[{label:"旧密码",prop:"oldPassword",valueType:"input",fieldProps:{placeholder:"请输入旧密码"}},{label:"新密码",prop:"newPassword",valueType:"input",fieldProps:{placeholder:"请输入新密码"}}],passwordRules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}]},handlePasswordUpdate:()=>{x(s.value).then(()=>{b("更新成功",{type:"success"}),k().logOut()})}}},T={class:"flex flex-col gap-4"},H=_({name:"Me",__name:"me",setup(s){const{profileColumns:o,profileRules:r,profileValues:l,handleProfileUpdate:u}=S(),{passwordColumns:w,passwordRules:g,passwordValues:n,handlePasswordUpdate:P}=q();return(B,a)=>{const i=U("el-card");return R(),C("div",T,[t(i,{shadow:"never",style:{border:"none"}},{default:p(()=>[t(e(f),{modelValue:e(l),"onUpdate:modelValue":a[0]||(a[0]=d=>m(l)?l.value=d:null),columns:e(o),rules:e(r),"submit-text":"保存","reset-text":"重置","label-width":80,"label-position":"right","label-suffix":"",onSubmit:e(u)},null,8,["modelValue","columns","rules","onSubmit"])]),_:1}),t(i,{shadow:"never",style:{border:"none"}},{default:p(()=>[t(e(f),{modelValue:e(n),"onUpdate:modelValue":a[1]||(a[1]=d=>m(n)?n.value=d:null),columns:e(w),rules:e(g),"submit-text":"保存","reset-text":"重置","label-width":80,"label-position":"right","label-suffix":"",onSubmit:e(P)},null,8,["modelValue","columns","rules","onSubmit"])]),_:1})])}}});export{H as default};
