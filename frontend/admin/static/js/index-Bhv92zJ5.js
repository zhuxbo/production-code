var M=Object.defineProperty,j=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var y=(o,e,a)=>e in o?M(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a,_=(o,e)=>{for(var a in e||(e={}))H.call(e,a)&&y(o,a,e[a]);if(P)for(var a of P(e))U.call(e,a)&&y(o,a,e[a]);return o},S=(o,e)=>j(o,q(e));import{r as f,l as O,m as G,t as J,n as K,p as Q,j as u,v as X,e as Z,o as ee,f as v,x as le,g as w,i as k,y as x,u as t,k as te,w as h,z as oe,A as ae,B as ne,C as re,D as z,P as se,_ as ie}from"./index-2C-ofHV5.js";import{b as ce,i as ue,L as de}from"./levels-CDsVv79f.js";import{P as pe}from"./plus-search-B1FvdIYy.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-BHKqx4-E.js";import{p as R}from"./dictionary-DGN_erWP.js";import{C as me}from"./close-bold-Dru7IMTV.js";import"./product-BetgexOv.js";import"./userLevel-CcvbNlzu.js";import"./index-CaJyLCRQ.js";function he(o){const e=f({}),a=f([]),r=f(!0),n=O({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]});function g(c){n.pageSize=c,d()}function l(c){n.currentPage=c,d()}const i=c=>{ce(c).then(()=>{G("删除成功",{type:"success"}),d()})};function d(){r.value=!0;const c=S(_({},J(e.value)),{pageSize:n.pageSize,currentPage:n.currentPage});ue(c).then(({data:m})=>{a.value=m.items,n.total=m.total,n.pageSize=m.pageSize,n.currentPage=m.currentPage,K(()=>{o.value&&o.value.getTableRef().clearSelection()})}).finally(()=>{r.value=!1})}return{loading:r,search:e,dataList:a,pagination:n,handleSizeChange:g,handleCurrentChange:l,onSearch:d,handleBatchDestroy:i}}const fe=o=>{const e=Q(()=>{o()},500);return{searchColumns:[{label:"产品",prop:"product_id",valueType:"select",fieldProps:{clearable:!0},renderField:(r,n)=>u(F,{modelValue:r,uri:"/product",searchField:"quickSearch",labelField:"name",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择产品",onChange:n},null)},{label:"级别",prop:"level_code",valueType:"select",fieldProps:{clearable:!0},renderField:(r,n)=>u(F,{modelValue:r,uri:"/user-level",searchField:"quickSearch",labelField:"name",valueField:"code",itemsField:"items",totalField:"total",placeholder:"请选择级别",onChange:n},null)},{label:"周期",prop:"period",valueType:"select",fieldProps:{clearable:!0,placeholder:"请选择周期"},options:R}],debouncedSearch:e}},ge=()=>{const o=f(),e=f([]);return{tableRef:o,selectedIds:e,handleSelectionChange:l=>{e.value=l.map(i=>i.id),o.value.setAdaptive()},handleSelectionCancel:()=>{var l;(l=o.value)==null||l.getTableRef().clearSelection()},tableColumns:[{label:"勾选列",type:"selection",reserveSelection:!0},{label:"ID",prop:"id",minWidth:80},{label:"产品",prop:"product.name",minWidth:100},{label:"级别",prop:"level.name",minWidth:100},{label:"周期",prop:"period",minWidth:80,formatter:({period:l})=>{var i;return(i=R.find(d=>d.value===l))==null?void 0:i.label}},{label:"价格",prop:"price",minWidth:100,formatter:({price:l})=>`¥${l}`},{label:"附加标准域名价格",prop:"alternative_standard_price",minWidth:120,formatter:({alternative_standard_price:l})=>l?`¥${l}`:"-"},{label:"附加通配符价格",prop:"alternative_wildcard_price",minWidth:120,formatter:({alternative_wildcard_price:l})=>l?`¥${l}`:"-"},{label:"创建时间",prop:"created_at",width:180,formatter:({created_at:l})=>l?X(l).format("YYYY-MM-DD HH:mm:ss"):"-"}],handleRowClick:l=>{var i;(i=o.value)==null||i.getTableRef().toggleRowSelection(l)}}},be={class:"main"},ve={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[12px] overflow-auto"},Ce={key:0,class:"bg-[var(--el-fill-color-light)] w-full h-[46px] mb-2 pl-3 pr-2 flex items-center"},_e={class:"flex-auto"},Se={style:{"font-size":"var(--el-font-size-base)"},class:"text-[rgba(42,46,54,0.5)] dark:text-[rgba(220,220,242,0.5)] ml-2"},xe=Z({name:"ProductPrice",__name:"index",setup(o){const e=f(!1),{tableRef:a,selectedIds:r,tableColumns:n,handleSelectionChange:g,handleSelectionCancel:l,handleRowClick:i}=ge(),{loading:d,search:c,dataList:m,pagination:V,handleSizeChange:B,handleCurrentChange:D,onSearch:b,handleBatchDestroy:T}=he(a),{searchColumns:W,debouncedSearch:$}=fe(()=>b());ee(()=>{b()});function A(){a.value.setAdaptive()}return(Pe,s)=>{const C=v("el-button"),E=v("el-tooltip"),I=v("el-popconfirm"),L=v("pure-table"),N=le("motion-fade");return k(),w("div",be,[u(de,{modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=p=>e.value=p),onSaved:t(b)},null,8,["modelValue","onSaved"]),x("div",ve,[u(t(pe),{modelValue:t(c),"onUpdate:modelValue":s[1]||(s[1]=p=>te(c)?c.value=p:null),columns:t(W),"show-number":3,"row-props":{gutter:12},"col-props":{xs:24,sm:12,md:8,lg:6,xl:4},"label-width":"80","label-position":"right","label-suffix":"","has-footer":!1,onChange:t($)},null,8,["modelValue","columns","onChange"])]),u(t(se),{title:"产品价格",columns:t(n),onRefresh:t(b),onFullscreen:A},{buttons:h(()=>[u(C,{type:"primary",onClick:s[2]||(s[2]=p=>e.value=!0)},{default:h(()=>[...s[4]||(s[4]=[z(" 设置价格 ",-1)])]),_:1})]),default:h(({size:p,dynamicColumns:Y})=>[t(r).length>0?oe((k(),w("div",Ce,[x("div",_e,[u(E,{placement:"top",content:"取消选择"},{default:h(()=>[u(C,{type:"primary",size:"small",class:"!w-[15px] !p-0 !h-[15px] !rounded-[3px]",icon:t(ne)(t(me)),onClick:t(l)},null,8,["icon","onClick"])]),_:1}),x("span",Se," 已选 "+re(t(r).length)+" 项 ",1)]),u(I,{title:"确定要删除吗？",width:"160px",onConfirm:s[3]||(s[3]=ye=>t(T)(t(r)))},{reference:h(()=>[u(C,{type:"danger",size:"small"},{default:h(()=>[...s[5]||(s[5]=[z(" 批量删除 ",-1)])]),_:1})]),_:1})])),[[N]]):ae("",!0),u(L,{ref_key:"tableRef",ref:a,"row-key":"id","align-whole":"left","table-layout":"auto",loading:t(d),size:p,adaptive:"",adaptiveConfig:{offsetBottom:108},data:t(m),columns:Y,pagination:S(_({},t(V)),{size:p}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onRowClick:t(i),onSelectionChange:t(g),onPageSizeChange:t(B),onPageCurrentChange:t(D)},null,8,["loading","size","data","columns","pagination","onRowClick","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"])])}}}),$e=ie(xe,[["__scopeId","data-v-4d2a1993"]]);export{$e as default};
