var $=(g,y,i)=>new Promise((m,o)=>{var u=a=>{try{f(i.next(a))}catch(l){o(l)}},v=a=>{try{f(i.throw(a))}catch(l){o(l)}},f=a=>a.done?m(a.value):Promise.resolve(a.value).then(u,v);f((i=i.apply(g,y)).next())});import{u as N,P as S,i as G,_ as O}from"./index-CaJyLCRQ.js";import{e as U,r as w,q,F as b,G as A,i as J,aV as P,w as t,at as p,y as M,aD as C,aE as F,j as k,u as d,aL as B,D as E,C as I,aG as D,I as Q,J as R,Q as _}from"./index-2C-ofHV5.js";const x={class:"plus-drawer-form__footer"};var H=U({name:"PlusDrawerForm",__name:"index",props:{modelValue:{default:()=>({})},visible:{type:Boolean,default:!1},drawer:{default:()=>({})},size:{default:"540px"},form:{default:()=>({})},hasFooter:{type:Boolean,default:!0},cancelText:{default:""},confirmText:{default:""},confirmLoading:{type:Boolean,default:!1},hasErrorTip:{type:Boolean,default:!0}},emits:["update:modelValue","update:visible","confirm","change","cancel","confirmError"],setup(g,{expose:y,emit:i}){const m=g,o=i,{t:u}=N(),v=w(null),f=q(()=>{var e;return(e=v.value)==null?void 0:e.formInstance}),a=w(),l=w({}),c=w(!1);b(()=>m.visible,e=>{c.value=e},{immediate:!0}),b(()=>m.modelValue,e=>{l.value=e},{immediate:!0});const z=(e,r)=>{o("update:modelValue",e),o("change",e,r)},T=()=>$(null,null,function*(){var e,r,s;try{(yield(e=f.value)==null?void 0:e.validate())&&o("confirm",l.value)}catch(n){if(m.hasErrorTip){_.closeAll();const h=G(n)&&Object.values(n),j=h?(s=(r=h[0])==null?void 0:r[0])==null?void 0:s.message:void 0;_.warning(j||u("plus.form.errorTip"))}o("confirmError",n)}}),L=()=>{V(),o("update:visible",c.value),o("cancel")},V=()=>{c.value=!1};return y({drawerInstance:a,formInstance:f}),(e,r)=>(J(),A(d(R),D({ref_key:"drawerInstance",ref:a,modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=s=>c.value=s),class:"plus-drawer-form",size:e.size||"540px",title:d(u)("plus.drawerForm.title"),"close-on-click-modal":!1,"close-on-press-escape":!1},e.$attrs,{onClose:L}),P({default:t(()=>[k(d(S),D({ref_key:"formInstance",ref:v,modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=s=>l.value=s),"has-footer":!1},e.form,{onChange:z}),P({_:2},[e.$slots["form-footer"]?{name:"footer",fn:t(()=>[p(e.$slots,"form-footer")]),key:"0"}:void 0,e.$slots["form-group-header"]?{name:"group-header",fn:t(s=>[p(e.$slots,"form-group-header",C(F(s)))]),key:"1"}:void 0,Q(e.$slots,(s,n)=>({name:n,fn:t(h=>[p(e.$slots,n,C(F(h)))])}))]),1040,["modelValue"])]),_:2},[e.$slots["drawer-header"]?{name:"header",fn:t(()=>[p(e.$slots,"drawer-header")]),key:"0"}:void 0,e.hasFooter?{name:"footer",fn:t(()=>[M("div",x,[p(e.$slots,"drawer-footer",C(F({handleConfirm:T,handleCancel:V})),()=>[k(d(B),{onClick:V},{default:t(()=>[E(I(e.cancelText||d(u)("plus.drawerForm.cancelText")),1)]),_:1}),k(d(B),{type:"primary",loading:e.confirmLoading,onClick:T},{default:t(()=>[E(I(e.confirmText||d(u)("plus.drawerForm.confirmText")),1)]),_:1},8,["loading"])])])]),key:"1"}:void 0]),1040,["modelValue","size","title"]))}}),K=O(H,[["__file","index.vue"]]);const Z=K;export{Z as P};
