var Me=Object.defineProperty,Ee=Object.defineProperties;var Oe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var He=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var re=(D,s,d)=>s in D?Me(D,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):D[s]=d,ie=(D,s)=>{for(var d in s||(s={}))He.call(s,d)&&re(D,d,s[d]);if(ae)for(var d of ae(s))Pe.call(s,d)&&re(D,d,s[d]);return D},de=(D,s)=>Ee(D,Oe(s));var vt=(D,s,d)=>new Promise((u,r)=>{var l=_=>{try{z(d.next(_))}catch(C){r(C)}},c=_=>{try{z(d.throw(_))}catch(C){r(C)}},z=_=>_.done?u(_.value):Promise.resolve(_.value).then(l,c);z((d=d.apply(D,s)).next())});import{u as Rt,n as xe,O as ze,o as Bt,c as $t,a as Wt,q as dt,b as jt,t as Ft,v as Ae,p as Le,r as De,w as Ue,d as bt,x as qt,s as Re,e as Be}from"./detail-CR-TgciR.js";import{e as W,T as St,aQ as E,q as J,r as O,f,g as b,i,H as st,j as o,w as n,D as m,C as a,u as t,aR as Nt,G as k,A as p,aK as ht,y as e,m as I,aS as ft,a1 as Kt,aI as Mt,aT as ut,l as ot,aU as We,I as Yt,_ as X,F as kt,p as je,o as pt,aV as ee,aW as Fe,aX as Ve,aY as qe,aZ as Te,Y as Ne,a_ as he,a$ as Et,v as q,aL as Zt,b0 as it,b1 as Ie,aA as Gt,b2 as Ke,af as Ze,b3 as It}from"./index-2C-ofHV5.js";import{f as Ot,e as Ht,a as Pt,c as At,d as Ge,b as Je}from"./dictionary-DwGUqBwq.js";import{_ as Jt}from"./index.vue_vue_type_script_setup_true_lang-BHKqx4-E.js";import{a as ue}from"./psl-D8AmD7_c.js";import{v as te,a as Xt}from"./dictionary-DGN_erWP.js";import{i as Ye}from"./cert-B1S-qIHA.js";import"./product-BetgexOv.js";import"./isIP-DL0XLegh.js";import"./dialog-DFvFShc1.js";const Xe={class:"dialog-footer"},Qe={class:"dialog-footer"},tl=W({__name:"operate",setup(D){var w;const{toDetail:s}=Rt(),d=St(),u=d.path,r=d.params,l=E("order"),c=E("cert"),z=E("sync"),_=E("get"),C=J(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),{action:y,openAction:g}=xe(),$=H=>{if(H)switch(H){case"send":M.value=!0;break;case"transfer":tt.value=!0;break;case"commit":Q();break;case"sync":z(!0);break;case"commitCancel":Y();break;case"revokeCancel":N();break;case"renew":g("renew",l.id);break;case"reissue":g("reissue",l.id);break}},T=O((w=l==null?void 0:l.user)==null?void 0:w.email),M=O(!1),Z=()=>{Bt(l.id,T.value).then(()=>{M.value=!1,I("发送成功",{type:"success"})})},Q=()=>{$t(l.id).then(()=>{I("提交成功",{type:"success"}),_()})},Y=()=>{ft.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let H=r.ids.toString().split(",");H.length>1?(H=H.filter(v=>v!==l.id.toString()),s({ids:H.join(",")},"params")):Mt.push({name:"Order"})}else dt(l.id).then(H=>{H.data.sync=ut(),Object.assign(l,ot(H.data))})})})},N=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),dt(l.id).then(H=>{H.data.sync=ut(),Object.assign(l,ot(H.data))})})},rt=O(""),tt=O(!1),A=()=>{if(!rt.value){I("请选择用户",{type:"error"});return}Ft({order_id:l.id,user_id:rt.value}).then(()=>{I("过户成功",{type:"success"}),_(),tt.value=!1})};return(H,v)=>{const G=f("el-icon"),V=f("el-button"),x=f("el-dropdown-item"),R=f("el-dropdown-menu"),F=f("el-dropdown"),j=f("el-input"),S=f("el-form-item"),h=f("el-dialog");return i(),b(st,null,[o(F,{style:{"margin-top":"7px"},onCommand:$},{dropdown:n(()=>[o(R,null,{default:n(()=>[t(c).status=="active"?(i(),k(x,{key:0,command:"send"},{default:n(()=>[...v[12]||(v[12]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(x,{key:1,command:"transfer"},{default:n(()=>[...v[13]||(v[13]=[m(a("过户"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(i(),k(x,{key:2,command:"commit"},{default:n(()=>[...v[14]||(v[14]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(i(),k(x,{key:3,command:"sync"},{default:n(()=>[...v[15]||(v[15]=[m(a("同步"),-1)])]),_:1})):p("",!0),C.value?(i(),k(x,{key:4,command:"commitCancel",divided:""},{default:n(()=>[...v[16]||(v[16]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(i(),k(x,{key:5,command:"revokeCancel"},{default:n(()=>[...v[17]||(v[17]=[m(a("撤回"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(x,{key:6,command:"renew",divided:""},{default:n(()=>[...v[18]||(v[18]=[m(a("续费"),-1)])]),_:1})):p("",!0),["active","expired"].includes(t(c).status)?(i(),k(x,{key:7,command:"reissue",divided:""},{default:n(()=>[...v[19]||(v[19]=[m(a("重签"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(V,{type:"primary",size:"small"},{default:n(()=>[v[11]||(v[11]=m(a("操作")+" ",-1)),o(G,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(V,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:v[0]||(v[0]=P=>t(_)(!0))},{default:n(()=>[o(G,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(ht))]),_:1})]),_:1}),o(h,{modelValue:M.value,"onUpdate:modelValue":v[4]||(v[4]=P=>M.value=P),title:"发送邮件",width:"400px"},{footer:n(()=>[e("span",Xe,[o(V,{onClick:v[2]||(v[2]=P=>M.value=!1)},{default:n(()=>[...v[20]||(v[20]=[m(a("取消"),-1)])]),_:1}),o(V,{type:"primary",onClick:v[3]||(v[3]=P=>Z())},{default:n(()=>[...v[21]||(v[21]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(S,{label:"邮箱","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(j,{modelValue:T.value,"onUpdate:modelValue":v[1]||(v[1]=P=>T.value=P),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:tt.value,"onUpdate:modelValue":v[8]||(v[8]=P=>tt.value=P),title:"过户证书",width:"400px"},{footer:n(()=>[e("span",Qe,[o(V,{onClick:v[6]||(v[6]=P=>tt.value=!1)},{default:n(()=>[...v[22]||(v[22]=[m(a("取消"),-1)])]),_:1}),o(V,{type:"primary",onClick:v[7]||(v[7]=P=>A())},{default:n(()=>[...v[23]||(v[23]=[m(a("确定"),-1)])]),_:1})])]),default:n(()=>[o(S,{label:"新用户","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(t(Jt),{modelValue:rt.value,"onUpdate:modelValue":v[5]||(v[5]=P=>rt.value=P),uri:"/user",searchField:"quickSearch",labelField:"username",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择要过户到的用户",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(ze,{visible:t(y).visible,"onUpdate:visible":v[9]||(v[9]=P=>t(y).visible=P),actionType:t(y).type,orderId:t(y).id,onSuccess:v[10]||(v[10]=P=>t(_)(!0))},null,8,["visible","actionType","orderId"])],64)}}}),gt=W({__name:"copy",props:["copied"],setup(D){const s=D,d=()=>{navigator.clipboard.writeText(s.copied).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return(u,r)=>{const l=f("el-icon");return i(),k(l,{color:"var(--el-text-color-secondary)",style:{cursor:"pointer"},onClick:d},{default:n(()=>[o(t(We))]),_:1})}}}),el=W({__name:"validationMethods",props:{modelValue:{type:String},methods:{type:Array}},emits:["update:modelValue"],setup(D,{emit:s}){const d=D,u=J(()=>!d.methods||d.methods.length===0?[]:[...d.methods].sort((c,z)=>Object.keys(te).indexOf(c)-Object.keys(te).indexOf(z))),r=s,l=J({get(){var c;return(c=d.modelValue)!=null?c:""},set(c){r("update:modelValue",c)}});return(c,z)=>{const _=f("el-option"),C=f("el-select");return i(),k(C,{modelValue:l.value,"onUpdate:modelValue":z[0]||(z[0]=y=>l.value=y),placeholder:"请选择验证方法",class:"select"},{default:n(()=>[(i(!0),b(st,null,Yt(u.value,y=>(i(),k(_,{key:y,label:t(te)[y],value:y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])}}}),ll=X(el,[["__scopeId","data-v-c9b6828f"]]),sl={key:0,class:"descriptions"},nl={style:{"margin-top":"18px"}},ol={key:0,style:{width:"100%"}},al={key:0,style:{padding:"0"}},rl={key:1,class:"descriptions"},il={style:{"margin-top":"18px"}},dl={class:"descriptions"},ul={style:{margin:"10px 0"}},cl={class:"descriptions"},pl={style:{width:"100%"}},ml={key:0,class:"index"},_l={key:0},vl={style:{"text-align":"right"}},fl={key:0,class:"check-result-dialog"},yl={key:0},bl={style:{"max-height":"200px","overflow-y":"auto","word-break":"break-all"}},gl={style:{color:"var(--el-color-danger)"}},kl=W({__name:"validation",setup(D){var H,v,G;const s=E("get"),d=E("order"),u=E("cert"),r=J(()=>{var x;let V=!1;return(x=u.value)!=null&&x.validation&&u.value.validation.forEach(R=>{var F,j;R.host&&R.host!==((j=(F=u.value.dcv)==null?void 0:F.dns)==null?void 0:j.host)&&(V=!0)}),V}),l=J(()=>{let V=!0;return u.value.validation&&u.value.validation.forEach(x=>{x.verified!=1&&(V=!1)}),V}),c=O((H=u.value.dcv)==null?void 0:H.method);kt(()=>u.value,V=>{var x;V&&(c.value=(x=V.dcv)==null?void 0:x.method)});const z=O(!1),_=St(),C=!!Number((G=(v=_.query.issue_verify)!=null?v:_.query.verify)!=null?G:_.query.pay!==void 0?0:1),y=()=>{Le(d.id,{commit:!0,issue_verify:C}).then(V=>{I(V.msg?V.msg:"支付成功",{type:"success"}),s()})},g=()=>{$t(d.id).then(V=>{I(V.msg?V.msg:"提交成功",{type:"success"}),s()})},$=()=>{z.value||(z.value=!0,De(d.id).then(V=>{I(V.msg?V.msg:"开始验证，请等待几分钟后刷新页面查看结果",{type:"success"})}).finally(()=>{z.value=!1}))},T=V=>{z.value||(z.value=!0,Ue(d.id,V).then(x=>{I(x.msg?x.msg:"修改成功",{type:"success"}),s()}).finally(()=>{z.value=!1}))},M=()=>{const V=[];r.value?u.value.validation.forEach(R=>{(R.method==="cname"||R.method==="txt")&&V.push(`域名：${R.domain}
主机记录：${R.host}
解析类型：${u.value.dcv.dns.type}
记录值：${u.value.dcv.dns.value}`)}):V.push(`域名：${u.value.validation[0].domain}
主机记录：${u.value.dcv.dns.host}
解析类型：${u.value.dcv.dns.type}
记录值：${u.value.dcv.dns.value}`);const x=V.join(`

`);navigator.clipboard.writeText(x).then(()=>{I("解析记录已复制到剪贴板",{type:"success"})})};function Z(V,x){return vt(this,null,function*(){var P,Lt;if(!(V!=null&&V.length))return V;const R=V.map(et=>{var at,yt,nt,mt,_t,ct,wt,Ct,xt,zt,Dt;const lt={domain:et.domain,method:(at=et.method)==null?void 0:at.toLowerCase()};if(["txt","cname"].includes(lt.method))lt.host=et.host||((nt=(yt=u.value.dcv)==null?void 0:yt.dns)==null?void 0:nt.host)||"@",lt.value=et.value||((_t=(mt=u.value.dcv)==null?void 0:mt.dns)==null?void 0:_t.value);else if(["file","http","https"].includes(lt.method)){const Ut=lt.method==="file"?"":lt.method+":";lt.link=et.link||`${Ut}//${et.domain}/.well-known/pki-validation/${(wt=(ct=u.value.dcv)==null?void 0:ct.file)==null?void 0:wt.name}`,lt.name=et.name||((xt=(Ct=u.value.dcv)==null?void 0:Ct.file)==null?void 0:xt.name),lt.content=et.content||((Dt=(zt=u.value.dcv)==null?void 0:zt.file)==null?void 0:Dt.content)}return lt}),j=(((P=Ne())==null?void 0:P.DnsTools)||["https://dns-tools-cn.cnssl.com","https://dns-tools-us.cnssl.com"]).map(et=>`${et}/api/dcv/verify`);let S,h;for(const et of j)try{if(S=yield he.post(et,R,{timeout:1e4}),S.data!==void 0)break}catch(lt){h=lt,console.debug(`Failed to connect to ${et}, trying next...`);continue}if(S!=null&&S.data){const et=((Lt=S.data.data)==null?void 0:Lt.results)||{},lt=S.data.errors||[];return lt.length>0&&lt.forEach(at=>{at.domain&&(et[at.domain]=at)}),V.map(at=>{var mt,_t;const yt=at.domain,nt=et[yt];if(nt){const ct=de(ie({},at),{checked:nt.matched==="true",error:nt.matched==="false"?"验证失败":""});return["txt","cname"].includes((mt=at.method)==null?void 0:mt.toLowerCase())?(ct.detected_value=nt.value||"",ct.query=nt.query||"",ct.query_sub=nt.query_sub||"",ct.value_sub=nt.value_sub||""):["file","http","https"].includes((_t=at.method)==null?void 0:_t.toLowerCase())&&(ct.detected_value=nt.content||"",ct.link=nt.link||nt.link_https||nt.link_http||at.link),ct}return at})}return h&&console.error("All DCV verify endpoints failed:",h),V})}const Q=O(!1),Y=O(null),N=O(!1);function rt(V){return vt(this,null,function*(){Y.value=V,Q.value=!0,V.checked||(yield A())})}function tt(){return vt(this,null,function*(){if(Y.value){N.value=!0;try{const V=yield Z([Y.value],d.product.ca);if(V!=null&&V[0]){const x=V[0];x.checked&&(x.error="",x.detected_value=x.detected_value||"",x.errors=void 0);const R=u.value.validation.findIndex(F=>F.domain===Y.value.domain&&F.method===Y.value.method);R!==-1&&(u.value.validation[R]=x,Y.value=x)}}finally{N.value=!1}}})}kt(Q,V=>{V||(Y.value=null,N.value=!1)});const A=je(tt,500);function w(){return vt(this,null,function*(){var V,x,R,F,j,S,h;if(!(!((x=(V=u.value)==null?void 0:V.validation)!=null&&x.length)||!["cname","txt","file","http","https"].includes((R=u.value.dcv)==null?void 0:R.method)||l.value||!((j=(F=u.value.dcv)==null?void 0:F.dns)!=null&&j.value)&&!((h=(S=u.value.dcv)==null?void 0:S.file)!=null&&h.content)||!["unpaid","pending","processing"].includes(u.value.status)))try{N.value=!0,u.value.validation=yield Z(u.value.validation,d.product.ca)}catch(P){}finally{N.value=!1}})}return pt(()=>vt(null,null,function*(){yield w()})),(V,x)=>{var lt,at,yt,nt,mt,_t,ct,wt,Ct,xt,zt,Dt,Ut,le,se,ne;const R=f("el-input"),F=f("el-form-item"),j=f("el-button"),S=f("el-icon"),h=f("el-descriptions-item"),P=f("el-tag"),Lt=f("el-descriptions"),et=f("el-dialog");return i(),b(st,null,[["cname","txt"].includes((lt=t(u).dcv)==null?void 0:lt.method)&&((yt=(at=t(u).dcv)==null?void 0:at.dns)!=null&&yt.value)?(i(),b("div",sl,[e("div",nl,[o(F,{label:"主机记录：","label-width":"82px"},{default:n(()=>{var L,K;return[r.value?(i(),b("table",ol,[e("tbody",null,[(i(!0),b(st,null,Yt(t(u).validation,(U,B)=>{var Vt,Tt;return i(),b("tr",{key:B},[["cname","txt"].includes((Vt=U.method)==null?void 0:Vt.toLowerCase())?(i(),b("td",al,[o(R,{"model-value":U.host,spellcheck:"false",style:{width:"100%"}},ee({suffix:n(()=>[o(gt,{copied:U.host},null,8,["copied"])]),_:2},[((Tt=t(u).validation)==null?void 0:Tt.length)>1?{name:"append",fn:n(()=>[m("."+a(t(ue)(U.domain.replace("*.",""))),1)]),key:"0"}:void 0]),1032,["model-value"])])):p("",!0)])}),128))])])):(i(),k(R,{key:1,"model-value":(K=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:K.host,spellcheck:"false"},{suffix:n(()=>{var U,B;return[o(gt,{copied:(B=(U=t(u).dcv)==null?void 0:U.dns)==null?void 0:B.host},null,8,["copied"])]}),_:1},8,["model-value"]))]}),_:1}),o(F,{label:"解析类型：","label-width":"82px"},{default:n(()=>{var L,K;return[o(R,{"model-value":(K=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:K.type.toUpperCase(),disabled:!0,style:{width:"73px"}},null,8,["model-value"])]}),_:1}),o(F,{label:"记录值：","label-width":"82px"},{default:n(()=>{var L,K;return[o(R,{"model-value":(K=(L=t(u).dcv)==null?void 0:L.dns)==null?void 0:K.value,spellcheck:"false"},{suffix:n(()=>{var U,B;return[o(gt,{copied:(B=(U=t(u).dcv)==null?void 0:U.dns)==null?void 0:B.value},null,8,["copied"])]}),_:1},8,["model-value"])]}),_:1})])])):p("",!0),["file","http","https"].includes((nt=t(u).dcv)==null?void 0:nt.method)&&((_t=(mt=t(u).dcv)==null?void 0:mt.file)!=null&&_t.content)?(i(),b("div",rl,[e("div",il,[o(F,{label:"文件名：","label-width":"82px"},{default:n(()=>{var L,K;return[o(R,{"model-value":(K=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:K.name,spellcheck:"false"},{suffix:n(()=>{var U,B;return[o(gt,{copied:(B=(U=t(u).dcv)==null?void 0:U.file)==null?void 0:B.name},null,8,["copied"])]}),_:1},8,["model-value"])]}),_:1}),o(F,{label:"文件内容：","label-width":"82px"},{default:n(()=>{var L,K,U,B;return[o(R,{rows:3,type:"textarea",class:"file-content","model-value":(K=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:K.content,spellcheck:"false"},null,8,["model-value"]),o(gt,{copied:(B=(U=t(u).dcv)==null?void 0:U.file)==null?void 0:B.content,style:{position:"absolute",right:"12px",bottom:"7px"}},null,8,["copied"])]}),_:1}),o(F,{label:"路径：","label-width":"82px"},{default:n(()=>{var L,K;return[o(R,{"model-value":(K=(L=t(u).dcv)==null?void 0:L.file)==null?void 0:K.path,spellcheck:"false"},{suffix:n(()=>{var U,B;return[o(gt,{copied:(B=(U=t(u).dcv)==null?void 0:U.file)==null?void 0:B.path},null,8,["copied"])]}),prepend:n(()=>[o(j,{type:"primary",onClick:x[0]||(x[0]=U=>Ae(t(d).id))},{default:n(()=>[...x[7]||(x[7]=[m("下 载",-1)])]),_:1})]),_:1},8,["model-value"])]}),_:1})])])):p("",!0),e("div",dl,[e("div",ul,[o(ll,{modelValue:c.value,"onUpdate:modelValue":x[1]||(x[1]=L=>c.value=L),methods:t(d).product.validation_methods},null,8,["modelValue","methods"]),o(j,{disable:!["unpaid","pending","processing"].includes(t(u).status)||l.value,style:{"border-left":"0","border-top-left-radius":"0","border-bottom-left-radius":"0"},onClick:x[2]||(x[2]=L=>T(c.value))},{default:n(()=>[...x[8]||(x[8]=[m("修改",-1)])]),_:1},8,["disable"]),["processing"].includes(t(u).status)&&!["admin","administrator","postmaster","hostmaster","webmaster"].includes(t(u).dcv.method)?(i(),k(j,{key:0,disable:l.value,type:"primary",style:{"margin-left":"16px"},onClick:x[3]||(x[3]=L=>$())},{default:n(()=>[...x[9]||(x[9]=[m("验证",-1)])]),_:1},8,["disable"])):p("",!0),["cname","txt"].includes((ct=t(u).dcv)==null?void 0:ct.method)&&((Ct=(wt=t(u).dcv)==null?void 0:wt.dns)!=null&&Ct.value)&&["unpaid","pending","processing"].includes(t(u).status)&&!l.value?(i(),k(j,{key:1,type:"primary",style:{"margin-left":"16px"},onClick:x[4]||(x[4]=L=>M())},{default:n(()=>[...x[10]||(x[10]=[m("复制解析",-1)])]),_:1})):p("",!0),((xt=t(u).validation)==null?void 0:xt.length)>1&&["cname","txt","file","http","https"].includes((zt=t(u).dcv)==null?void 0:zt.method)&&!l.value&&((Ut=(Dt=t(u).dcv)==null?void 0:Dt.dns)!=null&&Ut.value||(se=(le=t(u).dcv)==null?void 0:le.file)!=null&&se.content)&&["unpaid","pending","processing"].includes(t(u).status)?(i(),k(j,{key:2,disabled:N.value,type:"primary",loading:N.value,onClick:w},{default:n(()=>[...x[11]||(x[11]=[m(" 检测所有 ",-1)])]),_:1},8,["disabled","loading"])):p("",!0),["unpaid"].includes(t(u).status)?(i(),k(j,{key:3,type:"warning",onClick:y},{default:n(()=>[...x[12]||(x[12]=[m(" 支付 ",-1)])]),_:1})):p("",!0),["pending"].includes(t(u).status)?(i(),k(j,{key:4,type:"warning",onClick:g},{default:n(()=>[...x[13]||(x[13]=[m(" 提交 ",-1)])]),_:1})):p("",!0)])]),e("div",cl,[e("table",pl,[e("tbody",null,[e("tr",null,[((ne=t(u).validation)==null?void 0:ne.length)>1?(i(),b("td",ml,"序号")):p("",!0),x[14]||(x[14]=e("td",{class:"domain"},"域名",-1)),x[15]||(x[15]=e("td",{style:{"text-align":"right"}},"状态",-1))]),(i(!0),b(st,null,Yt(t(u).validation,(L,K)=>{var U,B,Vt,Tt,oe;return i(),b("tr",{key:K},[((U=t(u).validation)==null?void 0:U.length)>1?(i(),b("td",_l,a(K+1),1)):p("",!0),e("td",null,[m(a(L.domain)+" ",1),!["admin","administrator","postmaster","hostmaster","webmaster"].includes(L.method)&&["unpaid","pending","processing"].includes(t(u).status)&&((Vt=(B=t(u).dcv)==null?void 0:B.dns)!=null&&Vt.value||(oe=(Tt=t(u).dcv)==null?void 0:Tt.file)!=null&&oe.content)?(i(),k(j,{key:0,link:"",onClick:si=>rt(L)},{default:n(()=>[L.checked?(i(),k(S,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Fe))]),_:1})):(i(),k(j,{key:1,type:"primary",link:""},{default:n(()=>[...x[16]||(x[16]=[m("检测",-1)])]),_:1}))]),_:2},1032,["onClick"])):p("",!0)]),e("td",vl,[L.verified==1||["active","approving"].includes(t(u).status)?(i(),k(S,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Ve))]),_:1})):["unpaid","pending","processing"].includes(t(u).status)?(i(),b(st,{key:1},[L.verified==2?(i(),k(S,{key:0,color:"var(--el-color-warning)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(qe))]),_:1})):p("",!0),L.verified!=2?(i(),k(S,{key:1,class:"is-loading",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Te))]),_:1})):p("",!0)],64)):p("",!0)])])}),128))])])]),o(et,{modelValue:Q.value,"onUpdate:modelValue":x[6]||(x[6]=L=>Q.value=L),title:"验证检测结果",class:"validation-check-dialog"},{footer:n(()=>[o(j,{onClick:x[5]||(x[5]=L=>Q.value=!1)},{default:n(()=>[...x[17]||(x[17]=[m("关闭",-1)])]),_:1}),o(j,{type:"primary",loading:N.value,onClick:t(A)},{default:n(()=>[...x[18]||(x[18]=[m("重新检测",-1)])]),_:1},8,["loading","onClick"])]),default:n(()=>[Y.value?(i(),b("div",fl,[o(Lt,{column:1,border:""},{default:n(()=>{var L,K;return[o(h,{label:"域名","label-align":"right"},{default:n(()=>[m(a(Y.value.domain),1)]),_:1}),o(h,{label:"验证方式","label-align":"right"},{default:n(()=>[m(a(Y.value.method),1)]),_:1}),["cname","txt"].includes((L=Y.value.method)==null?void 0:L.toLowerCase())?(i(),b(st,{key:0},[o(h,{label:"验证记录","label-align":"right"},{default:n(()=>{var U,B;return[m(a(Y.value.query||(Y.value.host||((B=(U=t(u).dcv)==null?void 0:U.dns)==null?void 0:B.host))+"."+t(ue)(Y.value.domain.replace("*.",""))),1)]}),_:1}),o(h,{label:"需要的值","label-align":"right"},{default:n(()=>{var U,B;return[m(a(Y.value.value||((B=(U=t(u).dcv)==null?void 0:U.dns)==null?void 0:B.value)),1)]}),_:1}),Y.value.detected_value?(i(),k(h,{key:0,label:"检测到的值","label-align":"right"},{default:n(()=>[m(a(Y.value.detected_value),1)]),_:1})):p("",!0),Y.value.query_sub?(i(),k(h,{key:1,label:"子域查询","label-align":"right"},{default:n(()=>[m(a(Y.value.query_sub)+" ",1),Y.value.value_sub?(i(),b("span",yl," → "+a(Y.value.value_sub),1)):p("",!0)]),_:1})):p("",!0)],64)):p("",!0),["file","http","https"].includes((K=Y.value.method)==null?void 0:K.toLowerCase())?(i(),b(st,{key:1},[o(h,{label:"验证链接","label-align":"right"},{default:n(()=>{var U,B;return[m(a(Y.value.link||`${Y.value.method==="file"?"https:":Y.value.method+":"}//${Y.value.domain}/.well-known/pki-validation/${(B=(U=t(u).dcv)==null?void 0:U.file)==null?void 0:B.name}`),1)]}),_:1}),o(h,{label:"需要的内容","label-align":"right"},{default:n(()=>{var U,B;return[m(a(Y.value.content||((B=(U=t(u).dcv)==null?void 0:U.file)==null?void 0:B.content)),1)]}),_:1}),Y.value.detected_value?(i(),k(h,{key:0,label:"检测到的内容","label-align":"right"},{default:n(()=>[e("div",bl,a(Y.value.detected_value),1)]),_:1})):p("",!0)],64)):p("",!0),o(h,{label:"检测状态","label-align":"right"},{default:n(()=>[o(P,{type:Y.value.checked?"success":"danger"},{default:n(()=>[m(a(Y.value.checked?"验证通过":"验证失败"),1)]),_:1},8,["type"])]),_:1}),Y.value.error?(i(),k(h,{key:2,label:"错误信息","label-align":"right"},{default:n(()=>[e("div",gl,a(Y.value.error),1)]),_:1})):p("",!0)]}),_:1})])):p("",!0)]),_:1},8,["modelValue"])],64)}}}),$l=X(kl,[["__scopeId","data-v-77c0eb54"]]),wl={class:"descriptions"},Cl={style:{float:"right"}},xl={style:{float:"right"}},zl=W({__name:"install",setup(D){const s=E("order"),d=E("cert"),u=O(""),r=l=>{navigator.clipboard.writeText(l).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return Et(()=>{d.value.private_key=d.value.private_key||"",d.value.cert=d.value.cert||"",d.value.intermediate_cert=d.value.intermediate_cert||""}),(l,c)=>{const z=f("el-button"),_=f("el-text"),C=f("el-input"),y=f("el-col"),g=f("el-row"),$=f("el-dialog");return i(),b("div",null,[e("table",wl,[o(_,{style:{margin:"10px 20px"}},{default:n(()=>[o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[0]||(c[0]=T=>u.value="bt")},{default:n(()=>[...c[11]||(c[11]=[m("宝塔面板",-1)])]),_:1},8,["disabled"]),o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[1]||(c[1]=T=>bt(t(s).id,"nginx"))},{default:n(()=>[...c[12]||(c[12]=[m("Nginx",-1)])]),_:1},8,["disabled"]),o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[2]||(c[2]=T=>bt(t(s).id,"apache"))},{default:n(()=>[...c[13]||(c[13]=[m("Apache",-1)])]),_:1},8,["disabled"]),t(d).private_key?(i(),k(z,{key:0,type:"primary",link:"",disabled:t(d).status!="active",onClick:c[3]||(c[3]=T=>bt(t(s).id,"iis"))},{default:n(()=>[...c[14]||(c[14]=[m(" IIS ",-1)])]),_:1},8,["disabled"])):p("",!0),t(d).private_key?(i(),k(z,{key:1,type:"primary",link:"",disabled:t(d).status!="active",onClick:c[4]||(c[4]=T=>bt(t(s).id,"tomcat"))},{default:n(()=>[...c[15]||(c[15]=[m(" Tomcat ",-1)])]),_:1},8,["disabled"])):p("",!0),o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[5]||(c[5]=T=>bt(t(s).id,"pem"))},{default:n(()=>[...c[16]||(c[16]=[m("Pem",-1)])]),_:1},8,["disabled"]),o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[6]||(c[6]=T=>bt(t(s).id,"txt"))},{default:n(()=>[...c[17]||(c[17]=[m("Txt",-1)])]),_:1},8,["disabled"]),o(z,{type:"primary",link:"",disabled:t(d).status!="active",onClick:c[7]||(c[7]=T=>bt(t(s).id))},{default:n(()=>[...c[18]||(c[18]=[m("全部",-1)])]),_:1},8,["disabled"])]),_:1})]),o($,{"model-value":u.value=="bt","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:c[10]||(c[10]=T=>u.value="")},ee({default:n(()=>[u.value=="bt"?(i(),k(g,{key:0,gutter:20},{default:n(()=>[o(y,{span:12},{default:n(()=>[c[21]||(c[21]=e("span",null,"密钥(KEY)",-1)),e("span",Cl,[o(z,{type:"primary",link:"",size:"small",onClick:c[8]||(c[8]=T=>r(t(d).private_key))},{default:n(()=>[...c[20]||(c[20]=[m("点击复制",-1)])]),_:1})]),o(C,{type:"textarea",rows:20,"model-value":t(d).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(y,{span:12},{default:n(()=>[c[23]||(c[23]=e("span",null,"证书(PEM格式)",-1)),e("span",xl,[o(z,{type:"primary",link:"",size:"small",onClick:c[9]||(c[9]=T=>r((t(d).cert+`
`+t(d).intermediate_cert).trim()))},{default:n(()=>[...c[22]||(c[22]=[m("点击复制",-1)])]),_:1})]),o(C,{type:"textarea",rows:20,"model-value":(t(d).cert+`
`+t(d).intermediate_cert).trim(),spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:2},[u.value=="bt"?{name:"header",fn:n(()=>[c[19]||(c[19]=e("div",{class:"title",style:{"margin-bottom":"0"}},"宝塔面板",-1))]),key:"0"}:void 0]),1032,["model-value"])])}}}),Dl=X(zl,[["__scopeId","data-v-5224f3b8"]]),Vl={class:"documents"},Tl=W({__name:"documents",setup(D){const s=E("cert"),d={APPLICANT:"申请人文档",ORGANIZATION:"企业文档",AUTHORIZATION:"授权文档",ADDITIONAL:"附加文档",VERIFICATION_REPORT:"验证报告",ATTESTATION_LETTER:"证明函"},u={NEW:"待审核",ACCEPTED:"已通过",REJECTED:"已拒绝"},r={NEW:"warning",ACCEPTED:"success",REJECTED:"danger"},l=_=>r[_]||"info",c=J(()=>{var C;const _=(C=s.value)==null?void 0:C.documents;return _?Array.isArray(_)?_:[_]:[]}),z=_=>_?new Date(_).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return(_,C)=>{const y=f("el-table-column"),g=f("el-tag"),$=f("el-table"),T=f("el-empty");return i(),b("div",Vl,[c.value.length>0?(i(),k($,{key:0,data:c.value,size:"small",style:{width:"100%"}},{default:n(()=>[o(y,{prop:"type",label:"类型",width:"140"},{default:n(({row:M})=>[m(a(d[M.type]||M.type),1)]),_:1}),o(y,{prop:"state",label:"状态",width:"80"},{default:n(({row:M})=>[o(g,{type:l(M.state),size:"small"},{default:n(()=>[m(a(u[M.state]||M.state),1)]),_:2},1032,["type"])]),_:1}),o(y,{prop:"createDate",label:"上传时间",width:"160"},{default:n(({row:M})=>[m(a(z(M.createDate)),1)]),_:1}),o(y,{prop:"expireDate",label:"过期时间",width:"160"},{default:n(({row:M})=>[m(a(z(M.expireDate)),1)]),_:1})]),_:1},8,["data"])):(i(),k(T,{key:1,description:"暂无验证文档","image-size":60}))])}}}),Qt=X(Tl,[["__scopeId","data-v-b5164e11"]]),Il={class:"title"},Yl={style:{"margin-left":"15px"}},Sl={class:"descriptions",style:{width:"100%"}},Ml={class:"label"},El={key:0},Ol={class:"label"},Hl={key:1},Pl={class:"content"},Al={class:"label"},Ll={class:"content"},Ul={class:"label"},Rl={class:"content"},Bl=W({__name:"process",setup(D){const s=E("order"),d=E("cert"),u=y=>J(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[y]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),r=u("cert_apply_status"),l=u("org_verify_status"),c=u("domain_verify_status"),z=J(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),_=J(()=>{var $,T;if(!["unpaid","pending","processing","active","expired","approving","cancelling"].includes(($=d.value)==null?void 0:$.status))return!1;if(!((T=s.value)!=null&&T.period_till))return!0;const g=q(s.value.period_till);return g.isValid()&&g.isAfter(q())}),C=O(null);return pt(()=>{if(C.value){const y=C.value.$el,g=window.getComputedStyle(y),$=g.backgroundColor,T=g.borderColor,M=g.color;y.style.setProperty("--original-bg-color",$),y.style.setProperty("--original-border-color",T),y.style.setProperty("--original-text-color",M)}}),(y,g)=>{const $=f("el-icon"),T=f("el-card");return i(),k(T,{shadow:"never",style:{border:"none"}},{default:n(()=>{var M,Z;return[e("h2",Il,[g[0]||(g[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Zt),{ref_key:"statusButton",ref:C,type:t(Ot)[(M=t(d))==null?void 0:M.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var Q;return[m(a(t(Ht)[(Q=t(d))==null?void 0:Q.status]),1)]}),_:1},8,["type"]),e("span",Yl,[_.value?(i(),k(tl,{key:0})):p("",!0)])]),e("table",Sl,[e("tbody",null,[e("tr",null,[e("td",Ml,[o($,{size:16,class:"icon",color:t(r)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[1]||(g[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(i(),b("tr",El,[e("td",Ol,[o($,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[2]||(g[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((Z=t(s).brand)==null?void 0:Z.toLowerCase())==="certum"?(i(),b("tr",Hl,[g[3]||(g[3]=e("td",{class:"label"},null,-1)),e("td",Pl,[o(Qt)])])):p("",!0),e("tr",null,[e("td",Al,[o($,{size:16,class:"icon",color:t(c)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[4]||(g[4]=e("td",{class:"content"},"域名验证",-1))]),e("tr",null,[g[5]||(g[5]=e("td",{class:"label"},null,-1)),e("td",Ll,[o($l)])]),e("tr",null,[e("td",Ul,[o($,{size:16,class:"icon",color:z.value},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[6]||(g[6]=e("td",{class:"content"},"下载证书",-1))]),e("tr",null,[g[7]||(g[7]=e("td",{class:"label"},null,-1)),e("td",Rl,[o(Dl)])])])])]}),_:1})}}}),ce=X(Bl,[["__scopeId","data-v-9085a651"]]),Wl={class:"descriptions"},jl={class:"content"},Fl={class:"content"},ql={class:"content"},Nl={class:"content"},hl={class:"content"},Kl={class:"content"},Zl={class:"content"},Gl={class:"content"},Jl={class:"content"},Xl={key:0},Ql={class:"content"},ts={key:1},es={class:"content"},ls={class:"content"},ss={class:"content"},ns=W({__name:"order",setup(D){const s=E("order"),d=()=>{ft.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{qt(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),dt(s.id).then(r=>{r.data.sync=ut(),Object.assign(s,ot(r.data))})})})};return(u,r)=>{const l=f("el-button"),c=f("el-card");return i(),k(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[r[16]||(r[16]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",Wl,[e("tbody",null,[e("tr",null,[r[0]||(r[0]=e("td",{class:"label"},"用户",-1)),e("td",jl,a(t(s).user.username),1)]),e("tr",null,[r[1]||(r[1]=e("td",{class:"label"},"订单ID",-1)),e("td",Fl,a(t(s).id),1)]),e("tr",null,[r[2]||(r[2]=e("td",{class:"label"},"品牌",-1)),e("td",ql,a(t(s).brand),1)]),e("tr",null,[r[3]||(r[3]=e("td",{class:"label"},"产品",-1)),e("td",Nl,a(t(s).product.name),1)]),e("tr",null,[r[4]||(r[4]=e("td",{class:"label"},"金额",-1)),e("td",hl,a(t(s).amount),1)]),e("tr",null,[r[5]||(r[5]=e("td",{class:"label"},"购买时长",-1)),e("td",Kl,a(t(Xt)[t(s).period]),1)]),e("tr",null,[r[6]||(r[6]=e("td",{class:"label"},"有效期从",-1)),e("td",Zl,a(t(s).period_from?t(q)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):""),1)]),e("tr",null,[r[7]||(r[7]=e("td",{class:"label"},"有效期到",-1)),e("td",Gl,a(t(s).period_till?t(q)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):""),1)]),e("tr",null,[r[8]||(r[8]=e("td",{class:"label"},"已购",-1)),e("td",Jl,a(t(s).purchased_standard_count?t(s).purchased_standard_count+"个标准域名":"")+" "+a(t(s).purchased_standard_count&&t(s).purchased_wildcard_count?"/":"")+" "+a(t(s).purchased_wildcard_count?t(s).purchased_wildcard_count+"个通配符":""),1)]),t(s).organization?(i(),b("tr",Xl,[r[11]||(r[11]=e("td",{class:"label"},"组织",-1)),e("td",Ql,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),r[9]||(r[9]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),r[10]||(r[10]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(i(),b("tr",ts,[r[13]||(r[13]=e("td",{class:"label"},"联系人",-1)),e("td",es,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),r[12]||(r[12]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[r[14]||(r[14]=e("td",{class:"label"},"会员备注",-1)),e("td",ls,a(t(s).remark),1)]),e("tr",null,[r[15]||(r[15]=e("td",{class:"label"},"管理员备注",-1)),e("td",ss,[m(a(t(s).admin_remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).admin_remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),pe=X(ns,[["__scopeId","data-v-e2a90a03"]]),os={class:"descriptions"},as={class:"content"},rs={class:"content"},is={class:"content"},ds={key:0},us={class:"content"},cs={key:0},ps={class:"content"},ms={key:1},_s={class:"content"},vs={key:2},fs={class:"content"},ys={key:3},bs={class:"content"},gs={class:"content"},ks={key:4},$s={class:"content"},ws={key:5},Cs={class:"content"},xs={key:6},zs={class:"content"},Ds={key:7},Vs={class:"content"},Ts={key:8},Is={class:"content"},Ys={key:9},Ss={class:"content"},Ms={key:10},Es={class:"content"},Os={class:"content"},Hs={key:11},Ps={class:"content"},As={key:12},Ls={class:"content"},Us={key:0,class:"title",style:{"margin-bottom":"0"}},Rs={key:1,class:"title",style:{"margin-bottom":"0"}},Bs={style:{float:"right"}},Ws={style:{float:"right"}},js={style:{float:"right"}},Fs={style:{float:"right"}},qs=W({__name:"cert",setup(D){const s=E("cert"),d=O(""),u=r=>{navigator.clipboard.writeText(r).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return Et(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(r,l)=>{const c=f("el-button"),z=f("el-card"),_=f("el-input"),C=f("el-col"),y=f("el-row"),g=f("el-dialog");return i(),b(st,null,[o(z,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[31]||(l[31]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",os,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",as,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"通用名称",-1)),e("td",rs,a(t(s).common_name),1)]),e("tr",null,[l[11]||(l[11]=e("td",{class:"label"},"备用名称",-1)),e("td",is,[t(s).alternative_names?(i(),b("ul",ds,[(i(!0),b(st,null,Yt(t(s).alternative_names.split(","),$=>(i(),b("li",{key:$},a($),1))),128))])):p("",!0)])]),e("tr",null,[l[12]||(l[12]=e("td",{class:"label"},"域名数量",-1)),e("td",us,a(t(s).standard_count?t(s).standard_count+"个标准域名":"")+" "+a(t(s).standard_count&&t(s).wildcard_count?"/":"")+" "+a(t(s).wildcard_count?t(s).wildcard_count+"个通配符":""),1)]),t(s).api_id?(i(),b("tr",cs,[l[13]||(l[13]=e("td",{class:"label"},"接口ID",-1)),e("td",ps,a(t(s).api_id),1)])):p("",!0),t(s).vendor_id?(i(),b("tr",ms,[l[14]||(l[14]=e("td",{class:"label"},"CA订单ID",-1)),e("td",_s,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(i(),b("tr",vs,[l[15]||(l[15]=e("td",{class:"label"},"动作",-1)),e("td",fs,a(t(Pt)[t(s).action]),1)])):p("",!0),t(s).channel?(i(),b("tr",ys,[l[16]||(l[16]=e("td",{class:"label"},"来源",-1)),e("td",bs,a(t(At)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[17]||(l[17]=e("td",{class:"label"},"金额",-1)),e("td",gs,a(t(s).amount),1)]),t(s).issuer?(i(),b("tr",ks,[l[18]||(l[18]=e("td",{class:"label"},"签发者",-1)),e("td",$s,a(t(s).issuer),1)])):p("",!0),t(s).issuer?(i(),b("tr",ws,[l[19]||(l[19]=e("td",{class:"label"},"序列号",-1)),e("td",Cs,a(t(s).serial_number),1)])):p("",!0),t(s).issuer?(i(),b("tr",xs,[l[20]||(l[20]=e("td",{class:"label"},"指纹",-1)),e("td",zs,a(t(s).fingerprint),1)])):p("",!0),t(s).issuer?(i(),b("tr",Ds,[l[21]||(l[21]=e("td",{class:"label"},"加密算法",-1)),e("td",Vs,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).issuer?(i(),b("tr",Ts,[l[22]||(l[22]=e("td",{class:"label"},"摘要算法",-1)),e("td",Is,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(i(),b("tr",Ys,[l[23]||(l[23]=e("td",{class:"label"},"签发时间",-1)),e("td",Ss,a(t(s).issued_at?t(q)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(i(),b("tr",Ms,[l[24]||(l[24]=e("td",{class:"label"},"到期时间",-1)),e("td",Es,a(t(s).expires_at?t(q)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),e("tr",null,[l[26]||(l[26]=e("td",{class:"label"},"CSR",-1)),e("td",Os,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=$=>d.value="csr")},{default:n(()=>[...l[25]||(l[25]=[m("查看",-1)])]),_:1})])]),t(s).private_key?(i(),b("tr",Hs,[l[28]||(l[28]=e("td",{class:"label"},"私钥",-1)),e("td",Ps,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=$=>d.value="private_key")},{default:n(()=>[...l[27]||(l[27]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(i(),b("tr",As,[l[30]||(l[30]=e("td",{class:"label"},"证书",-1)),e("td",Ls,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=$=>d.value="cert")},{default:n(()=>[...l[29]||(l[29]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(g,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=$=>d.value="")},{header:n(()=>[d.value=="csr"?(i(),b("div",Us," 查看CSR ")):p("",!0),d.value=="private_key"?(i(),b("div",Rs," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(i(),k(y,{key:0},{default:n(()=>[o(C,null,{default:n(()=>[l[33]||(l[33]=e("span",null,"请求文件(CSR)",-1)),e("span",Bs,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=$=>u(t(s).csr))},{default:n(()=>[...l[32]||(l[32]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(i(),k(y,{key:1},{default:n(()=>[o(C,null,{default:n(()=>[l[35]||(l[35]=e("span",null,"私钥(KEY)",-1)),e("span",Ws,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=$=>u(t(s).private_key))},{default:n(()=>[...l[34]||(l[34]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(g,{"model-value":["cert","bt"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=$=>d.value="")},ee({default:n(()=>[d.value=="cert"?(i(),k(y,{key:0,gutter:20},{default:n(()=>[o(C,{span:12},{default:n(()=>[l[38]||(l[38]=e("span",null,"证书(CERT)",-1)),e("span",js,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=$=>u(t(s).cert))},{default:n(()=>[...l[37]||(l[37]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(C,{span:12},{default:n(()=>[l[40]||(l[40]=e("span",null,"证书链(CHAIN)",-1)),e("span",Fs,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=$=>u(t(s).intermediate_cert))},{default:n(()=>[...l[39]||(l[39]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:2},[d.value=="cert"?{name:"header",fn:n(()=>[l[36]||(l[36]=e("div",{class:"title",style:{"margin-bottom":"0"}}," 查看证书 (宝塔面板需要复制证书+证书链) ",-1))]),key:"0"}:void 0]),1032,["model-value"])],64)}}}),me=X(qs,[["__scopeId","data-v-5575c795"]]),Se=[{label:"证书ID",prop:"id",minWidth:140},{label:"订单ID",prop:"order_id",minWidth:140},{label:"通用名称",prop:"common_name",minWidth:150},{label:"金额(元)",prop:"amount",minWidth:90,cellRenderer:({row:D})=>D.amount>0?D.amount:"-"},{label:"渠道",prop:"channel",minWidth:80,cellRenderer:({row:D})=>o(f("el-tag"),{type:Ge[D.channel]},{default:()=>[At[D.channel]]})},{label:"操作",prop:"action",minWidth:80,cellRenderer:({row:D})=>o(f("el-tag"),{type:Je[D.action]},{default:()=>[Pt[D.action]]})},{label:"状态",prop:"status",minWidth:80,cellRenderer:({row:D})=>o(f("el-tag"),{type:Ot[D.status]||"info"},{default:()=>[Ht[D.status]]})},{label:"签发时间",prop:"issued_at",minWidth:170,formatter:({issued_at:D})=>D?q(D).format("YYYY-MM-DD HH:mm:ss"):"-"},{label:"到期时间",prop:"expires_at",minWidth:170,formatter:({expires_at:D})=>D?q(D).format("YYYY-MM-DD HH:mm:ss"):"-"}],Ns=W({__name:"issueList",props:{activeTab:{type:String,required:!0}},setup(D){const s=D,d=E("order"),u=O([]),r=ot({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]}),l=()=>vt(null,null,function*(){s.activeTab==="issueList"&&Ye({currentPage:r.currentPage,pageSize:r.pageSize,order_id:d.id}).then(_=>{_.code===1&&(u.value=_.data.items,r.total=_.data.total)})}),c=_=>{r.pageSize=_,l()},z=_=>{r.currentPage=_,l()};return kt(()=>d.sync,()=>{l()}),kt(()=>s.activeTab,_=>{_==="issueList"&&l()}),(_,C)=>{const y=f("el-card");return i(),k(y,{shadow:"never",style:{border:"none"}},{default:n(()=>[C[0]||(C[0]=e("h2",{class:"title"},[e("span",null,"颁发记录")],-1)),o(t(Ie),{columns:t(Se),data:u.value,pagination:r,"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:c,onPageCurrentChange:z},null,8,["columns","data","pagination"])]),_:1})}}}),hs=X(Ns,[["__scopeId","data-v-1581e633"]]),_e=W({__name:"index",setup(D){const s=O("detail"),d=O(window.innerWidth),u=()=>{d.value=window.innerWidth};return pt(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(r,l)=>{const c=f("el-col"),z=f("el-row"),_=f("el-tab-pane"),C=f("el-tabs");return i(),k(C,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(_,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(i(),k(z,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(ce)]),_:1}),o(c,{span:12},{default:n(()=>[o(pe),o(me)]),_:1})]),_:1})):(i(),k(z,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(ce),o(pe),o(me)]),_:1})]),_:1}))]),_:1}),o(_,{label:"颁发记录",name:"issueList"},{default:n(()=>[o(hs,{"active-tab":s.value},null,8,["active-tab"])]),_:1})]),_:1},8,["modelValue"])}}}),Ks={class:"dialog-footer"},Zs={class:"dialog-footer"},Gs=W({__name:"operate",setup(D){var w;const{toDetail:s}=Rt(),d=St(),u=d.path,r=d.params,l=E("order"),c=E("cert"),z=E("sync"),_=E("get"),C=J(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),{action:y,openAction:g}=xe(),$=H=>{if(H)switch(H){case"send":M.value=!0;break;case"transfer":tt.value=!0;break;case"commit":Q();break;case"sync":z(!0);break;case"commitCancel":Y();break;case"revokeCancel":N();break;case"renew":g("renew",l.id);break;case"reissue":g("reissue",l.id);break}},T=O((w=l==null?void 0:l.user)==null?void 0:w.email),M=O(!1),Z=()=>{Bt(l.id,T.value).then(()=>{M.value=!1,I("发送成功",{type:"success"})})},Q=()=>{$t(l.id).then(()=>{I("提交成功",{type:"success"}),_()})},Y=()=>{ft.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let H=r.ids.toString().split(",");H.length>1?(H=H.filter(v=>v!==l.id.toString()),s({ids:H.join(",")},"params")):Mt.push({name:"Order"})}else dt(l.id).then(H=>{H.data.sync=ut(),Object.assign(l,ot(H.data))})})})},N=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),dt(l.id).then(H=>{H.data.sync=ut(),Object.assign(l,ot(H.data))})})},rt=O(""),tt=O(!1),A=()=>{if(!rt.value){I("请选择用户",{type:"error"});return}Ft({order_id:l.id,user_id:rt.value}).then(()=>{I("过户成功",{type:"success"}),_(),tt.value=!1})};return(H,v)=>{const G=f("el-icon"),V=f("el-button"),x=f("el-dropdown-item"),R=f("el-dropdown-menu"),F=f("el-dropdown"),j=f("el-input"),S=f("el-form-item"),h=f("el-dialog");return i(),b(st,null,[o(F,{style:{"margin-top":"7px"},onCommand:$},{dropdown:n(()=>[o(R,null,{default:n(()=>[t(c).status=="active"?(i(),k(x,{key:0,command:"send"},{default:n(()=>[...v[12]||(v[12]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(x,{key:1,command:"transfer"},{default:n(()=>[...v[13]||(v[13]=[m(a("过户"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(i(),k(x,{key:2,command:"commit"},{default:n(()=>[...v[14]||(v[14]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(i(),k(x,{key:3,command:"sync"},{default:n(()=>[...v[15]||(v[15]=[m(a("同步"),-1)])]),_:1})):p("",!0),C.value?(i(),k(x,{key:4,command:"commitCancel",divided:""},{default:n(()=>[...v[16]||(v[16]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(i(),k(x,{key:5,command:"revokeCancel"},{default:n(()=>[...v[17]||(v[17]=[m(a("撤回"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(x,{key:6,command:"renew",divided:""},{default:n(()=>[...v[18]||(v[18]=[m(a("续费"),-1)])]),_:1})):p("",!0),["active","expired"].includes(t(c).status)?(i(),k(x,{key:7,command:"reissue",divided:""},{default:n(()=>[...v[19]||(v[19]=[m(a("重签"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(V,{type:"primary",size:"small"},{default:n(()=>[v[11]||(v[11]=m(a("操作")+" ",-1)),o(G,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(V,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:v[0]||(v[0]=P=>t(_)(!0))},{default:n(()=>[o(G,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(ht))]),_:1})]),_:1}),o(h,{modelValue:M.value,"onUpdate:modelValue":v[4]||(v[4]=P=>M.value=P),title:"发送邮件",width:"400px"},{footer:n(()=>[e("span",Ks,[o(V,{onClick:v[2]||(v[2]=P=>M.value=!1)},{default:n(()=>[...v[20]||(v[20]=[m(a("取消"),-1)])]),_:1}),o(V,{type:"primary",onClick:v[3]||(v[3]=P=>Z())},{default:n(()=>[...v[21]||(v[21]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(S,{label:"邮箱","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(j,{modelValue:T.value,"onUpdate:modelValue":v[1]||(v[1]=P=>T.value=P),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:tt.value,"onUpdate:modelValue":v[8]||(v[8]=P=>tt.value=P),title:"过户证书",width:"400px"},{footer:n(()=>[e("span",Zs,[o(V,{onClick:v[6]||(v[6]=P=>tt.value=!1)},{default:n(()=>[...v[22]||(v[22]=[m(a("取消"),-1)])]),_:1}),o(V,{type:"primary",onClick:v[7]||(v[7]=P=>A())},{default:n(()=>[...v[23]||(v[23]=[m(a("确定"),-1)])]),_:1})])]),default:n(()=>[o(S,{label:"新用户","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(t(Jt),{modelValue:rt.value,"onUpdate:modelValue":v[5]||(v[5]=P=>rt.value=P),uri:"/user",searchField:"quickSearch",labelField:"username",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择要过户到的用户",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(ze,{visible:t(y).visible,"onUpdate:visible":v[9]||(v[9]=P=>t(y).visible=P),actionType:t(y).type,orderId:t(y).id,onSuccess:v[10]||(v[10]=P=>t(_)(!0))},null,8,["visible","actionType","orderId"])],64)}}}),Js={class:"descriptions"},Xs={style:{margin:"10px 0"}},Qs={class:"descriptions"},tn={style:{width:"100%"}},en={style:{"text-align":"right"}},ln=W({__name:"validation",setup(D){const s=E("get"),d=E("order"),u=E("cert"),r=O(!1),l=()=>{$t(d.id).then(z=>{I(z.msg?z.msg:"提交成功",{type:"success"}),s()})},c=()=>{r.value||(r.value=!0,De(d.id).then(z=>{I(z.msg?z.msg:"验证邮件已重发，请检查邮箱",{type:"success"}),s()}).finally(()=>{r.value=!1}))};return(z,_)=>{var g;const C=f("el-button"),y=f("el-icon");return i(),b(st,null,[e("div",Js,[e("div",Xs,[["pending"].includes(t(u).status)?(i(),k(C,{key:0,type:"warning",onClick:l},{default:n(()=>[..._[0]||(_[0]=[m(" 提交 ",-1)])]),_:1})):p("",!0),["processing"].includes(t(u).status)?(i(),k(C,{key:1,type:"primary",loading:r.value,onClick:c},{default:n(()=>[..._[1]||(_[1]=[m(" 重发验证邮件 ",-1)])]),_:1},8,["loading"])):p("",!0)])]),e("div",Qs,[e("table",tn,[e("tbody",null,[_[2]||(_[2]=e("tr",null,[e("td",{class:"domain"},"邮箱"),e("td",{style:{"text-align":"right"}},"状态")],-1)),e("tr",null,[e("td",null,a(((g=t(d).contact)==null?void 0:g.email)||t(u).common_name),1),e("td",en,[["active","approving"].includes(t(u).status)?(i(),k(y,{key:0,color:"var(--el-color-success)",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Ve))]),_:1})):["pending","processing"].includes(t(u).status)?(i(),k(y,{key:1,class:"is-loading",size:18,style:{"vertical-align":"middle"}},{default:n(()=>[o(t(Te))]),_:1})):p("",!0)])])])])])],64)}}}),sn=X(ln,[["__scopeId","data-v-3b1d6103"]]),nn={class:"title"},on={style:{"margin-left":"15px"}},an={class:"descriptions",style:{width:"100%"}},rn={class:"label"},dn={key:0},un={class:"label"},cn={key:1},pn={class:"content"},mn={class:"label"},_n={class:"content"},vn={class:"label"},fn=W({__name:"process",setup(D){const s=E("order"),d=E("cert"),u=y=>J(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[y]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),r=u("cert_apply_status"),l=u("org_verify_status"),c=u("domain_verify_status"),z=J(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),_=J(()=>{var $,T;if(!["pending","processing","active","expired","approving","cancelling"].includes(($=d.value)==null?void 0:$.status))return!1;if(!((T=s.value)!=null&&T.period_till))return!0;const g=q(s.value.period_till);return g.isValid()&&g.isAfter(q())}),C=O(null);return pt(()=>{if(C.value){const y=C.value.$el,g=window.getComputedStyle(y),$=g.backgroundColor,T=g.borderColor,M=g.color;y.style.setProperty("--original-bg-color",$),y.style.setProperty("--original-border-color",T),y.style.setProperty("--original-text-color",M)}}),(y,g)=>{const $=f("el-icon"),T=f("el-card");return i(),k(T,{shadow:"never",style:{border:"none"}},{default:n(()=>{var M,Z;return[e("h2",nn,[g[0]||(g[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Zt),{ref_key:"statusButton",ref:C,type:t(Ot)[(M=t(d))==null?void 0:M.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var Q;return[m(a(t(Ht)[(Q=t(d))==null?void 0:Q.status]),1)]}),_:1},8,["type"]),e("span",on,[_.value?(i(),k(Gs,{key:0})):p("",!0)])]),e("table",an,[e("tbody",null,[e("tr",null,[e("td",rn,[o($,{size:16,class:"icon",color:t(r)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[1]||(g[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(i(),b("tr",dn,[e("td",un,[o($,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[2]||(g[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((Z=t(s).brand)==null?void 0:Z.toLowerCase())==="certum"?(i(),b("tr",cn,[g[3]||(g[3]=e("td",{class:"label"},null,-1)),e("td",pn,[o(Qt)])])):p("",!0),e("tr",null,[e("td",mn,[o($,{size:16,class:"icon",color:t(c)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[4]||(g[4]=e("td",{class:"content"},"邮箱验证",-1))]),e("tr",null,[g[5]||(g[5]=e("td",{class:"label"},null,-1)),e("td",_n,[o(sn)])]),e("tr",null,[e("td",vn,[o($,{size:16,class:"icon",color:z.value},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),g[6]||(g[6]=e("td",{class:"content"},"签发证书",-1))])])])]}),_:1})}}}),ve=X(fn,[["__scopeId","data-v-033157b1"]]),yn={class:"descriptions"},bn={class:"content"},gn={class:"content"},kn={class:"content"},$n={class:"content"},wn={class:"content"},Cn={class:"content"},xn={class:"content"},zn={class:"content"},Dn={key:0},Vn={class:"content"},Tn={key:1},In={class:"content"},Yn={class:"content"},Sn={class:"content"},Mn=W({__name:"order",setup(D){const s=E("order"),d=()=>{ft.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{qt(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),dt(s.id).then(r=>{r.data.sync=ut(),Object.assign(s,ot(r.data))})})})};return(u,r)=>{const l=f("el-button"),c=f("el-card");return i(),k(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[r[15]||(r[15]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",yn,[e("tbody",null,[e("tr",null,[r[0]||(r[0]=e("td",{class:"label"},"用户",-1)),e("td",bn,a(t(s).user.username),1)]),e("tr",null,[r[1]||(r[1]=e("td",{class:"label"},"订单ID",-1)),e("td",gn,a(t(s).id),1)]),e("tr",null,[r[2]||(r[2]=e("td",{class:"label"},"品牌",-1)),e("td",kn,a(t(s).brand),1)]),e("tr",null,[r[3]||(r[3]=e("td",{class:"label"},"产品",-1)),e("td",$n,a(t(s).product.name),1)]),e("tr",null,[r[4]||(r[4]=e("td",{class:"label"},"金额",-1)),e("td",wn,a(t(s).amount),1)]),e("tr",null,[r[5]||(r[5]=e("td",{class:"label"},"购买时长",-1)),e("td",Cn,a(t(Xt)[t(s).period]),1)]),e("tr",null,[r[6]||(r[6]=e("td",{class:"label"},"有效期从",-1)),e("td",xn,a(t(s).period_from?t(q)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):""),1)]),e("tr",null,[r[7]||(r[7]=e("td",{class:"label"},"有效期到",-1)),e("td",zn,a(t(s).period_till?t(q)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):""),1)]),t(s).organization?(i(),b("tr",Dn,[r[10]||(r[10]=e("td",{class:"label"},"组织",-1)),e("td",Vn,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),r[8]||(r[8]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),r[9]||(r[9]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(i(),b("tr",Tn,[r[12]||(r[12]=e("td",{class:"label"},"联系人",-1)),e("td",In,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),r[11]||(r[11]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[r[13]||(r[13]=e("td",{class:"label"},"会员备注",-1)),e("td",Yn,a(t(s).remark),1)]),e("tr",null,[r[14]||(r[14]=e("td",{class:"label"},"管理员备注",-1)),e("td",Sn,[m(a(t(s).admin_remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).admin_remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),fe=X(Mn,[["__scopeId","data-v-df564113"]]),En={class:"descriptions"},On={class:"content"},Hn={class:"content"},Pn={key:0},An={class:"content"},Ln={key:1},Un={class:"content"},Rn={key:2},Bn={class:"content"},Wn={key:3},jn={class:"content"},Fn={class:"content"},qn={key:4},Nn={class:"content"},hn={key:5},Kn={class:"content"},Zn={key:6},Gn={class:"content"},Jn={key:7},Xn={class:"content"},Qn={key:8},to={class:"content"},eo={key:9},lo={class:"content"},so={key:10},no={class:"content"},oo={key:11},ao={class:"content"},ro={key:12},io={class:"content"},uo={key:13},co={class:"content"},po={key:0,class:"title",style:{"margin-bottom":"0"}},mo={key:1,class:"title",style:{"margin-bottom":"0"}},_o={style:{float:"right"}},vo={style:{float:"right"}},fo={style:{float:"right"}},yo={style:{float:"right"}},bo=W({__name:"cert",setup(D){const s=E("cert"),d=O(""),u=r=>{navigator.clipboard.writeText(r).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return Et(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(r,l)=>{const c=f("el-button"),z=f("el-card"),_=f("el-input"),C=f("el-col"),y=f("el-row"),g=f("el-dialog");return i(),b(st,null,[o(z,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[29]||(l[29]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",En,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",On,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"通用名称",-1)),e("td",Hn,a(t(s).common_name),1)]),t(s).api_id?(i(),b("tr",Pn,[l[11]||(l[11]=e("td",{class:"label"},"接口ID",-1)),e("td",An,a(t(s).api_id),1)])):p("",!0),t(s).vendor_id?(i(),b("tr",Ln,[l[12]||(l[12]=e("td",{class:"label"},"CA订单ID",-1)),e("td",Un,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(i(),b("tr",Rn,[l[13]||(l[13]=e("td",{class:"label"},"动作",-1)),e("td",Bn,a(t(Pt)[t(s).action]),1)])):p("",!0),t(s).channel?(i(),b("tr",Wn,[l[14]||(l[14]=e("td",{class:"label"},"来源",-1)),e("td",jn,a(t(At)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[15]||(l[15]=e("td",{class:"label"},"金额",-1)),e("td",Fn,a(t(s).amount),1)]),t(s).issuer?(i(),b("tr",qn,[l[16]||(l[16]=e("td",{class:"label"},"签发者",-1)),e("td",Nn,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(i(),b("tr",hn,[l[17]||(l[17]=e("td",{class:"label"},"序列号",-1)),e("td",Kn,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(i(),b("tr",Zn,[l[18]||(l[18]=e("td",{class:"label"},"指纹",-1)),e("td",Gn,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(i(),b("tr",Jn,[l[19]||(l[19]=e("td",{class:"label"},"加密算法",-1)),e("td",Xn,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(i(),b("tr",Qn,[l[20]||(l[20]=e("td",{class:"label"},"摘要算法",-1)),e("td",to,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(i(),b("tr",eo,[l[21]||(l[21]=e("td",{class:"label"},"签发时间",-1)),e("td",lo,a(t(s).issued_at?t(q)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(i(),b("tr",so,[l[22]||(l[22]=e("td",{class:"label"},"到期时间",-1)),e("td",no,a(t(s).expires_at?t(q)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(i(),b("tr",oo,[l[24]||(l[24]=e("td",{class:"label"},"CSR",-1)),e("td",ao,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=$=>d.value="csr")},{default:n(()=>[...l[23]||(l[23]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(i(),b("tr",ro,[l[26]||(l[26]=e("td",{class:"label"},"私钥",-1)),e("td",io,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=$=>d.value="private_key")},{default:n(()=>[...l[25]||(l[25]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(i(),b("tr",uo,[l[28]||(l[28]=e("td",{class:"label"},"证书",-1)),e("td",co,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=$=>d.value="cert")},{default:n(()=>[...l[27]||(l[27]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(g,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=$=>d.value="")},{header:n(()=>[d.value=="csr"?(i(),b("div",po," 查看CSR ")):p("",!0),d.value=="private_key"?(i(),b("div",mo," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(i(),k(y,{key:0},{default:n(()=>[o(C,null,{default:n(()=>[l[31]||(l[31]=e("span",null,"请求文件(CSR)",-1)),e("span",_o,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=$=>u(t(s).csr))},{default:n(()=>[...l[30]||(l[30]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(i(),k(y,{key:1},{default:n(()=>[o(C,null,{default:n(()=>[l[33]||(l[33]=e("span",null,"私钥(KEY)",-1)),e("span",vo,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=$=>u(t(s).private_key))},{default:n(()=>[...l[32]||(l[32]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(g,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=$=>d.value="")},{header:n(()=>[...l[34]||(l[34]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(C,{span:12},{default:n(()=>[l[36]||(l[36]=e("span",null,"证书(CERT)",-1)),e("span",fo,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=$=>u(t(s).cert))},{default:n(()=>[...l[35]||(l[35]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(C,{span:12},{default:n(()=>[l[38]||(l[38]=e("span",null,"证书链(CHAIN)",-1)),e("span",yo,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=$=>u(t(s).intermediate_cert))},{default:n(()=>[...l[37]||(l[37]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),ye=X(bo,[["__scopeId","data-v-20a45c1f"]]),go=W({__name:"issueList",props:{activeTab:{type:String,required:!0}},setup(D){const s=D,d=E("order"),u=O([]),r=ot({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]}),l=()=>vt(null,null,function*(){s.activeTab==="issueList"&&Ye({currentPage:r.currentPage,pageSize:r.pageSize,order_id:d.id}).then(_=>{_.code===1&&(u.value=_.data.items,r.total=_.data.total)})}),c=_=>{r.pageSize=_,l()},z=_=>{r.currentPage=_,l()};return kt(()=>d.sync,()=>{l()}),kt(()=>s.activeTab,_=>{_==="issueList"&&l()}),(_,C)=>{const y=f("el-card");return i(),k(y,{shadow:"never",style:{border:"none"}},{default:n(()=>[C[0]||(C[0]=e("h2",{class:"title"},[e("span",null,"颁发记录")],-1)),o(t(Ie),{columns:t(Se),data:u.value,pagination:r,"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:c,onPageCurrentChange:z},null,8,["columns","data","pagination"])]),_:1})}}}),ko=X(go,[["__scopeId","data-v-525cd7a6"]]),$o=W({__name:"index",setup(D){const s=O("detail"),d=O(window.innerWidth),u=()=>{d.value=window.innerWidth};return pt(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(r,l)=>{const c=f("el-col"),z=f("el-row"),_=f("el-tab-pane"),C=f("el-tabs");return i(),k(C,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(_,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(i(),k(z,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(ve)]),_:1}),o(c,{span:12},{default:n(()=>[o(fe),o(ye)]),_:1})]),_:1})):(i(),k(z,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(ve),o(fe),o(ye)]),_:1})]),_:1}))]),_:1}),o(_,{label:"颁发记录",name:"issueList"},{default:n(()=>[o(ko,{"active-tab":s.value},null,8,["active-tab"])]),_:1})]),_:1},8,["modelValue"])}}}),wo={class:"dialog-footer"},Co={class:"dialog-footer"},xo=W({__name:"operate",setup(D){var tt;const{toDetail:s}=Rt(),d=St(),u=d.path,r=d.params,l=E("order"),c=E("cert"),z=E("sync"),_=E("get"),C=J(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),y=A=>{if(A)switch(A){case"send":$.value=!0;break;case"transfer":N.value=!0;break;case"commit":M();break;case"sync":z(!0);break;case"commitCancel":Z();break;case"revokeCancel":Q();break}},g=O((tt=l==null?void 0:l.user)==null?void 0:tt.email),$=O(!1),T=()=>{Bt(l.id,g.value).then(()=>{$.value=!1,I("发送成功",{type:"success"})})},M=()=>{$t(l.id).then(()=>{I("提交成功",{type:"success"}),_()})},Z=()=>{ft.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let A=r.ids.toString().split(",");A.length>1?(A=A.filter(w=>w!==l.id.toString()),s({ids:A.join(",")},"params")):Mt.push({name:"Order"})}else dt(l.id).then(A=>{A.data.sync=ut(),Object.assign(l,ot(A.data))})})})},Q=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),dt(l.id).then(A=>{A.data.sync=ut(),Object.assign(l,ot(A.data))})})},Y=O(""),N=O(!1),rt=()=>{if(!Y.value){I("请选择用户",{type:"error"});return}Ft({order_id:l.id,user_id:Y.value}).then(()=>{I("过户成功",{type:"success"}),_(),N.value=!1})};return(A,w)=>{const H=f("el-icon"),v=f("el-button"),G=f("el-dropdown-item"),V=f("el-dropdown-menu"),x=f("el-dropdown"),R=f("el-input"),F=f("el-form-item"),j=f("el-dialog");return i(),b(st,null,[o(x,{style:{"margin-top":"7px"},onCommand:y},{dropdown:n(()=>[o(V,null,{default:n(()=>[t(c).status=="active"?(i(),k(G,{key:0,command:"send"},{default:n(()=>[...w[10]||(w[10]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(G,{key:1,command:"transfer"},{default:n(()=>[...w[11]||(w[11]=[m(a("过户"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(i(),k(G,{key:2,command:"commit"},{default:n(()=>[...w[12]||(w[12]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(i(),k(G,{key:3,command:"sync"},{default:n(()=>[...w[13]||(w[13]=[m(a("同步"),-1)])]),_:1})):p("",!0),C.value?(i(),k(G,{key:4,command:"commitCancel",divided:""},{default:n(()=>[...w[14]||(w[14]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(i(),k(G,{key:5,command:"revokeCancel"},{default:n(()=>[...w[15]||(w[15]=[m(a("撤回"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(v,{type:"primary",size:"small"},{default:n(()=>[w[9]||(w[9]=m(a("操作")+" ",-1)),o(H,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(v,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:w[0]||(w[0]=S=>t(_)(!0))},{default:n(()=>[o(H,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(ht))]),_:1})]),_:1}),o(j,{modelValue:$.value,"onUpdate:modelValue":w[4]||(w[4]=S=>$.value=S),title:"发送邮件",width:"400px"},{footer:n(()=>[e("span",wo,[o(v,{onClick:w[2]||(w[2]=S=>$.value=!1)},{default:n(()=>[...w[16]||(w[16]=[m(a("取消"),-1)])]),_:1}),o(v,{type:"primary",onClick:w[3]||(w[3]=S=>T())},{default:n(()=>[...w[17]||(w[17]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(F,{label:"邮箱","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(R,{modelValue:g.value,"onUpdate:modelValue":w[1]||(w[1]=S=>g.value=S),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(j,{modelValue:N.value,"onUpdate:modelValue":w[8]||(w[8]=S=>N.value=S),title:"过户证书",width:"400px"},{footer:n(()=>[e("span",Co,[o(v,{onClick:w[6]||(w[6]=S=>N.value=!1)},{default:n(()=>[...w[18]||(w[18]=[m(a("取消"),-1)])]),_:1}),o(v,{type:"primary",onClick:w[7]||(w[7]=S=>rt())},{default:n(()=>[...w[19]||(w[19]=[m(a("确定"),-1)])]),_:1})])]),default:n(()=>[o(F,{label:"新用户","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(t(Jt),{modelValue:Y.value,"onUpdate:modelValue":w[5]||(w[5]=S=>Y.value=S),uri:"/user",searchField:"quickSearch",labelField:"username",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择要过户到的用户",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])],64)}}}),zo={class:"title"},Do={style:{"margin-left":"15px"}},Vo={class:"descriptions",style:{width:"100%"}},To={class:"label"},Io={key:0},Yo={class:"label"},So={key:1},Mo={class:"content"},Eo={class:"label"},Oo=W({__name:"process",setup(D){const s=E("order"),d=E("cert"),u=C=>J(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[C]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),r=u("cert_apply_status"),l=u("org_verify_status"),c=J(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),z=J(()=>{var g,$;if(!["pending","processing","active","expired","approving","cancelling"].includes((g=d.value)==null?void 0:g.status))return!1;if(!(($=s.value)!=null&&$.period_till))return!0;const y=q(s.value.period_till);return y.isValid()&&y.isAfter(q())}),_=O(null);return pt(()=>{if(_.value){const C=_.value.$el,y=window.getComputedStyle(C),g=y.backgroundColor,$=y.borderColor,T=y.color;C.style.setProperty("--original-bg-color",g),C.style.setProperty("--original-border-color",$),C.style.setProperty("--original-text-color",T)}}),(C,y)=>{const g=f("el-icon"),$=f("el-card");return i(),k($,{shadow:"never",style:{border:"none"}},{default:n(()=>{var T,M;return[e("h2",zo,[y[0]||(y[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Zt),{ref_key:"statusButton",ref:_,type:t(Ot)[(T=t(d))==null?void 0:T.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var Z;return[m(a(t(Ht)[(Z=t(d))==null?void 0:Z.status]),1)]}),_:1},8,["type"]),e("span",Do,[z.value?(i(),k(xo,{key:0})):p("",!0)])]),e("table",Vo,[e("tbody",null,[e("tr",null,[e("td",To,[o(g,{size:16,class:"icon",color:t(r)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[1]||(y[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(i(),b("tr",Io,[e("td",Yo,[o(g,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[2]||(y[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((M=t(s).brand)==null?void 0:M.toLowerCase())==="certum"?(i(),b("tr",So,[y[3]||(y[3]=e("td",{class:"label"},null,-1)),e("td",Mo,[o(Qt)])])):p("",!0),e("tr",null,[e("td",Eo,[o(g,{size:16,class:"icon",color:c.value},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[4]||(y[4]=e("td",{class:"content"},"签发证书",-1))])])])]}),_:1})}}}),be=X(Oo,[["__scopeId","data-v-3095c010"]]),Ho={class:"descriptions"},Po={class:"content"},Ao={class:"content"},Lo={class:"content"},Uo={class:"content"},Ro={class:"content"},Bo={class:"content"},Wo={class:"content"},jo={class:"content"},Fo={key:0},qo={class:"content"},No={key:1},ho={class:"content"},Ko={class:"content"},Zo={class:"content"},Go=W({__name:"order",setup(D){const s=E("order"),d=()=>{ft.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{qt(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),dt(s.id).then(r=>{r.data.sync=ut(),Object.assign(s,ot(r.data))})})})};return(u,r)=>{const l=f("el-button"),c=f("el-card");return i(),k(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[r[15]||(r[15]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",Ho,[e("tbody",null,[e("tr",null,[r[0]||(r[0]=e("td",{class:"label"},"用户",-1)),e("td",Po,a(t(s).user.username),1)]),e("tr",null,[r[1]||(r[1]=e("td",{class:"label"},"订单ID",-1)),e("td",Ao,a(t(s).id),1)]),e("tr",null,[r[2]||(r[2]=e("td",{class:"label"},"品牌",-1)),e("td",Lo,a(t(s).brand),1)]),e("tr",null,[r[3]||(r[3]=e("td",{class:"label"},"产品",-1)),e("td",Uo,a(t(s).product.name),1)]),e("tr",null,[r[4]||(r[4]=e("td",{class:"label"},"金额",-1)),e("td",Ro,a(t(s).amount),1)]),e("tr",null,[r[5]||(r[5]=e("td",{class:"label"},"购买时长",-1)),e("td",Bo,a(t(Xt)[t(s).period]),1)]),e("tr",null,[r[6]||(r[6]=e("td",{class:"label"},"有效期从",-1)),e("td",Wo,a(t(s).period_from?t(q)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):""),1)]),e("tr",null,[r[7]||(r[7]=e("td",{class:"label"},"有效期到",-1)),e("td",jo,a(t(s).period_till?t(q)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):""),1)]),t(s).organization?(i(),b("tr",Fo,[r[10]||(r[10]=e("td",{class:"label"},"组织",-1)),e("td",qo,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),r[8]||(r[8]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),r[9]||(r[9]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(i(),b("tr",No,[r[12]||(r[12]=e("td",{class:"label"},"联系人",-1)),e("td",ho,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),r[11]||(r[11]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[r[13]||(r[13]=e("td",{class:"label"},"会员备注",-1)),e("td",Ko,a(t(s).remark),1)]),e("tr",null,[r[14]||(r[14]=e("td",{class:"label"},"管理员备注",-1)),e("td",Zo,[m(a(t(s).admin_remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).admin_remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),ge=X(Go,[["__scopeId","data-v-6ffe5bfc"]]),Jo={class:"descriptions"},Xo={class:"content"},Qo={class:"content"},ta={key:0},ea={class:"content"},la={key:1},sa={class:"content"},na={key:2},oa={class:"content"},aa={key:3},ra={class:"content"},ia={class:"content"},da={key:4},ua={class:"content"},ca={key:5},pa={class:"content"},ma={key:6},_a={class:"content"},va={key:7},fa={class:"content"},ya={key:8},ba={class:"content"},ga={key:9},ka={class:"content"},$a={key:10},wa={class:"content"},Ca={key:11},xa={class:"content"},za={key:12},Da={class:"content"},Va={key:13},Ta={class:"content"},Ia={key:0,class:"title",style:{"margin-bottom":"0"}},Ya={key:1,class:"title",style:{"margin-bottom":"0"}},Sa={style:{float:"right"}},Ma={style:{float:"right"}},Ea={style:{float:"right"}},Oa={style:{float:"right"}},Ha=W({__name:"cert",setup(D){const s=E("cert"),d=O(""),u=r=>{navigator.clipboard.writeText(r).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return Et(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(r,l)=>{const c=f("el-button"),z=f("el-card"),_=f("el-input"),C=f("el-col"),y=f("el-row"),g=f("el-dialog");return i(),b(st,null,[o(z,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[29]||(l[29]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",Jo,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",Xo,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"组织名称",-1)),e("td",Qo,a(t(s).common_name),1)]),t(s).api_id?(i(),b("tr",ta,[l[11]||(l[11]=e("td",{class:"label"},"接口ID",-1)),e("td",ea,a(t(s).api_id),1)])):p("",!0),t(s).vendor_id?(i(),b("tr",la,[l[12]||(l[12]=e("td",{class:"label"},"CA订单ID",-1)),e("td",sa,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(i(),b("tr",na,[l[13]||(l[13]=e("td",{class:"label"},"动作",-1)),e("td",oa,a(t(Pt)[t(s).action]),1)])):p("",!0),t(s).channel?(i(),b("tr",aa,[l[14]||(l[14]=e("td",{class:"label"},"来源",-1)),e("td",ra,a(t(At)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[15]||(l[15]=e("td",{class:"label"},"金额",-1)),e("td",ia,a(t(s).amount),1)]),t(s).issuer?(i(),b("tr",da,[l[16]||(l[16]=e("td",{class:"label"},"签发者",-1)),e("td",ua,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(i(),b("tr",ca,[l[17]||(l[17]=e("td",{class:"label"},"序列号",-1)),e("td",pa,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(i(),b("tr",ma,[l[18]||(l[18]=e("td",{class:"label"},"指纹",-1)),e("td",_a,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(i(),b("tr",va,[l[19]||(l[19]=e("td",{class:"label"},"加密算法",-1)),e("td",fa,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(i(),b("tr",ya,[l[20]||(l[20]=e("td",{class:"label"},"摘要算法",-1)),e("td",ba,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(i(),b("tr",ga,[l[21]||(l[21]=e("td",{class:"label"},"签发时间",-1)),e("td",ka,a(t(s).issued_at?t(q)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(i(),b("tr",$a,[l[22]||(l[22]=e("td",{class:"label"},"到期时间",-1)),e("td",wa,a(t(s).expires_at?t(q)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(i(),b("tr",Ca,[l[24]||(l[24]=e("td",{class:"label"},"CSR",-1)),e("td",xa,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=$=>d.value="csr")},{default:n(()=>[...l[23]||(l[23]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(i(),b("tr",za,[l[26]||(l[26]=e("td",{class:"label"},"私钥",-1)),e("td",Da,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=$=>d.value="private_key")},{default:n(()=>[...l[25]||(l[25]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(i(),b("tr",Va,[l[28]||(l[28]=e("td",{class:"label"},"证书",-1)),e("td",Ta,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=$=>d.value="cert")},{default:n(()=>[...l[27]||(l[27]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(g,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=$=>d.value="")},{header:n(()=>[d.value=="csr"?(i(),b("div",Ia," 查看CSR ")):p("",!0),d.value=="private_key"?(i(),b("div",Ya," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(i(),k(y,{key:0},{default:n(()=>[o(C,null,{default:n(()=>[l[31]||(l[31]=e("span",null,"请求文件(CSR)",-1)),e("span",Sa,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=$=>u(t(s).csr))},{default:n(()=>[...l[30]||(l[30]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(i(),k(y,{key:1},{default:n(()=>[o(C,null,{default:n(()=>[l[33]||(l[33]=e("span",null,"私钥(KEY)",-1)),e("span",Ma,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=$=>u(t(s).private_key))},{default:n(()=>[...l[32]||(l[32]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(g,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=$=>d.value="")},{header:n(()=>[...l[34]||(l[34]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(C,{span:12},{default:n(()=>[l[36]||(l[36]=e("span",null,"证书(CERT)",-1)),e("span",Ea,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=$=>u(t(s).cert))},{default:n(()=>[...l[35]||(l[35]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(C,{span:12},{default:n(()=>[l[38]||(l[38]=e("span",null,"证书链(CHAIN)",-1)),e("span",Oa,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=$=>u(t(s).intermediate_cert))},{default:n(()=>[...l[37]||(l[37]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),ke=X(Ha,[["__scopeId","data-v-3600f6c9"]]),Pa=W({__name:"index",setup(D){const s=O("detail"),d=O(window.innerWidth),u=()=>{d.value=window.innerWidth};return pt(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(r,l)=>{const c=f("el-col"),z=f("el-row"),_=f("el-tab-pane"),C=f("el-tabs");return i(),k(C,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(_,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(i(),k(z,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o(be)]),_:1}),o(c,{span:12},{default:n(()=>[o(ge),o(ke)]),_:1})]),_:1})):(i(),k(z,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o(be),o(ge),o(ke)]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])}}}),Aa={class:"dialog-footer"},La={class:"dialog-footer"},Ua=W({__name:"operate",setup(D){var tt;const{toDetail:s}=Rt(),d=St(),u=d.path,r=d.params,l=E("order"),c=E("cert"),z=E("sync"),_=E("get"),C=J(()=>!l.created_at||["unpaid","pending"].includes(l.latest_cert.status)?!0:["processing","approving","active"].includes(l.latest_cert.status)&&Math.floor(Date.now()/1e3)-new Date(l.created_at).getTime()<86400*l.product.refund_period),y=A=>{if(A)switch(A){case"send":$.value=!0;break;case"transfer":N.value=!0;break;case"commit":M();break;case"sync":z(!0);break;case"commitCancel":Z();break;case"revokeCancel":Q();break}},g=O((tt=l==null?void 0:l.user)==null?void 0:tt.email),$=O(!1),T=()=>{Bt(l.id,g.value).then(()=>{$.value=!1,I("发送成功",{type:"success"})})},M=()=>{$t(l.id).then(()=>{I("提交成功",{type:"success"}),_()})},Z=()=>{ft.confirm("取消提交2分钟后执行！如取消错误，请在2分钟内撤回！","取消证书",{confirmButtonText:"确定",cancelButtonText:"返回",type:"warning",draggable:!0}).then(()=>{Wt(l.id).then(()=>{if(I("提交取消成功",{type:"success"}),l.latest_cert.status==="unpaid"){Kt().handleTags("splice",u);let A=r.ids.toString().split(",");A.length>1?(A=A.filter(w=>w!==l.id.toString()),s({ids:A.join(",")},"params")):Mt.push({name:"Order"})}else dt(l.id).then(A=>{A.data.sync=ut(),Object.assign(l,ot(A.data))})})})},Q=()=>{jt(l.id).then(()=>{I("撤回取消成功",{type:"success"}),dt(l.id).then(A=>{A.data.sync=ut(),Object.assign(l,ot(A.data))})})},Y=O(""),N=O(!1),rt=()=>{if(!Y.value){I("请选择用户",{type:"error"});return}Ft({order_id:l.id,user_id:Y.value}).then(()=>{I("过户成功",{type:"success"}),_(),N.value=!1})};return(A,w)=>{const H=f("el-icon"),v=f("el-button"),G=f("el-dropdown-item"),V=f("el-dropdown-menu"),x=f("el-dropdown"),R=f("el-input"),F=f("el-form-item"),j=f("el-dialog");return i(),b(st,null,[o(x,{style:{"margin-top":"7px"},onCommand:y},{dropdown:n(()=>[o(V,null,{default:n(()=>[t(c).status=="active"?(i(),k(G,{key:0,command:"send"},{default:n(()=>[...w[10]||(w[10]=[m(a("发送"),-1)])]),_:1})):p("",!0),t(c).status=="active"?(i(),k(G,{key:1,command:"transfer"},{default:n(()=>[...w[11]||(w[11]=[m(a("过户"),-1)])]),_:1})):p("",!0),t(c).status=="pending"?(i(),k(G,{key:2,command:"commit"},{default:n(()=>[...w[12]||(w[12]=[m(a("提交"),-1)])]),_:1})):p("",!0),["processing","active","approving"].includes(t(c).status)?(i(),k(G,{key:3,command:"sync"},{default:n(()=>[...w[13]||(w[13]=[m(a("同步"),-1)])]),_:1})):p("",!0),C.value?(i(),k(G,{key:4,command:"commitCancel",divided:""},{default:n(()=>[...w[14]||(w[14]=[m(a("取消"),-1)])]),_:1})):p("",!0),t(c).status=="cancelling"?(i(),k(G,{key:5,command:"revokeCancel"},{default:n(()=>[...w[15]||(w[15]=[m(a("撤回"),-1)])]),_:1})):p("",!0)]),_:1})]),default:n(()=>[o(v,{type:"primary",size:"small"},{default:n(()=>[w[9]||(w[9]=m(a("操作")+" ",-1)),o(H,{style:{"margin-left":"6px",color:"var(--el-color-white)"}},{default:n(()=>[o(t(Nt))]),_:1})]),_:1})]),_:1}),o(v,{circle:"",size:"small",style:{"margin-left":"12px"},onClick:w[0]||(w[0]=S=>t(_)(!0))},{default:n(()=>[o(H,{size:"14",color:"var(--el-text-color-regular)"},{default:n(()=>[o(t(ht))]),_:1})]),_:1}),o(j,{modelValue:$.value,"onUpdate:modelValue":w[4]||(w[4]=S=>$.value=S),title:"发送邮件",width:"400px"},{footer:n(()=>[e("span",Aa,[o(v,{onClick:w[2]||(w[2]=S=>$.value=!1)},{default:n(()=>[...w[16]||(w[16]=[m(a("取消"),-1)])]),_:1}),o(v,{type:"primary",onClick:w[3]||(w[3]=S=>T())},{default:n(()=>[...w[17]||(w[17]=[m(a("发送"),-1)])]),_:1})])]),default:n(()=>[o(F,{label:"邮箱","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(R,{modelValue:g.value,"onUpdate:modelValue":w[1]||(w[1]=S=>g.value=S),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o(j,{modelValue:N.value,"onUpdate:modelValue":w[8]||(w[8]=S=>N.value=S),title:"过户证书",width:"400px"},{footer:n(()=>[e("span",La,[o(v,{onClick:w[6]||(w[6]=S=>N.value=!1)},{default:n(()=>[...w[18]||(w[18]=[m(a("取消"),-1)])]),_:1}),o(v,{type:"primary",onClick:w[7]||(w[7]=S=>rt())},{default:n(()=>[...w[19]||(w[19]=[m(a("确定"),-1)])]),_:1})])]),default:n(()=>[o(F,{label:"新用户","label-width":100,class:"ml-3 mr-3"},{default:n(()=>[o(t(Jt),{modelValue:Y.value,"onUpdate:modelValue":w[5]||(w[5]=S=>Y.value=S),uri:"/user",searchField:"quickSearch",labelField:"username",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择要过户到的用户",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Ra={class:"title"},Ba={style:{"margin-left":"15px"}},Wa={class:"descriptions",style:{width:"100%"}},ja={class:"label"},Fa={key:0},qa={class:"label"},Na={key:1},ha={class:"content"},Ka={class:"label"},Za=W({__name:"process",setup(D){const s=E("order"),d=E("cert"),u=C=>J(()=>d.value.status==="active"||d.value.status=="processing"&&d.value[C]==2?"var(--el-color-success)":"var(--el-text-color-regular)"),r=u("cert_apply_status"),l=u("org_verify_status"),c=J(()=>d.value.status==="active"?"var(--el-color-success)":"var(--el-text-color-regular)"),z=J(()=>{var g,$;if(!["pending","processing","active","expired","approving","cancelling"].includes((g=d.value)==null?void 0:g.status))return!1;if(!(($=s.value)!=null&&$.period_till))return!0;const y=q(s.value.period_till);return y.isValid()&&y.isAfter(q())}),_=O(null);return pt(()=>{if(_.value){const C=_.value.$el,y=window.getComputedStyle(C),g=y.backgroundColor,$=y.borderColor,T=y.color;C.style.setProperty("--original-bg-color",g),C.style.setProperty("--original-border-color",$),C.style.setProperty("--original-text-color",T)}}),(C,y)=>{const g=f("el-icon"),$=f("el-card");return i(),k($,{shadow:"never",style:{border:"none"}},{default:n(()=>{var T,M;return[e("h2",Ra,[y[0]||(y[0]=e("span",{style:{"margin-right":"12px"}},"订单状态",-1)),o(t(Zt),{ref_key:"statusButton",ref:_,type:t(Ot)[(T=t(d))==null?void 0:T.status],size:"small",class:"no-hover-effect"},{default:n(()=>{var Z;return[m(a(t(Ht)[(Z=t(d))==null?void 0:Z.status]),1)]}),_:1},8,["type"]),e("span",Ba,[z.value?(i(),k(Ua,{key:0})):p("",!0)])]),e("table",Wa,[e("tbody",null,[e("tr",null,[e("td",ja,[o(g,{size:16,class:"icon",color:t(r)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[1]||(y[1]=e("td",{class:"content"},"提交订单",-1))]),t(s).product.validation_type!=="dv"?(i(),b("tr",Fa,[e("td",qa,[o(g,{size:16,class:"icon",color:t(l)},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[2]||(y[2]=e("td",{class:"content"},"企业验证",-1))])):p("",!0),t(s).product.validation_type!=="dv"&&((M=t(s).brand)==null?void 0:M.toLowerCase())==="certum"?(i(),b("tr",Na,[y[3]||(y[3]=e("td",{class:"label"},null,-1)),e("td",ha,[o(Qt)])])):p("",!0),e("tr",null,[e("td",Ka,[o(g,{size:16,class:"icon",color:c.value},{default:n(()=>[o(t(it))]),_:1},8,["color"])]),y[4]||(y[4]=e("td",{class:"content"},"签发证书",-1))])])])]}),_:1})}}}),$e=X(Za,[["__scopeId","data-v-6bfbb35d"]]),Ga={class:"descriptions"},Ja={class:"content"},Xa={class:"content"},Qa={class:"content"},tr={class:"content"},er={class:"content"},lr={class:"content"},sr={class:"content"},nr={class:"content"},or={key:0},ar={class:"content"},rr={key:1},ir={class:"content"},dr={class:"content"},ur={class:"content"},cr=W({__name:"order",setup(D){const s=E("order"),d=()=>{ft.prompt("请填写备注，删除备注留空即可","备注",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:u})=>{qt(s.id,u!=null?u:"").then(()=>{I("备注已更新",{type:"success"}),dt(s.id).then(r=>{r.data.sync=ut(),Object.assign(s,ot(r.data))})})})};return(u,r)=>{const l=f("el-button"),c=f("el-card");return i(),k(c,{shadow:"never",style:{border:"none"}},{default:n(()=>[r[15]||(r[15]=e("h2",{class:"title"},[e("span",null,"订单详情")],-1)),e("table",Ga,[e("tbody",null,[e("tr",null,[r[0]||(r[0]=e("td",{class:"label"},"用户",-1)),e("td",Ja,a(t(s).user.username),1)]),e("tr",null,[r[1]||(r[1]=e("td",{class:"label"},"订单ID",-1)),e("td",Xa,a(t(s).id),1)]),e("tr",null,[r[2]||(r[2]=e("td",{class:"label"},"品牌",-1)),e("td",Qa,a(t(s).brand),1)]),e("tr",null,[r[3]||(r[3]=e("td",{class:"label"},"产品",-1)),e("td",tr,a(t(s).product.name),1)]),e("tr",null,[r[4]||(r[4]=e("td",{class:"label"},"金额",-1)),e("td",er,a(t(s).amount),1)]),e("tr",null,[r[5]||(r[5]=e("td",{class:"label"},"购买时长",-1)),e("td",lr,a(t(Xt)[t(s).period]),1)]),e("tr",null,[r[6]||(r[6]=e("td",{class:"label"},"有效期从",-1)),e("td",sr,a(t(s).period_from?t(q)(t(s).period_from).format("YYYY-MM-DD HH:mm:ss"):""),1)]),e("tr",null,[r[7]||(r[7]=e("td",{class:"label"},"有效期到",-1)),e("td",nr,a(t(s).period_till?t(q)(t(s).period_till).format("YYYY-MM-DD HH:mm:ss"):""),1)]),t(s).organization?(i(),b("tr",or,[r[10]||(r[10]=e("td",{class:"label"},"组织",-1)),e("td",ar,[m(a(t(s).organization.name)+", "+a(t(s).organization.registration_number),1),r[8]||(r[8]=e("br",null,null,-1)),m(" "+a(t(s).organization.phone)+", "+a(t(s).organization.country)+", "+a(t(s).organization.state)+", "+a(t(s).organization.city)+", "+a(t(s).organization.address)+", "+a(t(s).organization.postcode),1),r[9]||(r[9]=e("br",null,null,-1))])])):p("",!0),t(s).contact?(i(),b("tr",rr,[r[12]||(r[12]=e("td",{class:"label"},"联系人",-1)),e("td",ir,[m(a(t(s).contact.last_name)+" "+a(t(s).contact.first_name)+", "+a(t(s).contact.title)+", "+a(t(s).contact.phone)+", "+a(t(s).contact.email),1),r[11]||(r[11]=e("br",null,null,-1))])])):p("",!0),e("tr",null,[r[13]||(r[13]=e("td",{class:"label"},"会员备注",-1)),e("td",dr,a(t(s).remark),1)]),e("tr",null,[r[14]||(r[14]=e("td",{class:"label"},"管理员备注",-1)),e("td",ur,[m(a(t(s).admin_remark)+" ",1),o(l,{style:{padding:"0 5px 2px",margin:"0"},type:"primary",link:"",size:"small",onClick:d},{default:n(()=>[m(a(t(s).admin_remark?"点击修改":"点击添加"),1)]),_:1})])])])])]),_:1})}}}),we=X(cr,[["__scopeId","data-v-ae29318f"]]),pr={class:"descriptions"},mr={class:"content"},_r={class:"content"},vr={key:0},fr={class:"content"},yr={key:1},br={class:"content"},gr={key:2},kr={class:"content"},$r={key:3},wr={class:"content"},Cr={class:"content"},xr={key:4},zr={class:"content"},Dr={key:5},Vr={class:"content"},Tr={key:6},Ir={class:"content"},Yr={key:7},Sr={class:"content"},Mr={key:8},Er={class:"content"},Or={key:9},Hr={class:"content"},Pr={key:10},Ar={class:"content"},Lr={key:11},Ur={class:"content"},Rr={key:12},Br={class:"content"},Wr={key:13},jr={class:"content"},Fr={key:0,class:"title",style:{"margin-bottom":"0"}},qr={key:1,class:"title",style:{"margin-bottom":"0"}},Nr={style:{float:"right"}},hr={style:{float:"right"}},Kr={style:{float:"right"}},Zr={style:{float:"right"}},Gr=W({__name:"cert",setup(D){const s=E("cert"),d=O(""),u=r=>{navigator.clipboard.writeText(r).then(()=>{I("复制成功",{type:"success"})}).catch(()=>{I("复制失败",{type:"error"})})};return Et(()=>{s.csr=s.csr||"",s.private_key=s.private_key||"",s.cert=s.cert||"",s.intermediate_cert=s.intermediate_cert||""}),(r,l)=>{const c=f("el-button"),z=f("el-card"),_=f("el-input"),C=f("el-col"),y=f("el-row"),g=f("el-dialog");return i(),b(st,null,[o(z,{shadow:"never",style:{border:"none"}},{default:n(()=>[l[29]||(l[29]=e("h2",{class:"title"},[e("span",null,"证书详情")],-1)),e("table",pr,[e("tbody",null,[e("tr",null,[l[9]||(l[9]=e("td",{class:"label"},"证书ID",-1)),e("td",mr,a(t(s).id),1)]),e("tr",null,[l[10]||(l[10]=e("td",{class:"label"},"组织名称",-1)),e("td",_r,a(t(s).common_name),1)]),t(s).api_id?(i(),b("tr",vr,[l[11]||(l[11]=e("td",{class:"label"},"接口ID",-1)),e("td",fr,a(t(s).api_id),1)])):p("",!0),t(s).vendor_id?(i(),b("tr",yr,[l[12]||(l[12]=e("td",{class:"label"},"CA订单ID",-1)),e("td",br,a(t(s).vendor_id),1)])):p("",!0),t(s).action?(i(),b("tr",gr,[l[13]||(l[13]=e("td",{class:"label"},"动作",-1)),e("td",kr,a(t(Pt)[t(s).action]),1)])):p("",!0),t(s).channel?(i(),b("tr",$r,[l[14]||(l[14]=e("td",{class:"label"},"来源",-1)),e("td",wr,a(t(At)[t(s).channel]),1)])):p("",!0),e("tr",null,[l[15]||(l[15]=e("td",{class:"label"},"金额",-1)),e("td",Cr,a(t(s).amount),1)]),t(s).issuer?(i(),b("tr",xr,[l[16]||(l[16]=e("td",{class:"label"},"签发者",-1)),e("td",zr,a(t(s).issuer),1)])):p("",!0),t(s).serial_number?(i(),b("tr",Dr,[l[17]||(l[17]=e("td",{class:"label"},"序列号",-1)),e("td",Vr,a(t(s).serial_number),1)])):p("",!0),t(s).fingerprint?(i(),b("tr",Tr,[l[18]||(l[18]=e("td",{class:"label"},"指纹",-1)),e("td",Ir,a(t(s).fingerprint),1)])):p("",!0),t(s).encryption_alg?(i(),b("tr",Yr,[l[19]||(l[19]=e("td",{class:"label"},"加密算法",-1)),e("td",Sr,a(t(s).encryption_alg)+" "+a(t(s).encryption_bits)+" bits ",1)])):p("",!0),t(s).signature_digest_alg?(i(),b("tr",Mr,[l[20]||(l[20]=e("td",{class:"label"},"摘要算法",-1)),e("td",Er,a(t(s).signature_digest_alg),1)])):p("",!0),t(s).issued_at?(i(),b("tr",Or,[l[21]||(l[21]=e("td",{class:"label"},"签发时间",-1)),e("td",Hr,a(t(s).issued_at?t(q)(t(s).issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).expires_at?(i(),b("tr",Pr,[l[22]||(l[22]=e("td",{class:"label"},"到期时间",-1)),e("td",Ar,a(t(s).expires_at?t(q)(t(s).expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)])):p("",!0),t(s).csr?(i(),b("tr",Lr,[l[24]||(l[24]=e("td",{class:"label"},"CSR",-1)),e("td",Ur,[o(c,{type:"primary",link:"",onClick:l[0]||(l[0]=$=>d.value="csr")},{default:n(()=>[...l[23]||(l[23]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).private_key?(i(),b("tr",Rr,[l[26]||(l[26]=e("td",{class:"label"},"私钥",-1)),e("td",Br,[o(c,{type:"primary",link:"",onClick:l[1]||(l[1]=$=>d.value="private_key")},{default:n(()=>[...l[25]||(l[25]=[m("查看",-1)])]),_:1})])])):p("",!0),t(s).cert?(i(),b("tr",Wr,[l[28]||(l[28]=e("td",{class:"label"},"证书",-1)),e("td",jr,[o(c,{type:"primary",link:"",onClick:l[2]||(l[2]=$=>d.value="cert")},{default:n(()=>[...l[27]||(l[27]=[m("查看",-1)])]),_:1})])])):p("",!0)])])]),_:1}),o(g,{"model-value":["private_key","csr"].includes(d.value),"close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"408px"},onClose:l[5]||(l[5]=$=>d.value="")},{header:n(()=>[d.value=="csr"?(i(),b("div",Fr," 查看CSR ")):p("",!0),d.value=="private_key"?(i(),b("div",qr," 查看私钥 ")):p("",!0)]),default:n(()=>[d.value=="csr"?(i(),k(y,{key:0},{default:n(()=>[o(C,null,{default:n(()=>[l[31]||(l[31]=e("span",null,"请求文件(CSR)",-1)),e("span",Nr,[o(c,{type:"primary",link:"",size:"small",onClick:l[3]||(l[3]=$=>u(t(s).csr))},{default:n(()=>[...l[30]||(l[30]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).csr,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0),d.value=="private_key"?(i(),k(y,{key:1},{default:n(()=>[o(C,null,{default:n(()=>[l[33]||(l[33]=e("span",null,"私钥(KEY)",-1)),e("span",hr,[o(c,{type:"primary",link:"",size:"small",onClick:l[4]||(l[4]=$=>u(t(s).private_key))},{default:n(()=>[...l[32]||(l[32]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).private_key,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})):p("",!0)]),_:1},8,["model-value"]),o(g,{"model-value":d.value==="cert","close-on-click-modal":!1,"destroy-on-close":!0,"align-center":"",style:{width:"796px"},onClose:l[8]||(l[8]=$=>d.value="")},{header:n(()=>[...l[34]||(l[34]=[e("div",{class:"title",style:{"margin-bottom":"0"}},"查看证书",-1)])]),default:n(()=>[o(y,{gutter:20},{default:n(()=>[o(C,{span:12},{default:n(()=>[l[36]||(l[36]=e("span",null,"证书(CERT)",-1)),e("span",Kr,[o(c,{type:"primary",link:"",size:"small",onClick:l[6]||(l[6]=$=>u(t(s).cert))},{default:n(()=>[...l[35]||(l[35]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1}),o(C,{span:12},{default:n(()=>[l[38]||(l[38]=e("span",null,"证书链(CHAIN)",-1)),e("span",Zr,[o(c,{type:"primary",link:"",size:"small",onClick:l[7]||(l[7]=$=>u(t(s).intermediate_cert))},{default:n(()=>[...l[37]||(l[37]=[m("点击复制",-1)])]),_:1})]),o(_,{type:"textarea",rows:20,"model-value":t(s).intermediate_cert,spellcheck:"false","input-style":{"font-size":"9px","font-family":"Consolas, Monaco, serif"}},null,8,["model-value"])]),_:1})]),_:1})]),_:1},8,["model-value"])],64)}}}),Ce=X(Gr,[["__scopeId","data-v-544be47b"]]),Jr=W({__name:"index",setup(D){const s=O("detail"),d=O(window.innerWidth),u=()=>{d.value=window.innerWidth};return pt(()=>{window.addEventListener("resize",u)}),Gt(()=>{window.removeEventListener("resize",u)}),(r,l)=>{const c=f("el-col"),z=f("el-row"),_=f("el-tab-pane"),C=f("el-tabs");return i(),k(C,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=y=>s.value=y)},{default:n(()=>[o(_,{label:"订单详情",name:"detail"},{default:n(()=>[d.value>1680?(i(),k(z,{key:0},{default:n(()=>[o(c,{span:12},{default:n(()=>[o($e)]),_:1}),o(c,{span:12},{default:n(()=>[o(we),o(Ce)]),_:1})]),_:1})):(i(),k(z,{key:1},{default:n(()=>[o(c,{span:24},{default:n(()=>[o($e),o(we),o(Ce)]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"])}}}),Xr={class:"box"},Qr=W({__name:"index",props:["modelValue"],setup(D){const d=ot(D.modelValue);It("order",d);const u=J(()=>{var _;return((_=d.product)==null?void 0:_.product_type)||"ssl"});It("productType",u);const{latest_cert:r}=Ke(d);It("cert",r);const l=(_=!1)=>{Re(d.id).then(()=>{dt(d.id).then(C=>{C.data.sync=ut(),Object.assign(d,ot(C.data)),_&&I("同步成功",{type:"success"})})})},c=(_=!1)=>{dt(d.id).then(C=>{C.data.sync=ut(),Object.assign(d,ot(C.data)),_&&I("刷新成功",{type:"success"})})};It("sync",l),It("get",c);let z=null;return pt(()=>{z=setInterval(()=>{c()},180*1e3)}),Ze(()=>{z!==null&&(clearInterval(z),z=null)}),(_,C)=>{const y=f("el-scrollbar");return i(),k(y,{class:"horizontal-scrollbar","wrap-class":"scroll-wrapper"},{default:n(()=>[e("div",Xr,[u.value==="ssl"?(i(),k(_e,{key:0})):u.value==="smime"?(i(),k($o,{key:1})):u.value==="codesign"?(i(),k(Pa,{key:2})):u.value==="docsign"?(i(),k(Jr,{key:3})):(i(),k(_e,{key:4}))])]),_:1})}}}),ti=X(Qr,[["__scopeId","data-v-86af38ad"]]),ei={class:"main"},li=W({name:"OrderDetails",__name:"details",setup(D){const s=O([]),d=()=>{const u=Mt.currentRoute.value.params.ids;u&&Be(u.toString()).then(r=>{s.value=r.data})};return pt(()=>{d()}),(u,r)=>(i(),b("div",ei,[(i(!0),b(st,null,Yt(s.value,(l,c)=>(i(),b("div",{key:c,class:"layout-main bg-bg_color"},[o(ti,{modelValue:s.value[c],"onUpdate:modelValue":z=>s.value[c]=z},null,8,["modelValue","onUpdate:modelValue"])]))),128))]))}}),vi=X(li,[["__scopeId","data-v-f4087d9b"]]);export{vi as default};
