var je=Object.defineProperty,Te=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var ie=(t,p,s)=>p in t?je(t,p,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[p]=s,Q=(t,p)=>{for(var s in p||(p={}))Ne.call(p,s)&&ie(t,s,p[s]);if(se)for(var s of se(p))qe.call(p,s)&&ie(t,s,p[s]);return t},de=(t,p)=>Te(t,Pe(p));import{k as R,bb as we,r as F,m as H,_ as te,D as ee,o as oe,h as W,c as V,e as d,v as D,y as M,f as c,w as v,A as U,F as w,G as Z,z as J,i as l,bc as ae,d as re,q as X,bd as Y,be as pe,aH as N,bf as Re,n as De,ao as z,bg as ve,bh as me,bi as ye,bj as le,B as ge,x as be,E,bk as ce,bl as fe,bm as L,j as he}from"./index-C2TQaEJO.js";import{p as _e}from"./utils-CdOSnC3M.js";import{u as Ve}from"./drawer-CZ5M8QL6.js";import{P as ke}from"./index-evieOSlK.js";import"./index-BnpBDtos.js";const Se={group_id:void 0,key:"",type:"string",is_multiple:!1,options:[],value:void 0,description:"",weight:0},ze=Object.keys(Se),Ae={name:"",title:"",description:"",weight:0},Je=Object.keys(Ae);function Me(){return R.request("get","/setting/config")}function Be(){return R.request("get","/setting")}function Le(t){return R.request("get",`/setting/group/${t}`)}function Ke(t){const p=t.map(s=>({id:s.id,value:we(s.value)||Array.isArray(s.value)?s.value:String(s.value)}));return R.request("put","/setting/batch-update",{data:{settings:p}})}function Ye(t){return R.request("get",`/setting-group/${t}`)}function He(t){return R.request("post","/setting-group",{data:t})}function Qe(t,p){return R.request("put",`/setting-group/${t}`,{data:p})}function We(t){return R.request("delete",`/setting-group/${t}`)}function Xe(t){return R.request("post","/setting",{data:t})}function Ze(t,p){return R.request("put",`/setting/${t}`,{data:p})}function el(t){return R.request("get",`/setting/${t}`)}function ll(t){return R.request("delete",`/setting/${t}`)}function tl(t){const p=F(!1),s=F(),g=F(0),a=F({}),b=[{label:"名称",prop:"name",valueType:"input",fieldProps:{placeholder:"请输入唯一名称（英文标识符）"}},{label:"标题",prop:"title",valueType:"input",fieldProps:{placeholder:"请输入组标题"}},{label:"描述",prop:"description",valueType:"input",fieldProps:{placeholder:"请输入组描述",type:"textarea",rows:3}},{label:"权重",prop:"weight",valueType:"input-number",fieldProps:{placeholder:"请输入权重",min:0,max:1e4,step:1,controlsPosition:"right"}}],_={name:[{required:!0,message:"请输入组名称",trigger:"blur"},{pattern:/^[a-z0-9_-]+$/i,message:"只能包含字母、数字、下划线和连字符",trigger:"blur"}],title:[{required:!0,message:"请输入组标题",trigger:"blur"}],weight:[{required:!0,message:"请输入权重",trigger:"blur"}]};function O(S=0){var T,n;p.value=!0,S>0?g.value!==S&&k(S):((n=(T=s.value)==null?void 0:T.formInstance)==null||n.resetFields(),a.value=Q({},Ae)),g.value=S}function x(){var S,T;(T=(S=s.value)==null?void 0:S.formInstance)==null||T.validate(n=>{n&&(g.value>0?$():y())})}function m(){p.value=!1}const k=S=>{Ye(S).then(({data:T})=>{a.value=_e(T,Je)})},y=()=>{He(a.value).then(()=>{H("添加成功",{type:"success"}),p.value=!1,t&&t()})},$=()=>{Qe(g.value,a.value).then(()=>{H("更新成功",{type:"success"}),p.value=!1,t&&t()})};return{groupFormRef:s,showGroupForm:p,groupId:g,groupValues:a,groupColumns:b,rules:_,openGroupForm:O,confirmGroupForm:x,closeGroupForm:m}}const al={class:"array-input"},ol={class:"array-input-header flex justify-between mb-2"},rl={class:"array-input-tabs"},ul={key:0},nl={key:1},sl={__name:"ArrayInput",props:{modelValue:{type:[Array,Object],default:()=>[]}},emits:["update:modelValue","change"],setup(t,{emit:p}){const s=t,g=p,a=F("array"),b=F([]),_=F([]),O=()=>{const n=s.modelValue;Array.isArray(n)?(a.value="array",b.value=[...n]):typeof n=="object"&&n!==null?(a.value="object",_.value=Object.keys(n).map(h=>({key:h,value:n[h]}))):(b.value=[],_.value=[])},x=()=>{g("update:modelValue",b.value),g("change",b.value)};let m=0;const k=()=>{const n={};_.value.forEach(h=>{const P=h.key.trim();P?n.hasOwnProperty(P)?(n[P+"_"+m]=h.value,m++):n[P]=h.value:(n["temp_"+m]=h.value,m++)}),g("update:modelValue",n),g("change",n)},y=()=>{b.value.push(""),x()},$=n=>{b.value.splice(n,1),x()},S=()=>{_.value.push({key:"",value:""}),k()},T=n=>{_.value.splice(n,1),k()};return ee(a,()=>{if(a.value==="array"){const n=s.modelValue;Array.isArray(n)?b.value=[...n]:typeof n=="object"&&n!==null&&(b.value=Object.values(n)),x()}else{const n=s.modelValue;typeof n=="object"&&!Array.isArray(n)&&n!==null?_.value=Object.keys(n).map(h=>({key:h,value:n[h]})):Array.isArray(n)&&(_.value=n.map((h,P)=>({key:String(P),value:h}))),k()}}),ee(()=>s.modelValue,n=>{n&&O()},{deep:!0}),oe(()=>{O()}),(n,h)=>{const P=W("el-radio-button"),e=W("el-radio-group"),i=W("el-input"),u=W("el-icon"),I=W("el-button");return d(),V("div",al,[D("div",ol,[D("div",rl,[c(e,{modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=C=>a.value=C),size:"small"},{default:v(()=>[c(P,{value:"array"},{default:v(()=>h[1]||(h[1]=[U("列表模式")])),_:1}),c(P,{value:"object"},{default:v(()=>h[2]||(h[2]=[U("键值对模式")])),_:1})]),_:1},8,["modelValue"])])]),a.value==="array"?(d(),V("div",ul,[(d(!0),V(w,null,Z(b.value,(C,G)=>(d(),V("div",{key:G,class:"array-item flex items-center mb-2"},[c(i,{modelValue:b.value[G],"onUpdate:modelValue":q=>b.value[G]=q,placeholder:`项目 ${G+1}`,onChange:x},{prepend:v(()=>[U(J(G+1),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),c(I,{type:"danger",size:"small",plain:"",class:"ml-2",onClick:q=>$(G)},{default:v(()=>[c(u,null,{default:v(()=>[c(l(ae))]),_:1})]),_:2},1032,["onClick"])]))),128)),c(I,{type:"primary",size:"small",plain:"",class:"mt-2",onClick:y},{default:v(()=>h[3]||(h[3]=[U(" 添加项目 ")])),_:1})])):a.value==="object"?(d(),V("div",nl,[(d(!0),V(w,null,Z(_.value,(C,G)=>(d(),V("div",{key:G,class:"object-item flex items-center mb-2 gap-2"},[c(i,{modelValue:_.value[G].key,"onUpdate:modelValue":q=>_.value[G].key=q,placeholder:"键名",style:{width:"40%"},onChange:k},null,8,["modelValue","onUpdate:modelValue"]),c(i,{modelValue:_.value[G].value,"onUpdate:modelValue":q=>_.value[G].value=q,placeholder:"值",style:{width:"60%"},onChange:k},null,8,["modelValue","onUpdate:modelValue"]),c(I,{type:"danger",size:"small",plain:"",onClick:q=>T(G)},{default:v(()=>[c(u,null,{default:v(()=>[c(l(ae))]),_:1})]),_:2},1032,["onClick"])]))),128)),c(I,{type:"primary",size:"small",plain:"",class:"mt-2",onClick:S},{default:v(()=>h[4]||(h[4]=[U(" 添加键值对 ")])),_:1})])):M("",!0)])}}},Ce=te(sl,[["__scopeId","data-v-bdd0fdb1"]]),il={class:"key-value-input"},dl={key:0,class:"mt-2 mb-2 text-gray-500"},pl=re({__name:"KeyValueInput",props:{modelValue:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:p}){const s=t,g=p,a=F([]);let b=0;const _=()=>{Array.isArray(s.modelValue)&&(a.value=s.modelValue.map(m=>{var k,y;return{label:(k=m==null?void 0:m.label)!=null?k:"",value:(y=m==null?void 0:m.value)!=null?y:"",id:b++}}))};ee(()=>s.modelValue,m=>{if(Array.isArray(m)){const k=a.value.map(y=>({label:y.label,value:y.value}));JSON.stringify(k)!==JSON.stringify(m)&&(a.value=m.map(y=>{var $,S;return{label:($=y==null?void 0:y.label)!=null?$:"",value:(S=y==null?void 0:y.value)!=null?S:"",id:b++}}))}},{deep:!0}),ee(a,m=>{const k=m.map(({label:y,value:$})=>({label:y,value:$}));g("update:modelValue",k),m.length===0&&!s.disabled&&De(()=>{O()})},{deep:!0});const O=()=>{a.value.push({label:"",value:"",id:b++})},x=m=>{a.value=a.value.filter(k=>k.id!==m)};return X(()=>a.value.some(m=>m.label.trim()===""||typeof m.value=="string"&&m.value.trim()==="")),a.value.length===0&&!s.disabled&&O(),_(),(m,k)=>(d(),V("div",il,[a.value.length===0?(d(),V("div",dl," 暂无选项 ")):M("",!0),(d(!0),V(w,null,Z(a.value,(y,$)=>(d(),V("div",{key:y.id,class:"item-row flex items-center gap-2 mb-2"},[c(l(pe),{prop:`options[${$}].label`,class:"flex-1 mb-0"},{default:v(()=>[c(l(Y),{modelValue:y.label,"onUpdate:modelValue":S=>y.label=S,placeholder:"标签 (Label)",disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),c(l(pe),{prop:`options[${$}].value`,class:"flex-1 mb-0"},{default:v(()=>[c(l(Y),{modelValue:y.value,"onUpdate:modelValue":S=>y.value=S,placeholder:"值 (Value)",disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),c(l(N),{type:"danger",icon:l(ae),circle:"",plain:"",disabled:t.disabled,onClick:S=>x(y.id)},null,8,["icon","disabled","onClick"])]))),128)),c(l(N),{type:"primary",icon:l(Re),plain:"",disabled:t.disabled,onClick:O},{default:v(()=>k[0]||(k[0]=[U(" 添加选项 ")])),_:1},8,["icon","disabled"])]))}}),cl=te(pl,[["__scopeId","data-v-b62221c0"]]);function fl(t){const p=F(!1),s=F(),g=F(0),a=F({}),b=F(!1),_=[{label:"键名",prop:"key",valueType:"input",fieldProps:{placeholder:"请输入键名",get disabled(){return b.value&&g.value>0}}},{label:"类型",prop:"type",valueType:"select",fieldProps:{placeholder:"请选择类型",get disabled(){return b.value&&g.value>0}},options:[{label:"字符串",value:"string"},{label:"整数",value:"integer"},{label:"浮点数",value:"float"},{label:"布尔值",value:"boolean"},{label:"数组",value:"array"},{label:"选择",value:"select"},{label:"文本",value:"base64"}],onChange:e=>h(e)},{label:"值",prop:"value",valueType:"input",fieldProps:{placeholder:"请输入值"},renderField:(e,i)=>{const u=a.value.type,I=a.value.is_multiple,C=a.value.options||[];if(!u)return null;const G=Array.isArray(C)?C:[];switch(u){case"string":return z(Y,{modelValue:e,"onUpdate:modelValue":i,placeholder:"请输入文本"});case"base64":return z(Y,{modelValue:e,"onUpdate:modelValue":i,placeholder:"请输入文本",type:"textarea",rows:3});case"integer":return z(le,{modelValue:e!==""?Number(e):0,"onUpdate:modelValue":j=>i(j!==void 0?String(j):"0"),placeholder:"请输入整数",precision:0,controls:!1,style:{width:"100%"}});case"float":return z(le,{modelValue:e!==""?Number(e):0,"onUpdate:modelValue":j=>i(j!==void 0?String(j):"0"),placeholder:"请输入浮点数",precision:2,controls:!1,style:{width:"100%"}});case"boolean":return z(ye,{modelValue:e==="1"||e==="true"||e===!0,"onUpdate:modelValue":j=>i(j?"1":"0"),activeValue:!0,inactiveValue:!1});case"array":return z(Ce,{modelValue:e||[],"onUpdate:modelValue":i});case"select":const q=I?Array.isArray(e)?e:[]:e;return z(me,{modelValue:q,"onUpdate:modelValue":j=>{i(j)},placeholder:`请选择${I?"(可多选)":""}`,multiple:I,filterable:!0,clearable:!0,style:{width:"100%"}},()=>G.map(j=>z(ve,{key:j.value,label:j.label,value:j.value})));default:return z(Y,{modelValue:e,"onUpdate:modelValue":i,placeholder:"请输入值"})}}},{label:"描述",prop:"description",valueType:"textarea",fieldProps:{placeholder:"请输入描述",rows:3,get disabled(){return b.value&&g.value>0}}},{label:"权重",prop:"weight",valueType:"input-number",fieldProps:{placeholder:"请输入权重",min:0,max:1e4,step:1,controlsPosition:"right",get disabled(){return b.value&&g.value>0}}},{label:"允许多选",prop:"is_multiple",valueType:"switch",initialValue:!1,hideInForm:X(()=>a.value.type!=="select"),fieldProps:{get disabled(){return b.value&&g.value>0}},onChange:e=>P(e)},{label:"选项配置",prop:"options",hideInForm:X(()=>a.value.type!=="select"),renderField:(e,i)=>{const u=Array.isArray(e)?e:[];return z(cl,{modelValue:u,"onUpdate:modelValue":i,get disabled(){return b.value&&g.value>0}})}}],O=(e,i,u)=>{if(a.value.type==="select"){if(!i||!Array.isArray(i)||i.length===0)return u(new Error("请至少配置一个选项"));let I=!1;for(const C of i)!C||typeof C!="object"||C.label!==void 0&&C.label!==null&&C.value!==void 0&&C.value!==null&&(I=!0);if(!I)return u(new Error("请至少配置一个有效的选项（标签和值都不能为空）"))}u()},x=(e,i,u)=>{if(a.value.type!=="select")return u();if(i==null)return u(new Error("请选择值"));u()},m=X(()=>{const e={key:[{required:!0,message:"请输入键名",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],value:[{required:!0,message:"请输入值",trigger:"blur"},{validator:x,trigger:["blur","change"]}],weight:[{required:!0,message:"请输入权重",trigger:"blur"}]};return a.value.type==="select"&&(e.options=[{validator:O,trigger:["change","blur"]}]),e});function k(e=0,i=null,u=!1){var I,C;p.value=!0,b.value=u,e>0?g.value!==e&&S(e):((C=(I=s.value)==null?void 0:I.formInstance)==null||C.resetFields(),a.value=de(Q({},Se),{is_multiple:!1,options:[],group_id:i})),g.value=e}function y(){var e,i;(i=(e=s.value)==null?void 0:e.formInstance)==null||i.validate(u=>{u&&(g.value>0?n():T())})}function $(){p.value=!1}const S=e=>{el(e).then(({data:i})=>{const u=_e(i,[...ze]);if(typeof u.options=="string")try{u.options=JSON.parse(u.options)}catch(I){u.options=[]}if(u.type==="select"&&u.is_multiple&&typeof u.value=="string")try{u.value=JSON.parse(u.value)}catch(I){u.value=[]}a.value=u})},T=()=>{const e=Q({},a.value);e.type!=="select"&&(delete e.is_multiple,delete e.options),Xe(e).then(()=>{H("添加成功",{type:"success"}),p.value=!1,t&&t()})},n=()=>{const e=Q({},a.value);e.type!=="select"&&(delete e.is_multiple,delete e.options),Ze(g.value,e).then(()=>{H("更新成功",{type:"success"}),p.value=!1,t&&t()})},h=e=>{switch(e){case"integer":a.value.value="0";break;case"float":a.value.value="0.0";break;case"boolean":a.value.value="0";break;case"array":a.value.value=[];break;case"select":a.value.value=a.value.is_multiple?[]:"";break;default:a.value.value=""}setTimeout(()=>{var i,u;(u=(i=s.value)==null?void 0:i.formInstance)==null||u.clearValidate("value")},0),e!=="select"&&(a.value.options=[],a.value.is_multiple=!1)},P=e=>{a.value.type==="select"&&(a.value.value=e?[]:"",setTimeout(()=>{var i,u;(u=(i=s.value)==null?void 0:i.formInstance)==null||u.clearValidate("value")},0))};return{storeRef:s,showStore:p,storeId:g,storeValues:a,storeColumns:_,rules:m,openStoreForm:k,confirmStoreForm:y,closeStoreForm:$}}const vl={class:"setting-group mb-4 rounded p-4"},ml={class:"group-header flex justify-between items-center mb-4"},yl={class:"group-title"},gl={class:"text-lg font-bold text-gray-600"},bl={class:"text-gray-500 mt-1"},hl={class:"group-actions flex gap-2"},_l={class:"settings-table"},Vl={key:1,class:"empty-settings text-center py-8"},kl=re({__name:"SettingGroup",props:{group:{type:Object,required:!0},config:{type:Object,default:()=>({locked:!1})},onRefresh:{type:Function,default:()=>{}}},emits:["edit-group","delete-group"],setup(t,{emit:p}){const s=t,g=p,{drawerSize:a}=Ve(),b=F(!1),_=F([]),O=F([]),x=F(!1),{storeRef:m,showStore:k,storeId:y,storeValues:$,storeColumns:S,rules:T,openStoreForm:n,confirmStoreForm:h,closeStoreForm:P}=fl(()=>e()),e=()=>{b.value=!0,Le(s.group.id).then(({data:f})=>{_.value=f.group.settings||[],_.value.forEach(o=>{if(o.type==="select"&&o.is_multiple&&typeof o.value=="string")try{o.value=JSON.parse(o.value)}catch(B){o.value=[]}if(o.type==="array"&&typeof o.value=="string")try{o.value=JSON.parse(o.value)}catch(B){o.value=[]}if(typeof o.options=="string")try{o.options=JSON.parse(o.options)}catch(B){o.options=[]}}),b.value=!1})},i=()=>{g("edit-group",s.group.id)},u=()=>{g("delete-group",s.group.id)},I=()=>{n(0,s.group.id)},C=f=>{n(f,null,s.config.locked)},G=f=>{ll(f).then(()=>{H("删除成功",{type:"success"}),e()})},q={string:"字符串",integer:"整数",float:"浮点数",boolean:"布尔值",array:"数组",select:"选择",base64:"文本"},j=f=>{if(Array.isArray(f))return f;if(typeof f=="string")try{const o=JSON.parse(f);return Array.isArray(o)?o:[]}catch(o){return[]}return[]},Ue=(f,o,B)=>{var r;return!Array.isArray(o)||o.length===0?f:B?j(f).map(ue=>{var ne;return((ne=o.find(Ge=>Ge.value===ue))==null?void 0:ne.label)||ue}).join(", "):((r=o.find(A=>A.value===f))==null?void 0:r.label)||f},xe=X(()=>{const f={};return x.value&&O.value.forEach(o=>{o.type==="select"&&(f[o.id]=Array.isArray(o.options)?o.options:[])}),f}),Ie=()=>{O.value=JSON.parse(JSON.stringify(_.value)),x.value=!0},Oe=()=>{O.value=[],x.value=!1},Fe=()=>{Ke(O.value).then(()=>{H("批量更新成功",{type:"success"}),x.value=!1,e()})},K=(f,o)=>{const B=O.value.findIndex(r=>r.id===f.id);B>-1&&(O.value[B].value=o)},$e=f=>f==="1"||f==="true"||f===!0?"是":"否",Ee=f=>{if(typeof f=="object"||Array.isArray(f))return JSON.stringify(f,null,2);if(typeof f=="string")try{const o=JSON.parse(f);return Array.isArray(o)?JSON.stringify(o,null,2):f}catch(o){return f}return String(f)};return oe(()=>{e()}),(f,o)=>{const B=ge("loading");return d(),V("div",vl,[D("div",ml,[D("div",yl,[D("h4",gl,J(t.group.title),1),D("p",bl,J(t.group.description),1)]),D("div",hl,[x.value?(d(),V(w,{key:1},[c(l(N),{type:"success",onClick:Fe},{default:v(()=>o[5]||(o[5]=[U("保存")])),_:1}),c(l(N),{onClick:Oe},{default:v(()=>o[6]||(o[6]=[U("取消")])),_:1})],64)):(d(),V(w,{key:0},[t.config.locked?M("",!0):(d(),E(l(N),{key:0,type:"primary",onClick:I},{default:v(()=>o[1]||(o[1]=[U("添加设置项")])),_:1})),t.config.locked?M("",!0):(d(),E(l(N),{key:1,type:"warning",onClick:i},{default:v(()=>o[2]||(o[2]=[U("编辑组")])),_:1})),t.config.locked?M("",!0):(d(),E(l(ce),{key:2,title:"确定要删除此设置组吗？这将同时删除组内所有设置项！",width:"300",onConfirm:u},{reference:v(()=>[c(l(N),{type:"danger"},{default:v(()=>o[3]||(o[3]=[U("删除组")])),_:1})]),_:1})),_.value.length>0?(d(),E(l(N),{key:3,type:"primary",plain:"",onClick:Ie},{default:v(()=>o[4]||(o[4]=[U(" 批量编辑 ")])),_:1})):M("",!0)],64))])]),be((d(),V("div",_l,[_.value.length>0?(d(),V(w,{key:0},[x.value?(d(),E(l(fe),{key:1,data:O.value,style:{width:"100%"}},{default:v(()=>[c(l(L),{prop:"key",label:"键名",width:"150"}),c(l(L),{prop:"type",label:"类型",width:"100"},{default:v(({row:r})=>[U(J(q[r.type]),1)]),_:1}),c(l(L),{prop:"value",label:"值","min-width":"200"},{default:v(({row:r})=>[r.type==="string"||r.type==="base64"?(d(),E(l(Y),{key:0,"model-value":r.value,type:r.type==="base64"?"textarea":"text",rows:r.type==="base64"?3:1,"onUpdate:modelValue":A=>K(r,A)},null,8,["model-value","type","rows","onUpdate:modelValue"])):r.type==="integer"?(d(),E(l(le),{key:1,"model-value":r.value!==""?Number(r.value):void 0,precision:0,controls:!1,style:{width:"100%"},"onUpdate:modelValue":A=>K(r,A!==void 0?String(A):"")},null,8,["model-value","onUpdate:modelValue"])):r.type==="float"?(d(),E(l(le),{key:2,"model-value":r.value!==""?Number(r.value):void 0,precision:2,controls:!1,style:{width:"100%"},"onUpdate:modelValue":A=>K(r,A!==void 0?String(A):"")},null,8,["model-value","onUpdate:modelValue"])):r.type==="boolean"?(d(),E(l(ye),{key:3,"model-value":r.value==="1"||r.value===!0,"active-value":!0,"inactive-value":!1,"onUpdate:modelValue":A=>K(r,A?"1":"0")},null,8,["model-value","onUpdate:modelValue"])):r.type==="array"?(d(),E(Ce,{key:4,"model-value":r.value,"onUpdate:modelValue":A=>K(r,A)},null,8,["model-value","onUpdate:modelValue"])):r.type==="select"?(d(),E(l(me),{key:5,"model-value":r.is_multiple?j(r.value):r.value,multiple:r.is_multiple,filterable:"",clearable:"",style:{width:"100%"},placeholder:`请选择${r.is_multiple?"(可多选)":""}`,"onUpdate:modelValue":A=>K(r,A)},{default:v(()=>[(d(!0),V(w,null,Z(xe.value[r.id],A=>(d(),E(l(ve),{key:A.value,label:A.label,value:A.value},null,8,["label","value"]))),128))]),_:2},1032,["model-value","multiple","placeholder","onUpdate:modelValue"])):(d(),E(l(Y),{key:6,"model-value":r.value,"onUpdate:modelValue":A=>K(r,A)},null,8,["model-value","onUpdate:modelValue"]))]),_:1}),c(l(L),{prop:"description",label:"描述","min-width":"100"})]),_:1},8,["data"])):(d(),E(l(fe),{key:0,data:_.value,style:{width:"100%"}},{default:v(()=>[c(l(L),{prop:"key",label:"键名",width:"150"}),c(l(L),{prop:"type",label:"类型",width:"100"},{default:v(({row:r})=>[U(J(q[r.type]),1)]),_:1}),c(l(L),{prop:"value",label:"值","min-width":"300"},{default:v(({row:r})=>[r.type==="boolean"?(d(),V(w,{key:0},[U(J($e(r.value)),1)],64)):r.type==="array"?(d(),V(w,{key:1},[U(J(Ee(r.value)),1)],64)):r.type==="select"?(d(),V(w,{key:2},[U(J(Ue(r.value,r.options,r.is_multiple)),1)],64)):(d(),V(w,{key:3},[U(J(String(r.value).slice(0,200))+" "+J(String(r.value).length>200?" ...":""),1)],64))]),_:1}),c(l(L),{prop:"description",label:"描述","min-width":"100"}),c(l(L),{label:"操作",width:t.config.locked?70:110,fixed:"right"},{default:v(({row:r})=>[c(l(N),{type:"primary",link:"",onClick:A=>C(r.id)},{default:v(()=>o[7]||(o[7]=[U(" 编辑 ")])),_:2},1032,["onClick"]),t.config.locked?M("",!0):(d(),E(l(ce),{key:0,title:"确定要删除此设置项吗？",width:"200",onConfirm:A=>G(r.id)},{reference:v(()=>[c(l(N),{type:"danger",link:""},{default:v(()=>o[8]||(o[8]=[U("删除")])),_:1})]),_:2},1032,["onConfirm"]))]),_:1},8,["width"])]),_:1},8,["data"]))],64)):(d(),V("div",Vl,[o[10]||(o[10]=D("p",{class:"text-gray-500 mb-4"},"此组暂无设置项",-1)),t.config.locked?M("",!0):(d(),E(l(N),{key:0,type:"primary",onClick:I},{default:v(()=>o[9]||(o[9]=[U("添加设置项")])),_:1}))]))])),[[B,b.value]]),c(l(ke),{ref_key:"storeRef",ref:m,modelValue:l($),"onUpdate:modelValue":o[0]||(o[0]=r=>he($)?$.value=r:null),visible:l(k),form:{columns:l(S),rules:l(T),labelPosition:"right",labelSuffix:""},size:l(a),closeOnClickModal:!0,title:l(y)>0?"编辑设置项":"新增设置项",confirmText:"提交",cancelText:"取消",onConfirm:l(h),onCancel:l(P)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"])])}}}),Sl=te(kl,[["__scopeId","data-v-263baa83"]]),Al={class:"main"},Cl={class:"setting-header bg-bg_color w-full p-4 mb-4 flex justify-between items-center"},Ul={class:"setting-groups"},xl={key:1,class:"empty-groups text-center py-8 bg-bg_color rounded"},Il=re({name:"Setting",__name:"index",setup(t){const{drawerSize:p}=Ve(),s=F(!1),g=F([]),a=F({locked:!1}),{groupFormRef:b,showGroupForm:_,groupId:O,groupValues:x,groupColumns:m,rules:k,openGroupForm:y,confirmGroupForm:$,closeGroupForm:S}=tl(()=>n()),T=()=>{Me().then(({data:i})=>{a.value=i})},n=()=>{s.value=!0,Be().then(({data:i})=>{g.value=i.groups||[],s.value=!1})},h=()=>{y(0)},P=i=>{y(i)},e=i=>{We(i).then(()=>{H("删除成功",{type:"success"}),n()})};return oe(()=>{T(),n()}),(i,u)=>{const I=ge("loading");return d(),V("div",Al,[D("div",Cl,[u[2]||(u[2]=D("h3",{class:"text-xl font-bold text-gray-600"},"系统设置",-1)),a.value.locked?M("",!0):(d(),E(l(N),{key:0,type:"primary",onClick:h},{default:v(()=>u[1]||(u[1]=[U("添加设置组")])),_:1}))]),be((d(),V("div",Ul,[g.value.length>0?(d(!0),V(w,{key:0},Z(g.value,C=>(d(),E(Sl,{key:C.id,group:C,config:a.value,onRefresh:n,onEditGroup:P,onDeleteGroup:e},null,8,["group","config"]))),128)):(d(),V("div",xl,[u[4]||(u[4]=D("p",{class:"text-gray-500 mb-4"},"暂无设置组",-1)),a.value.locked?M("",!0):(d(),E(l(N),{key:0,type:"primary",onClick:h},{default:v(()=>u[3]||(u[3]=[U("添加设置组")])),_:1}))]))])),[[I,s.value]]),c(l(ke),{ref_key:"groupFormRef",ref:b,modelValue:l(x),"onUpdate:modelValue":u[0]||(u[0]=C=>he(x)?x.value=C:null),visible:l(_),form:{columns:l(m),rules:l(k),labelPosition:"right",labelSuffix:""},size:l(p),closeOnClickModal:!0,title:l(O)>0?"编辑设置组":"新增设置组",confirmText:"提交",cancelText:"取消",onConfirm:l($),onCancel:l(S)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"])])}}}),Tl=te(Il,[["__scopeId","data-v-660c2001"]]);export{Tl as default};
