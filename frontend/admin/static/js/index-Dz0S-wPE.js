var je=Object.defineProperty,Te=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var de=(t,p,s)=>p in t?je(t,p,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[p]=s,Q=(t,p)=>{for(var s in p||(p={}))qe.call(p,s)&&de(t,s,p[s]);if(ie)for(var s of ie(p))Ne.call(p,s)&&de(t,s,p[s]);return t},pe=(t,p)=>Te(t,Pe(p));import{K as N,be as we,r as $,m as K,_ as te,F as ee,o as re,f as W,g as k,i,y as D,A as M,j as c,w as f,D as U,H as R,I as Z,C as J,u as e,bf as ae,e as ue,n as Re,q as X,bg as H,bh as ce,aL as q,bi as De,L as z,bj as ve,bk as me,bl as ye,bm as le,x as ge,z as be,G,bn as oe,bo as fe,bp as L,k as he}from"./index-2C-ofHV5.js";import{p as _e}from"./utils-C-gUDCcE.js";import{u as Ve}from"./drawer-BlMYOobw.js";import{P as ke}from"./index-DtDmFput.js";import"./index-CaJyLCRQ.js";const Se={group_id:void 0,key:"",type:"string",is_multiple:!1,options:[],value:void 0,description:"",weight:0},ze=Object.keys(Se),Ae={name:"",title:"",description:"",weight:0},Je=Object.keys(Ae);function Me(){return N.request("get","/setting/config")}function Be(){return N.request("get","/setting")}function Le(t){return N.request("get",`/setting/group/${t}`)}function Ke(t){const p=t.map(s=>({id:s.id,value:we(s.value)||Array.isArray(s.value)?s.value:String(s.value)}));return N.request("put","/setting/batch-update",{data:{settings:p}})}function Ye(t){return N.request("get",`/setting-group/${t}`)}function He(t){return N.request("post","/setting-group",{data:t})}function Qe(t,p){return N.request("put",`/setting-group/${t}`,{data:p})}function We(t){return N.request("delete",`/setting-group/${t}`)}function Xe(t){return N.request("post","/setting",{data:t})}function Ze(t,p){return N.request("put",`/setting/${t}`,{data:p})}function el(t){return N.request("get",`/setting/${t}`)}function ll(t){return N.request("delete",`/setting/${t}`)}function tl(){return N.request("post","/setting/clear-cache")}function al(t){const p=$(!1),s=$(),b=$(0),a=$({}),h=[{label:"名称",prop:"name",valueType:"input",fieldProps:{placeholder:"请输入唯一名称（英文标识符）"}},{label:"标题",prop:"title",valueType:"input",fieldProps:{placeholder:"请输入组标题"}},{label:"描述",prop:"description",valueType:"input",fieldProps:{placeholder:"请输入组描述",type:"textarea",rows:3}},{label:"权重",prop:"weight",valueType:"input-number",fieldProps:{placeholder:"请输入权重",min:0,max:1e4,step:1,controlsPosition:"right"}}],V={name:[{required:!0,message:"请输入组名称",trigger:"blur"},{pattern:/^[a-z0-9_-]+$/i,message:"只能包含字母、数字、下划线和连字符",trigger:"blur"}],title:[{required:!0,message:"请输入组标题",trigger:"blur"}],weight:[{required:!0,message:"请输入权重",trigger:"blur"}]};function O(A=0){var T,u;p.value=!0,A>0?b.value!==A&&S(A):((u=(T=s.value)==null?void 0:T.formInstance)==null||u.resetFields(),a.value=Q({},Ae)),b.value=A}function I(){var A,T;(T=(A=s.value)==null?void 0:A.formInstance)==null||T.validate(u=>{u&&(b.value>0?E():y())})}function m(){p.value=!1}const S=A=>{Ye(A).then(({data:T})=>{a.value=_e(T,Je)})},y=()=>{He(a.value).then(()=>{K("添加成功",{type:"success"}),p.value=!1,t&&t()})},E=()=>{Qe(b.value,a.value).then(()=>{K("更新成功",{type:"success"}),p.value=!1,t&&t()})};return{groupFormRef:s,showGroupForm:p,groupId:b,groupValues:a,groupColumns:h,rules:V,openGroupForm:O,confirmGroupForm:I,closeGroupForm:m}}const ol={class:"array-input"},rl={class:"array-input-header flex justify-between mb-2"},ul={class:"array-input-tabs"},nl={key:0},sl={key:1},il={__name:"ArrayInput",props:{modelValue:{type:[Array,Object],default:()=>[]}},emits:["update:modelValue","change"],setup(t,{emit:p}){const s=t,b=p,a=$("array"),h=$([]),V=$([]),O=()=>{const u=s.modelValue;Array.isArray(u)?(a.value="array",h.value=[...u]):typeof u=="object"&&u!==null?(a.value="object",V.value=Object.keys(u).map(_=>({key:_,value:u[_]}))):(h.value=[],V.value=[])},I=()=>{b("update:modelValue",h.value),b("change",h.value)};let m=0;const S=()=>{const u={};V.value.forEach(_=>{const P=_.key.trim();P?u.hasOwnProperty(P)?(u[P+"_"+m]=_.value,m++):u[P]=_.value:(u["temp_"+m]=_.value,m++)}),b("update:modelValue",u),b("change",u)},y=()=>{h.value.push(""),I()},E=u=>{h.value.splice(u,1),I()},A=()=>{V.value.push({key:"",value:""}),S()},T=u=>{V.value.splice(u,1),S()};return ee(a,()=>{if(a.value==="array"){const u=s.modelValue;Array.isArray(u)?h.value=[...u]:typeof u=="object"&&u!==null&&(h.value=Object.values(u)),I()}else{const u=s.modelValue;typeof u=="object"&&!Array.isArray(u)&&u!==null?V.value=Object.keys(u).map(_=>({key:_,value:u[_]})):Array.isArray(u)&&(V.value=u.map((_,P)=>({key:String(P),value:_}))),S()}}),ee(()=>s.modelValue,u=>{u&&O()},{deep:!0}),re(()=>{O()}),(u,_)=>{const P=W("el-radio-button"),l=W("el-radio-group"),d=W("el-input"),n=W("el-icon"),g=W("el-button");return i(),k("div",ol,[D("div",rl,[D("div",ul,[c(l,{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=F=>a.value=F),size:"small"},{default:f(()=>[c(P,{value:"array"},{default:f(()=>[..._[1]||(_[1]=[U("列表模式",-1)])]),_:1}),c(P,{value:"object"},{default:f(()=>[..._[2]||(_[2]=[U("键值对模式",-1)])]),_:1})]),_:1},8,["modelValue"])])]),a.value==="array"?(i(),k("div",nl,[(i(!0),k(R,null,Z(h.value,(F,x)=>(i(),k("div",{key:x,class:"array-item flex items-center mb-2"},[c(d,{modelValue:h.value[x],"onUpdate:modelValue":w=>h.value[x]=w,placeholder:`项目 ${x+1}`,onChange:I},{prepend:f(()=>[U(J(x+1),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),c(g,{type:"danger",size:"small",plain:"",class:"ml-2",onClick:w=>E(x)},{default:f(()=>[c(n,null,{default:f(()=>[c(e(ae))]),_:1})]),_:1},8,["onClick"])]))),128)),c(g,{type:"primary",size:"small",plain:"",class:"mt-2",onClick:y},{default:f(()=>[..._[3]||(_[3]=[U(" 添加项目 ",-1)])]),_:1})])):a.value==="object"?(i(),k("div",sl,[(i(!0),k(R,null,Z(V.value,(F,x)=>(i(),k("div",{key:x,class:"object-item flex items-center mb-2 gap-2"},[c(d,{modelValue:V.value[x].key,"onUpdate:modelValue":w=>V.value[x].key=w,placeholder:"键名",style:{width:"40%"},onChange:S},null,8,["modelValue","onUpdate:modelValue"]),c(d,{modelValue:V.value[x].value,"onUpdate:modelValue":w=>V.value[x].value=w,placeholder:"值",style:{width:"60%"},onChange:S},null,8,["modelValue","onUpdate:modelValue"]),c(g,{type:"danger",size:"small",plain:"",onClick:w=>T(x)},{default:f(()=>[c(n,null,{default:f(()=>[c(e(ae))]),_:1})]),_:1},8,["onClick"])]))),128)),c(g,{type:"primary",size:"small",plain:"",class:"mt-2",onClick:A},{default:f(()=>[..._[4]||(_[4]=[U(" 添加键值对 ",-1)])]),_:1})])):M("",!0)])}}},Ce=te(il,[["__scopeId","data-v-bdd0fdb1"]]),dl={class:"key-value-input"},pl={key:0,class:"mt-2 mb-2 text-gray-500"},cl=ue({__name:"KeyValueInput",props:{modelValue:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:p}){const s=t,b=p,a=$([]);let h=0;const V=()=>{Array.isArray(s.modelValue)&&(a.value=s.modelValue.map(m=>{var S,y;return{label:(S=m==null?void 0:m.label)!=null?S:"",value:(y=m==null?void 0:m.value)!=null?y:"",id:h++}}))};ee(()=>s.modelValue,m=>{if(Array.isArray(m)){const S=a.value.map(y=>({label:y.label,value:y.value}));JSON.stringify(S)!==JSON.stringify(m)&&(a.value=m.map(y=>{var E,A;return{label:(E=y==null?void 0:y.label)!=null?E:"",value:(A=y==null?void 0:y.value)!=null?A:"",id:h++}}))}},{deep:!0}),ee(a,m=>{const S=m.map(({label:y,value:E})=>({label:y,value:E}));b("update:modelValue",S),m.length===0&&!s.disabled&&Re(()=>{O()})},{deep:!0});const O=()=>{a.value.push({label:"",value:"",id:h++})},I=m=>{a.value=a.value.filter(S=>S.id!==m)};return X(()=>a.value.some(m=>m.label.trim()===""||typeof m.value=="string"&&m.value.trim()==="")),a.value.length===0&&!s.disabled&&O(),V(),(m,S)=>(i(),k("div",dl,[a.value.length===0?(i(),k("div",pl," 暂无选项 ")):M("",!0),(i(!0),k(R,null,Z(a.value,(y,E)=>(i(),k("div",{key:y.id,class:"item-row flex items-center gap-2 mb-2"},[c(e(ce),{prop:`options[${E}].label`,class:"flex-1 mb-0"},{default:f(()=>[c(e(H),{modelValue:y.label,"onUpdate:modelValue":A=>y.label=A,placeholder:"标签 (Label)",disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),c(e(ce),{prop:`options[${E}].value`,class:"flex-1 mb-0"},{default:f(()=>[c(e(H),{modelValue:y.value,"onUpdate:modelValue":A=>y.value=A,placeholder:"值 (Value)",disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),c(e(q),{type:"danger",icon:e(ae),circle:"",plain:"",disabled:t.disabled,onClick:A=>I(y.id)},null,8,["icon","disabled","onClick"])]))),128)),c(e(q),{type:"primary",icon:e(De),plain:"",disabled:t.disabled,onClick:O},{default:f(()=>[...S[0]||(S[0]=[U(" 添加选项 ",-1)])]),_:1},8,["icon","disabled"])]))}}),fl=te(cl,[["__scopeId","data-v-b62221c0"]]);function vl(t){const p=$(!1),s=$(),b=$(0),a=$({}),h=$(!1),V=[{label:"键名",prop:"key",valueType:"input",fieldProps:{placeholder:"请输入键名",get disabled(){return h.value&&b.value>0}}},{label:"类型",prop:"type",valueType:"select",fieldProps:{placeholder:"请选择类型",get disabled(){return h.value&&b.value>0}},options:[{label:"字符串",value:"string"},{label:"整数",value:"integer"},{label:"浮点数",value:"float"},{label:"布尔值",value:"boolean"},{label:"数组",value:"array"},{label:"选择",value:"select"},{label:"文本",value:"base64"}],onChange:l=>_(l)},{label:"值",prop:"value",valueType:"input",fieldProps:{placeholder:"请输入值"},renderField:(l,d)=>{const n=a.value.type,g=a.value.is_multiple,F=a.value.options||[];if(!n)return null;const x=Array.isArray(F)?F:[];switch(n){case"string":return z(H,{modelValue:l,"onUpdate:modelValue":d,placeholder:"请输入文本"});case"base64":return z(H,{modelValue:l,"onUpdate:modelValue":d,placeholder:"请输入文本",type:"textarea",rows:3});case"integer":return z(le,{modelValue:l!==""?Number(l):0,"onUpdate:modelValue":j=>d(j!==void 0?String(j):"0"),placeholder:"请输入整数",precision:0,controls:!1,style:{width:"100%"}});case"float":return z(le,{modelValue:l!==""?Number(l):0,"onUpdate:modelValue":j=>d(j!==void 0?String(j):"0"),placeholder:"请输入浮点数",precision:2,controls:!1,style:{width:"100%"}});case"boolean":return z(ye,{modelValue:l==="1"||l==="true"||l===!0,"onUpdate:modelValue":j=>d(j?"1":"0"),activeValue:!0,inactiveValue:!1});case"array":return z(Ce,{modelValue:l||[],"onUpdate:modelValue":d});case"select":const w=g?Array.isArray(l)?l:[]:l;return z(me,{modelValue:w,"onUpdate:modelValue":j=>{d(j)},placeholder:`请选择${g?"(可多选)":""}`,multiple:g,filterable:!0,clearable:!0,style:{width:"100%"}},()=>x.map(j=>z(ve,{key:j.value,label:j.label,value:j.value})));default:return z(H,{modelValue:l,"onUpdate:modelValue":d,placeholder:"请输入值"})}}},{label:"描述",prop:"description",valueType:"textarea",fieldProps:{placeholder:"请输入描述",rows:3,get disabled(){return h.value&&b.value>0}}},{label:"权重",prop:"weight",valueType:"input-number",fieldProps:{placeholder:"请输入权重",min:0,max:1e4,step:1,controlsPosition:"right",get disabled(){return h.value&&b.value>0}}},{label:"允许多选",prop:"is_multiple",valueType:"switch",initialValue:!1,hideInForm:X(()=>a.value.type!=="select"),fieldProps:{get disabled(){return h.value&&b.value>0}},onChange:l=>P(l)},{label:"选项配置",prop:"options",hideInForm:X(()=>a.value.type!=="select"),renderField:(l,d)=>{const n=Array.isArray(l)?l:[];return z(fl,{modelValue:n,"onUpdate:modelValue":d,get disabled(){return h.value&&b.value>0}})}}],O=(l,d,n)=>{if(a.value.type==="select"){if(!d||!Array.isArray(d)||d.length===0)return n(new Error("请至少配置一个选项"));let g=!1;for(const F of d)!F||typeof F!="object"||F.label!==void 0&&F.label!==null&&F.value!==void 0&&F.value!==null&&(g=!0);if(!g)return n(new Error("请至少配置一个有效的选项（标签和值都不能为空）"))}n()},I=(l,d,n)=>{if(a.value.type!=="select")return n();if(d==null)return n(new Error("请选择值"));n()},m=X(()=>{const l={key:[{required:!0,message:"请输入键名",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],value:[{required:!0,message:"请输入值",trigger:"blur"},{validator:I,trigger:["blur","change"]}],weight:[{required:!0,message:"请输入权重",trigger:"blur"}]};return a.value.type==="select"&&(l.options=[{validator:O,trigger:["change","blur"]}]),l});function S(l=0,d=null,n=!1){var g,F;p.value=!0,h.value=n,l>0?b.value!==l&&A(l):((F=(g=s.value)==null?void 0:g.formInstance)==null||F.resetFields(),a.value=pe(Q({},Se),{is_multiple:!1,options:[],group_id:d})),b.value=l}function y(){var l,d;(d=(l=s.value)==null?void 0:l.formInstance)==null||d.validate(n=>{n&&(b.value>0?u():T())})}function E(){p.value=!1}const A=l=>{el(l).then(({data:d})=>{const n=_e(d,[...ze]);if(typeof n.options=="string")try{n.options=JSON.parse(n.options)}catch(g){n.options=[]}if(n.type==="select"&&n.is_multiple&&typeof n.value=="string")try{n.value=JSON.parse(n.value)}catch(g){n.value=[]}a.value=n})},T=()=>{const l=Q({},a.value);l.type!=="select"&&(delete l.is_multiple,delete l.options),Xe(l).then(()=>{K("添加成功",{type:"success"}),p.value=!1,t&&t()})},u=()=>{const l=Q({},a.value);l.type!=="select"&&(delete l.is_multiple,delete l.options),Ze(b.value,l).then(()=>{K("更新成功",{type:"success"}),p.value=!1,t&&t()})},_=l=>{switch(l){case"integer":a.value.value="0";break;case"float":a.value.value="0.0";break;case"boolean":a.value.value="0";break;case"array":a.value.value=[];break;case"select":a.value.value=a.value.is_multiple?[]:"";break;default:a.value.value=""}setTimeout(()=>{var d,n;(n=(d=s.value)==null?void 0:d.formInstance)==null||n.clearValidate("value")},0),l!=="select"&&(a.value.options=[],a.value.is_multiple=!1)},P=l=>{a.value.type==="select"&&(a.value.value=l?[]:"",setTimeout(()=>{var d,n;(n=(d=s.value)==null?void 0:d.formInstance)==null||n.clearValidate("value")},0))};return{storeRef:s,showStore:p,storeId:b,storeValues:a,storeColumns:V,rules:m,openStoreForm:S,confirmStoreForm:y,closeStoreForm:E}}const ml={class:"setting-group mb-4 rounded p-4"},yl={class:"group-header flex justify-between items-center mb-4"},gl={class:"group-title"},bl={class:"text-lg font-bold text-gray-600"},hl={class:"text-gray-500 mt-1"},_l={class:"group-actions flex gap-2"},Vl={class:"settings-table"},kl={key:1,class:"empty-settings text-center py-8"},Sl=ue({__name:"SettingGroup",props:{group:{type:Object,required:!0},config:{type:Object,default:()=>({locked:!1})},onRefresh:{type:Function,default:()=>{}}},emits:["edit-group","delete-group"],setup(t,{emit:p}){const s=t,b=p,{drawerSize:a}=Ve(),h=$(!1),V=$([]),O=$([]),I=$(!1),{storeRef:m,showStore:S,storeId:y,storeValues:E,storeColumns:A,rules:T,openStoreForm:u,confirmStoreForm:_,closeStoreForm:P}=vl(()=>l()),l=()=>{h.value=!0,Le(s.group.id).then(({data:v})=>{V.value=v.group.settings||[],V.value.forEach(o=>{if(o.type==="select"&&o.is_multiple&&typeof o.value=="string")try{o.value=JSON.parse(o.value)}catch(B){o.value=[]}if(o.type==="array"&&typeof o.value=="string")try{o.value=JSON.parse(o.value)}catch(B){o.value=[]}if(typeof o.options=="string")try{o.options=JSON.parse(o.options)}catch(B){o.options=[]}}),h.value=!1})},d=()=>{b("edit-group",s.group.id)},n=()=>{b("delete-group",s.group.id)},g=()=>{u(0,s.group.id)},F=v=>{u(v,null,s.config.locked)},x=v=>{ll(v).then(()=>{K("删除成功",{type:"success"}),l()})},w={string:"字符串",integer:"整数",float:"浮点数",boolean:"布尔值",array:"数组",select:"选择",base64:"文本"},j=v=>{if(Array.isArray(v))return v;if(typeof v=="string")try{const o=JSON.parse(v);return Array.isArray(o)?o:[]}catch(o){return[]}return[]},Ue=(v,o,B)=>{var r;return!Array.isArray(o)||o.length===0?v:B?j(v).map(ne=>{var se;return((se=o.find(Ge=>Ge.value===ne))==null?void 0:se.label)||ne}).join(", "):((r=o.find(C=>C.value===v))==null?void 0:r.label)||v},xe=X(()=>{const v={};return I.value&&O.value.forEach(o=>{o.type==="select"&&(v[o.id]=Array.isArray(o.options)?o.options:[])}),v}),Ie=()=>{O.value=JSON.parse(JSON.stringify(V.value)),I.value=!0},Oe=()=>{O.value=[],I.value=!1},Fe=()=>{Ke(O.value).then(()=>{K("批量更新成功",{type:"success"}),I.value=!1,l()})},Y=(v,o)=>{const B=O.value.findIndex(r=>r.id===v.id);B>-1&&(O.value[B].value=o)},$e=v=>v==="1"||v==="true"||v===!0?"是":"否",Ee=v=>{if(typeof v=="object"||Array.isArray(v))return JSON.stringify(v,null,2);if(typeof v=="string")try{const o=JSON.parse(v);return Array.isArray(o)?JSON.stringify(o,null,2):v}catch(o){return v}return String(v)};return re(()=>{l()}),(v,o)=>{const B=ge("loading");return i(),k("div",ml,[D("div",yl,[D("div",gl,[D("h4",bl,J(t.group.title),1),D("p",hl,J(t.group.description),1)]),D("div",_l,[I.value?(i(),k(R,{key:1},[c(e(q),{type:"success",onClick:Fe},{default:f(()=>[...o[5]||(o[5]=[U("保存",-1)])]),_:1}),c(e(q),{onClick:Oe},{default:f(()=>[...o[6]||(o[6]=[U("取消",-1)])]),_:1})],64)):(i(),k(R,{key:0},[t.config.locked?M("",!0):(i(),G(e(q),{key:0,type:"primary",onClick:g},{default:f(()=>[...o[1]||(o[1]=[U("添加设置项",-1)])]),_:1})),t.config.locked?M("",!0):(i(),G(e(q),{key:1,type:"warning",onClick:d},{default:f(()=>[...o[2]||(o[2]=[U("编辑组",-1)])]),_:1})),t.config.locked?M("",!0):(i(),G(e(oe),{key:2,title:"确定要删除此设置组吗？这将同时删除组内所有设置项！",width:"300",onConfirm:n},{reference:f(()=>[c(e(q),{type:"danger"},{default:f(()=>[...o[3]||(o[3]=[U("删除组",-1)])]),_:1})]),_:1})),V.value.length>0?(i(),G(e(q),{key:3,type:"primary",plain:"",onClick:Ie},{default:f(()=>[...o[4]||(o[4]=[U(" 批量编辑 ",-1)])]),_:1})):M("",!0)],64))])]),be((i(),k("div",Vl,[V.value.length>0?(i(),k(R,{key:0},[I.value?(i(),G(e(fe),{key:1,data:O.value,style:{width:"100%"}},{default:f(()=>[c(e(L),{prop:"key",label:"键名",width:"150"}),c(e(L),{prop:"type",label:"类型",width:"100"},{default:f(({row:r})=>[U(J(w[r.type]),1)]),_:1}),c(e(L),{prop:"value",label:"值","min-width":"200"},{default:f(({row:r})=>[r.type==="string"||r.type==="base64"?(i(),G(e(H),{key:0,"model-value":r.value,type:r.type==="base64"?"textarea":"text",rows:r.type==="base64"?3:1,"onUpdate:modelValue":C=>Y(r,C)},null,8,["model-value","type","rows","onUpdate:modelValue"])):r.type==="integer"?(i(),G(e(le),{key:1,"model-value":r.value!==""?Number(r.value):void 0,precision:0,controls:!1,style:{width:"100%"},"onUpdate:modelValue":C=>Y(r,C!==void 0?String(C):"")},null,8,["model-value","onUpdate:modelValue"])):r.type==="float"?(i(),G(e(le),{key:2,"model-value":r.value!==""?Number(r.value):void 0,precision:2,controls:!1,style:{width:"100%"},"onUpdate:modelValue":C=>Y(r,C!==void 0?String(C):"")},null,8,["model-value","onUpdate:modelValue"])):r.type==="boolean"?(i(),G(e(ye),{key:3,"model-value":r.value==="1"||r.value===!0,"active-value":!0,"inactive-value":!1,"onUpdate:modelValue":C=>Y(r,C?"1":"0")},null,8,["model-value","onUpdate:modelValue"])):r.type==="array"?(i(),G(Ce,{key:4,"model-value":r.value,"onUpdate:modelValue":C=>Y(r,C)},null,8,["model-value","onUpdate:modelValue"])):r.type==="select"?(i(),G(e(me),{key:5,"model-value":r.is_multiple?j(r.value):r.value,multiple:r.is_multiple,filterable:"",clearable:"",style:{width:"100%"},placeholder:`请选择${r.is_multiple?"(可多选)":""}`,"onUpdate:modelValue":C=>Y(r,C)},{default:f(()=>[(i(!0),k(R,null,Z(xe.value[r.id],C=>(i(),G(e(ve),{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:2},1032,["model-value","multiple","placeholder","onUpdate:modelValue"])):(i(),G(e(H),{key:6,"model-value":r.value,"onUpdate:modelValue":C=>Y(r,C)},null,8,["model-value","onUpdate:modelValue"]))]),_:1}),c(e(L),{prop:"description",label:"描述","min-width":"100"})]),_:1},8,["data"])):(i(),G(e(fe),{key:0,data:V.value,style:{width:"100%"}},{default:f(()=>[c(e(L),{prop:"key",label:"键名",width:"150"}),c(e(L),{prop:"type",label:"类型",width:"100"},{default:f(({row:r})=>[U(J(w[r.type]),1)]),_:1}),c(e(L),{prop:"value",label:"值","min-width":"300"},{default:f(({row:r})=>[r.type==="boolean"?(i(),k(R,{key:0},[U(J($e(r.value)),1)],64)):r.type==="array"?(i(),k(R,{key:1},[U(J(Ee(r.value)),1)],64)):r.type==="select"?(i(),k(R,{key:2},[U(J(Ue(r.value,r.options,r.is_multiple)),1)],64)):(i(),k(R,{key:3},[U(J(String(r.value).slice(0,200))+" "+J(String(r.value).length>200?" ...":""),1)],64))]),_:1}),c(e(L),{prop:"description",label:"描述","min-width":"100"}),c(e(L),{label:"操作",width:t.config.locked?70:110,fixed:"right"},{default:f(({row:r})=>[c(e(q),{type:"primary",link:"",onClick:C=>F(r.id)},{default:f(()=>[...o[7]||(o[7]=[U(" 编辑 ",-1)])]),_:1},8,["onClick"]),t.config.locked?M("",!0):(i(),G(e(oe),{key:0,title:"确定要删除此设置项吗？",width:"200",onConfirm:C=>x(r.id)},{reference:f(()=>[c(e(q),{type:"danger",link:""},{default:f(()=>[...o[8]||(o[8]=[U("删除",-1)])]),_:1})]),_:1},8,["onConfirm"]))]),_:1},8,["width"])]),_:1},8,["data"]))],64)):(i(),k("div",kl,[o[10]||(o[10]=D("p",{class:"text-gray-500 mb-4"},"此组暂无设置项",-1)),t.config.locked?M("",!0):(i(),G(e(q),{key:0,type:"primary",onClick:g},{default:f(()=>[...o[9]||(o[9]=[U("添加设置项",-1)])]),_:1}))]))])),[[B,h.value]]),c(e(ke),{ref_key:"storeRef",ref:m,modelValue:e(E),"onUpdate:modelValue":o[0]||(o[0]=r=>he(E)?E.value=r:null),visible:e(S),form:{columns:e(A),rules:e(T),labelPosition:"right",labelSuffix:""},size:e(a),closeOnClickModal:!0,title:e(y)>0?"编辑设置项":"新增设置项",confirmText:"提交",cancelText:"取消",onConfirm:e(_),onCancel:e(P)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"])])}}}),Al=te(Sl,[["__scopeId","data-v-700afa02"]]),Cl={class:"main"},Ul={class:"setting-header bg-bg_color w-full p-4 mb-4 flex justify-between items-center"},xl={class:"flex gap-2"},Il={class:"setting-groups"},Ol={key:1,class:"empty-groups text-center py-8 bg-bg_color rounded"},Fl=ue({name:"Setting",__name:"index",setup(t){const{drawerSize:p}=Ve(),s=$(!1),b=$([]),a=$({locked:!1}),{groupFormRef:h,showGroupForm:V,groupId:O,groupValues:I,groupColumns:m,rules:S,openGroupForm:y,confirmGroupForm:E,closeGroupForm:A}=al(()=>u()),T=()=>{Me().then(({data:n})=>{a.value=n})},u=()=>{s.value=!0,Be().then(({data:n})=>{b.value=n.groups||[],s.value=!1})},_=()=>{y(0)},P=n=>{y(n)},l=n=>{We(n).then(()=>{K("删除成功",{type:"success"}),u()})},d=()=>{tl().then(()=>{K("缓存已清除",{type:"success"})})};return re(()=>{T(),u()}),(n,g)=>{const F=ge("loading");return i(),k("div",Cl,[D("div",Ul,[g[3]||(g[3]=D("h3",{class:"text-xl font-bold text-gray-600"},"系统设置",-1)),D("div",xl,[c(e(oe),{title:"确定要清除所有设置缓存吗？",width:"240",onConfirm:d},{reference:f(()=>[c(e(q),{type:"warning"},{default:f(()=>[...g[1]||(g[1]=[U("清除缓存",-1)])]),_:1})]),_:1}),a.value.locked?M("",!0):(i(),G(e(q),{key:0,type:"primary",onClick:_},{default:f(()=>[...g[2]||(g[2]=[U("添加设置组",-1)])]),_:1}))])]),be((i(),k("div",Il,[b.value.length>0?(i(!0),k(R,{key:0},Z(b.value,x=>(i(),G(Al,{key:x.id,group:x,config:a.value,onRefresh:u,onEditGroup:P,onDeleteGroup:l},null,8,["group","config"]))),128)):(i(),k("div",Ol,[g[5]||(g[5]=D("p",{class:"text-gray-500 mb-4"},"暂无设置组",-1)),a.value.locked?M("",!0):(i(),G(e(q),{key:0,type:"primary",onClick:_},{default:f(()=>[...g[4]||(g[4]=[U("添加设置组",-1)])]),_:1}))]))])),[[F,s.value]]),c(e(ke),{ref_key:"groupFormRef",ref:h,modelValue:e(I),"onUpdate:modelValue":g[0]||(g[0]=x=>he(I)?I.value=x:null),visible:e(V),form:{columns:e(m),rules:e(S),labelPosition:"right",labelSuffix:""},size:e(p),closeOnClickModal:!0,title:e(O)>0?"编辑设置组":"新增设置组",confirmText:"提交",cancelText:"取消",onConfirm:e(E),onCancel:e(A)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"])])}}}),ql=te(Fl,[["__scopeId","data-v-fe518a0c"]]);export{ql as default};
