var j=Object.defineProperty,q=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var T=(s,o,e)=>o in s?j(s,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[o]=e,R=(s,o)=>{for(var e in o||(o={}))F.call(o,e)&&T(s,e,o[e]);if(Y)for(var e of Y(o))O.call(o,e)&&T(s,e,o[e]);return s},z=(s,o)=>q(s,A(o));import{r as w,l as G,o as J,t as W,E as K,j as n,f as x,v as k,e as M,q as Q,F as I,G as X,i as D,w as i,D as c,C as u,u as r,g as V,A as Z,H as ee,I as ae,J as te,y as le,k as oe,P as ne,_ as re}from"./index-2C-ofHV5.js";import{i as se,s as ie}from"./cert-B1S-qIHA.js";import{c as H}from"./utils-C-gUDCcE.js";import{P as ue}from"./plus-search-B1FvdIYy.js";import{s as de,a as B,b as pe,c as E,d as ce,e as N,f as me}from"./dictionary-DwGUqBwq.js";import{u as fe}from"./drawer-BlMYOobw.js";import"./index-CaJyLCRQ.js";function ge(){const s=w({}),o=w(),e=w([]),b=w(!0),p=G({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]});function f(t){p.pageSize=t,g()}function l(t){p.currentPage=t,g()}function g(){b.value=!0;const t=z(R({},W(s.value)),{pageSize:p.pageSize,currentPage:p.currentPage});t.issued_at&&(t.issued_at=H(t.issued_at)),t.expires_at&&(t.expires_at=H(t.expires_at)),se(t).then(({data:m})=>{e.value=m.items,p.total=m.total,p.pageSize=m.pageSize,p.currentPage=m.currentPage}).finally(()=>{b.value=!1})}const _=()=>{g()},v=()=>{setTimeout(()=>{var t,m;window.dispatchEvent(new Event("resize")),(m=(t=o.value)==null?void 0:t.setAdaptive)==null||m.call(t)},500)};return J(()=>{g()}),{tableRef:o,form:s,loading:b,dataList:e,pagination:p,onSearch:g,onReset:_,onCollapse:v,handleSizeChange:f,handleCurrentChange:l}}const _e=[{label:"域名",prop:"domain",valueType:"input",fieldProps:{placeholder:"请输入域名"}},{label:"状态",prop:"status",valueType:"select",options:de,fieldProps:{placeholder:"请选择状态"}},{label:"订单ID",prop:"order_id",valueType:"input",fieldProps:{placeholder:"请输入订单ID"}},{label:"签发时间",prop:"issued_at",valueType:"date-picker",fieldProps:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"过期时间",prop:"expires_at",valueType:"date-picker",fieldProps:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}}];function he(){const s=K();return[{label:"ID",prop:"id",width:140},{label:"订单ID",prop:"order_id",width:140,cellRenderer:({row:e})=>n("span",{class:"cursor-pointer",onClick:()=>{s.push({path:"/order",query:{id:e.order_id}})}},[e.order_id])},{label:"主域名",prop:"common_name",minWidth:150},{label:"金额",prop:"amount",width:100},{label:"操作",prop:"action",width:100,cellRenderer:({row:e})=>n(x("el-tag"),{type:pe[e.action]},{default:()=>[B[e.action]]})},{label:"渠道",prop:"channel",width:100,cellRenderer:({row:e})=>n(x("el-tag"),{type:ce[e.channel]},{default:()=>[E[e.channel]]})},{label:"状态",prop:"status",width:100,cellRenderer:({row:e})=>n(x("el-tag"),{type:me[e.status]||"info"},{default:()=>[N[e.status]]})},{label:"签发时间",prop:"issued_at",width:180,formatter:({issued_at:e})=>e?k(e).format("YYYY-MM-DD HH:mm:ss"):"-"},{label:"过期时间",prop:"expires_at",width:180,formatter:({expires_at:e})=>e?k(e).format("YYYY-MM-DD HH:mm:ss"):"-"},{label:"操作",fixed:"right",width:80,slot:"operation"}]}const be={key:0},ve=M({__name:"detail",props:{id:{type:Number,default:0},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:o}){const e=s,b=o,{drawerSize:p}=fe(),f=Q({get:()=>e.modelValue,set:_=>b("update:modelValue",_)}),l=w(),g=()=>{e.id&&ie(e.id).then(_=>{l.value=_.data})};return I(()=>f.value,_=>{_&&g()}),I(()=>e.id,()=>{f.value&&g()}),(_,v)=>{const t=x("el-descriptions-item"),m=x("el-descriptions");return D(),X(r(te),{modelValue:f.value,"onUpdate:modelValue":v[0]||(v[0]=a=>f.value=a),title:"证书详情",size:r(p)},{default:i(()=>[n(m,{column:1,border:"","label-width":"100",class:"mt-4"},{default:i(()=>[n(t,{"label-align":"right",label:"ID"},{default:i(()=>{var a;return[c(u((a=l.value)==null?void 0:a.id),1)]}),_:1}),n(t,{"label-align":"right",label:"订单ID"},{default:i(()=>{var a;return[c(u((a=l.value)==null?void 0:a.order_id),1)]}),_:1}),n(t,{"label-align":"right",label:"接口ID"},{default:i(()=>{var a;return[c(u((a=l.value)==null?void 0:a.api_id),1)]}),_:1}),n(t,{"label-align":"right",label:"操作"},{default:i(()=>{var a;return[c(u(r(B)[(a=l.value)==null?void 0:a.action]),1)]}),_:1}),n(t,{"label-align":"right",label:"渠道"},{default:i(()=>{var a;return[c(u(r(E)[(a=l.value)==null?void 0:a.channel]),1)]}),_:1}),n(t,{"label-align":"right",label:"通用名称"},{default:i(()=>{var a;return[c(u((a=l.value)==null?void 0:a.common_name),1)]}),_:1}),n(t,{"label-align":"right",label:"备用名称"},{default:i(()=>{var a,d;return[(a=l.value)!=null&&a.alternative_names?(D(),V("ul",be,[(D(!0),V(ee,null,ae((d=l.value)==null?void 0:d.alternative_names.split(","),C=>(D(),V("li",{key:C},u(C),1))),128))])):Z("",!0)]}),_:1}),n(t,{"label-align":"right",label:"域名数量"},{default:i(()=>{var a,d,C,P,h,S;return[c(u((a=l.value)!=null&&a.standard_count?((d=l.value)==null?void 0:d.standard_count)+"个标准域名":"")+" "+u((C=l.value)!=null&&C.standard_count&&((P=l.value)!=null&&P.wildcard_count)?"/":"")+" "+u((h=l.value)!=null&&h.wildcard_count?((S=l.value)==null?void 0:S.wildcard_count)+"个通配符":""),1)]}),_:1}),n(t,{"label-align":"right",label:"金额"},{default:i(()=>{var a;return[c(u((a=l.value)==null?void 0:a.amount),1)]}),_:1}),n(t,{"label-align":"right",label:"状态"},{default:i(()=>{var a;return[c(u(r(N)[(a=l.value)==null?void 0:a.status]),1)]}),_:1}),n(t,{"label-align":"right",label:"签发时间"},{default:i(()=>{var a,d;return[c(u((a=l.value)!=null&&a.issued_at?r(k)((d=l.value)==null?void 0:d.issued_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]}),_:1}),n(t,{"label-align":"right",label:"过期时间"},{default:i(()=>{var a,d;return[c(u((a=l.value)!=null&&a.expires_at?r(k)((d=l.value)==null?void 0:d.expires_at).format("YYYY-MM-DD HH:mm:ss"):"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue","size"])}}}),Ce={class:"main"},ye={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[24px] overflow-auto"},we=M({name:"Cert",__name:"index",setup(s){const o=w(!1),e=w(0),b=P=>{e.value=P.id,o.value=!0},{tableRef:p,form:f,loading:l,dataList:g,pagination:_,onSearch:v,onReset:t,onCollapse:m,handleSizeChange:a,handleCurrentChange:d}=ge(),C=he();return(P,h)=>{const S=x("el-button"),$=x("pure-table");return D(),V("div",Ce,[le("div",ye,[n(r(ue),{modelValue:r(f),"onUpdate:modelValue":h[0]||(h[0]=y=>oe(f)?f.value=y:null),columns:r(_e),"show-number":2,"row-props":{gutter:12},"col-props":{xs:24,sm:12,md:8,lg:6,xl:4},"label-width":"80","label-position":"right","label-suffix":"","search-text":"搜索","reset-text":"重置","expand-text":"展开","retract-text":"收起",onSearch:r(v),onReset:r(t),onCollapse:r(m)},null,8,["modelValue","columns","onSearch","onReset","onCollapse"])]),n(r(ne),{title:"证书管理",columns:r(C),onRefresh:r(v)},{default:i(({size:y,dynamicColumns:L})=>[n($,{ref_key:"tableRef",ref:p,"row-key":"id","align-whole":"left","table-layout":"auto",loading:r(l),size:y,adaptive:"",adaptiveConfig:{offsetBottom:108},data:r(g),columns:L,pagination:z(R({},r(_)),{size:y}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onPageSizeChange:r(a),onPageCurrentChange:r(d)},{operation:i(({row:U})=>[n(S,{class:"reset-margin !outline-none",link:"",type:"primary",size:y,onClick:xe=>b(U)},{default:i(()=>[...h[2]||(h[2]=[c(" 详情 ",-1)])]),_:1},8,["size","onClick"])]),_:2},1032,["loading","size","data","columns","pagination","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"]),n(ve,{id:e.value,modelValue:o.value,"onUpdate:modelValue":h[1]||(h[1]=y=>o.value=y)},null,8,["id","modelValue"])])}}}),Te=re(we,[["__scopeId","data-v-1da81019"]]);export{Te as default};
