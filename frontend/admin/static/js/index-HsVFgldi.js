var Ae=Object.defineProperty,Be=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var fe=(c,s,a)=>s in c?Ae(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a,z=(c,s)=>{for(var a in s||(s={}))Ee.call(s,a)&&fe(c,a,s[a]);if(ve)for(var a of ve(s))Ne.call(s,a)&&fe(c,a,s[a]);return c},re=(c,s)=>Be(c,Le(s));var L=(c,s,a)=>new Promise((b,n)=>{var l=i=>{try{d(a.next(i))}catch(h){n(h)}},y=i=>{try{d(a.throw(i))}catch(h){n(h)}},d=i=>i.done?b(i.value):Promise.resolve(i.value).then(l,y);d((a=a.apply(c,s)).next())});import{P as Me,a as $e}from"./plus-search-DONTT3F1.js";import{u as Ye}from"./drawer-DA-UdFhf.js";import{b as je,d as He,i as We,F as Ge,u as Ke,a as Ze,s as Je,c as Qe,g as Xe,e as el,f as ll,h as tl,j as al}from"./product-CyGNEIEW.js";import{r as f,l as he,q as N,m as G,t as ol,n as rl,p as nl,f as t,h as g,aP as sl,b3 as il,s as be,d as Q,E as R,e as V,w as r,i as u,c as M,G as K,F as Z,A as T,D as j,o as Ce,v as W,z as ue,b7 as _e,x as we,B as Pe,y as ne,_ as Se,j as ge}from"./index-D9lkRtkU.js";import{b as H,e as se,c as ie,n as J,s as ye,d as ul,w as dl,f as pl,g as cl,h as ml,p as vl,i as E}from"./dictionary-Ce8SPu8B.js";import{p as fl}from"./utils-BTJ8R6fS.js";import{u as bl}from"./dialog-CGkKnwkH.js";import{i as _l}from"./userLevel-BNPZ7Hzz.js";import{L as gl}from"./levels-DxAEgOVc.js";import{u as yl}from"./hooks-C30YmLIe.js";import{C as hl}from"./close-bold-DR0Tnm_R.js";import{P as Cl}from"./index-ChpzrfiJ.js";import"./index-B6vBV-uA.js";import"./epTheme-Db9MQrTx.js";import"./index.vue_vue_type_script_setup_true_lang-CvymPDJM.js";function wl(c){const s=f({}),a=f([]),b=f(!0),n=he({total:0,pageSize:100,currentPage:1,background:!0,pageSizes:[10,20,50,100],hideOnSinglePage:!0}),l=N(()=>n.total<=n.pageSize);function y(o){n.pageSize=o,e()}function d(o){n.currentPage=o,e()}const i=f(!1),h=f(0),P=o=>{i.value=!0,o?h.value=o:h.value=0},x=o=>{He(o).then(()=>{G("删除成功",{type:"success"}),e()})},_=o=>{je(o).then(()=>{G("删除成功",{type:"success"}),e()})};function e(){b.value=!0;const o=re(z({},ol(s.value)),{pageSize:n.pageSize,currentPage:n.currentPage});We(o).then(({data:v})=>{a.value=v.items,n.total=v.total,n.pageSize=v.pageSize,n.currentPage=v.currentPage,rl(()=>{c.value&&c.value.getTableRef().clearSelection()})}).finally(()=>{b.value=!1})}return{loading:b,search:s,dataList:a,pagination:n,isSinglePage:l,handleSizeChange:y,handleCurrentChange:d,onSearch:e,showStore:i,updateId:h,handleStore:P,handleDestroy:x,handleBatchDestroy:_}}const Y=(c,s)=>(a,b)=>{const n=f(a),l=y=>{n.value===y?(n.value=void 0,b(void 0)):(n.value=y,b(y))};return t("div",{class:"flex flex-wrap gap-1 items-center"},[t("div",{class:"flex flex-wrap gap-1"},[c.map(y=>t(g("el-button"),{key:y.value,type:n.value===y.value?"primary":"default",onClick:()=>l(y.value),class:"ml-3 w-28"},{default:()=>[y.label]}))]),(s==null?void 0:s.showToggleButton)&&t(g("el-button"),{type:"primary",link:!0,onClick:s.onToggle,class:"ml-3 flex items-center whitespace-nowrap text-base"},{default:()=>[t(g("el-icon"),{class:"mr-1"},{default:()=>[s.collapsed?t(sl,null,null):t(il,null,null)]}),s.collapsed?"展开":"收起"]})])},Pl=c=>{const s=nl(()=>{c()},500),a=f(!0),b=()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},500)},n=()=>{a.value=!a.value,b()};return{searchColumns:N(()=>[{label:"证书品牌",prop:"brand",valueType:"radio",options:H,renderField:Y(H,{showToggleButton:!0,onToggle:n,collapsed:a.value})},{label:"加密标准",prop:"encryption_standard",valueType:"radio",options:se,renderField:Y(se),hideInSearch:a.value},{label:"验证类型",prop:"validation_type",valueType:"radio",options:ie,renderField:Y(ie),hideInSearch:a.value},{label:"域名类型",prop:"name_type",valueType:"radio",options:J,renderField:Y(J),hideInSearch:a.value},{label:"产品状态",prop:"status",valueType:"radio",options:ye,renderField:Y(ye),hideInSearch:a.value},{label:"快速搜索",prop:"quickSearch",valueType:"input",fieldProps:{placeholder:"编码/名称/备注",clearable:!0,style:{width:"240px"}},hideInSearch:a.value}]),debouncedSearch:s}},Sl=(c,s)=>{const a=f(!1),b=f(),n=f(0),l=f({}),y=[{label:"名称",prop:"name",valueType:"input",fieldProps:{placeholder:"请输入名称"}},{label:"编码",prop:"code",valueType:"input",fieldProps:{placeholder:"请输入编码"}},{label:"API ID",prop:"api_id",valueType:"input",fieldProps:{placeholder:"请输入API ID"}},{label:"来源",prop:"source",valueType:"select",fieldProps:{placeholder:"请选择来源"},options:s},{label:"品牌",prop:"brand",valueType:"select",fieldProps:{placeholder:"请选择品牌"},options:H},{label:"签发机构",prop:"ca",valueType:"select",fieldProps:{placeholder:"请选择签发机构"},options:ul},{label:"保险币种",prop:"warranty_currency",valueType:"select",fieldProps:{placeholder:"请选择保险币种"},options:dl},{label:"保险金额",prop:"warranty",valueType:"input-number",fieldProps:{placeholder:"请输入保险金额",min:0,precision:2,controlsPosition:"right"}},{label:"服务器数量",prop:"server",valueType:"input-number",fieldProps:{placeholder:"请输入限制服务器数量",min:0,precision:0,controlsPosition:"right"},tooltip:"0为不限制"},{label:"加密标准",prop:"encryption_standard",valueType:"radio",fieldProps:{placeholder:"请选择加密标准"},options:se},{label:"加密算法",prop:"encryption_alg",valueType:"checkbox",fieldProps:{placeholder:"请选择加密算法",multiple:!0},options:pl},{label:"签名摘要算法",prop:"signature_digest_alg",valueType:"checkbox",fieldProps:{placeholder:"请选择签名摘要算法",multiple:!0},options:cl},{label:"验证类型",prop:"validation_type",valueType:"radio",fieldProps:{placeholder:"请选择验证类型"},options:ie},{label:"通用名称类型",prop:"common_name_types",valueType:"checkbox",fieldProps:{placeholder:"请选择通用名称类型",multiple:!0},options:J},{label:"备用名称类型",prop:"alternative_name_types",valueType:"checkbox",fieldProps:{placeholder:"请选择备用名称类型",multiple:!0},options:J},{label:"验证方法",prop:"validation_methods",valueType:"checkbox",fieldProps:{placeholder:"请选择验证方法",multiple:!0},options:ml},{label:"周期",prop:"periods",valueType:"checkbox",fieldProps:{placeholder:"请选择周期",multiple:!0},options:vl},{label:"标准域名起始个数",prop:"standard_min",valueType:"input-number",fieldProps:{placeholder:"请输入标准域名起始个数",min:0,precision:0,controlsPosition:"right"}},{label:"标准域名最大个数",prop:"standard_max",valueType:"input-number",fieldProps:{placeholder:"请输入标准域名最大个数",min:0,precision:0,controlsPosition:"right"}},{label:"通配符起始个数",prop:"wildcard_min",valueType:"input-number",fieldProps:{placeholder:"请输入通配符起始个数",min:0,precision:0,controlsPosition:"right"}},{label:"通配符最大个数",prop:"wildcard_max",valueType:"input-number",fieldProps:{placeholder:"请输入通配符最大个数",min:0,precision:0,controlsPosition:"right"}},{label:"总域名起始个数",prop:"total_min",valueType:"input-number",fieldProps:{placeholder:"请输入总域名起始个数",min:0,precision:0,controlsPosition:"right"}},{label:"总域名最大个数",prop:"total_max",valueType:"input-number",fieldProps:{placeholder:"请输入总域名最大个数",min:0,precision:0,controlsPosition:"right"}},{label:"添加SAN",prop:"add_san",valueType:"switch",fieldProps:E},{label:"替换SAN",prop:"replace_san",valueType:"switch",fieldProps:E},{label:"重新签发",prop:"reissue",valueType:"switch",fieldProps:E},{label:"续期",prop:"renew",valueType:"switch",fieldProps:E},{label:"重用CSR",prop:"reuse_csr",valueType:"switch",fieldProps:E},{label:"赠送根域名",prop:"gift_root_domain",valueType:"switch",fieldProps:E},{label:"退款期限",prop:"refund_period",valueType:"input-number",fieldProps:{placeholder:"请输入退款期限",min:0,precision:0,controlsPosition:"right"}},{label:"备注",prop:"remark",valueType:"textarea",fieldProps:{placeholder:"请输入备注",rows:3}},{label:"排序权重",prop:"weight",valueType:"input-number",fieldProps:{placeholder:"请输入排序权重",min:0,precision:0,controlsPosition:"right"},tooltip:"排序权重越小，越靠前"},{label:"状态",prop:"status",valueType:"switch",fieldProps:E},{label:"创建时间",prop:"created_at",hideInForm:N(()=>n.value===0),renderField:o=>o&&typeof o=="string"?be(o).format("YYYY-MM-DD HH:mm:ss"):""},{label:"更新时间",prop:"updated_at",hideInForm:N(()=>n.value===0),renderField:o=>o&&typeof o=="string"?be(o).format("YYYY-MM-DD HH:mm:ss"):""}],d={code:[{required:!0,message:"请输入编码"},{max:50,message:"编码长度不能超过50个字符",trigger:"blur"}],name:[{required:!0,message:"请输入名称"},{max:100,message:"名称长度不能超过100个字符",trigger:"blur"}],api_id:[{required:!0,message:"请输入API ID"},{max:128,message:"API ID长度不能超过128个字符",trigger:"blur"}],source:[{required:!0,message:"请选择来源"}],brand:[{required:!0,message:"请选择品牌"}],ca:[{required:!0,message:"请选择签发机构"}],warranty_currency:[{required:!0,message:"请选择保险币种"}],warranty:[{required:!0,message:"请输入保险金额"},{type:"number",min:0,message:"保险金额不能小于0"}],encryption_standard:[{required:!0,message:"请选择加密标准"}],encryption_alg:[{required:!0,message:"请选择加密算法"}],signature_digest_alg:[{required:!0,message:"请选择签名摘要算法"}],validation_type:[{required:!0,message:"请选择验证类型"}],common_name_types:[{required:!0,message:"请选择通用名称类型"}],validation_methods:[{required:!0,message:"请选择验证方法"}],periods:[{required:!0,message:"请选择周期"}],standard_min:[{required:!0,message:"请输入标准域名起始个数"}],standard_max:[{required:!0,message:"请输入标准域名最大个数"}],wildcard_min:[{required:!0,message:"请输入通配符域名起始个数"}],wildcard_max:[{required:!0,message:"请输入通配符域名最大个数"}],total_min:[{required:!0,message:"请输入总域名起始个数"}],total_max:[{required:!0,message:"请输入总域名最大个数"}],refund_period:[{required:!0,message:"请输入退款期限"}],weight:[{required:!0,message:"请输入排序权重"}],remark:[{max:500,message:"备注长度不能超过500个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态"}]};function i(o=0){var v,S;a.value=!0,o>0?n.value!==o&&x(o):((S=(v=b.value)==null?void 0:v.formInstance)==null||S.resetFields(),l.value=Object.fromEntries(Object.entries(Ge))),n.value=o}function h(){n.value>0?e():_()}function P(){a.value=!1}const x=o=>{Je(o).then(({data:v})=>{var S;l.value=fl(v,Qe),l.value.warranty=Number((S=l.value.warranty)!=null?S:0)})},_=()=>{delete l.value.created_at,delete l.value.updated_at,Ze(l.value).then(()=>{c(),a.value=!1})},e=()=>{delete l.value.created_at,delete l.value.updated_at,Ke(n.value,l.value).then(()=>{c(),a.value=!1})};return{storeRef:b,showStore:a,storeId:n,storeValues:l,storeColumns:y,rules:d,openStoreForm:i,confirmStoreForm:h,closeStoreForm:P}},xl=c=>{const s=f(),a=f([]);return{tableRef:s,selectedIds:a,handleSelectionChange:d=>{a.value=d.map(i=>i.id),s.value.setAdaptive()},handleSelectionCancel:()=>{var d;(d=s.value)==null||d.getTableRef().clearSelection()},tableColumns:[{label:"勾选列",type:"selection",reserveSelection:!0},{label:"ID",prop:"id",width:50},{label:"来源",prop:"source",width:80,formatter:d=>{var h;const i=(h=c.value)==null?void 0:h.find(P=>P.value===d.source);return i?i.label:d.source.charAt(0).toUpperCase()+d.source.slice(1)}},{label:"名称",prop:"name",minWidth:150},{label:"说明",prop:"remark",minWidth:150},{label:"权重",prop:"weight",width:70},{label:"状态",prop:"status",width:70,cellRenderer:({row:d,props:i})=>t(g("el-tag"),{size:i.size,type:d.status===1?"success":"danger",effect:"plain"},{default:()=>[d.status===1?"启用":"禁用"]})},{label:"操作",fixed:"right",slot:"operation",width:200}],handleRowClick:(d,i,h)=>{var x;const P=h.target;P.tagName==="BUTTON"||P.closest("button")||P.closest(".el-button")||(x=s.value)==null||x.getTableRef().toggleRowSelection(d)}}};function kl(){const c=f([]),s=f(!1);function a(){s.value=!0,Xe().then(({data:b})=>{c.value=b||[]}).catch(()=>{c.value=[]}).finally(()=>{s.value=!1})}return{sourcesList:c,getSourcesList:a}}const Tl=Q({name:"ProductImport",__name:"import",props:{visible:{type:Boolean,default:!1},sourcesList:{type:Array,default:()=>[]}},emits:["update:visible","success"],setup(c,{emit:s}){const a=c,b=s,n=f(),l=f(!1),{dialogSize:y}=bl(),d=N({get:()=>a.visible,set:_=>b("update:visible",_)}),i=he({source:"default",brand:"",apiId:"",type:"update"}),h={source:[{required:!0,message:"请选择来源"}]},P=()=>{b("update:visible",!1)},x=()=>{l.value=!0,el(i).then(_=>{_.code===1&&(G("导入产品成功",{type:"success"}),P(),b("success"),i.source="default",i.brand="",i.apiId="",i.type="update")}).finally(()=>{l.value=!1})};return(_,e)=>{const o=g("el-option"),v=g("el-select"),S=g("el-form-item"),I=g("el-input"),q=g("el-form"),F=g("el-button"),U=g("el-dialog");return V(),R(U,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=m=>d.value=m),title:"导入产品",width:u(y),"destroy-on-close":"",onClosed:P},{footer:r(()=>[t(F,{onClick:P},{default:r(()=>e[5]||(e[5]=[T("取消")])),_:1}),t(F,{type:"primary",loading:l.value,onClick:x},{default:r(()=>e[6]||(e[6]=[T(" 确定 ")])),_:1},8,["loading"])]),default:r(()=>[t(q,{ref_key:"formRef",ref:n,model:i,rules:h,"label-width":"80px"},{default:r(()=>[t(S,{label:"来源",prop:"source"},{default:r(()=>[t(v,{modelValue:i.source,"onUpdate:modelValue":e[0]||(e[0]=m=>i.source=m),placeholder:"请选择来源",style:{width:"100%"}},{default:r(()=>[(V(!0),M(Z,null,K(a.sourcesList,m=>(V(),R(o,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"品牌",prop:"brand"},{default:r(()=>[t(v,{modelValue:i.brand,"onUpdate:modelValue":e[1]||(e[1]=m=>i.brand=m),placeholder:"请选择品牌",clearable:"",style:{width:"100%"}},{default:r(()=>[(V(!0),M(Z,null,K(u(H),m=>(V(),R(o,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"接口ID",prop:"apiId"},{default:r(()=>[t(I,{modelValue:i.apiId,"onUpdate:modelValue":e[2]||(e[2]=m=>i.apiId=m),placeholder:"请输入接口ID"},null,8,["modelValue"])]),_:1}),t(S,{label:"类型",prop:"type"},{default:r(()=>[t(v,{modelValue:i.type,"onUpdate:modelValue":e[3]||(e[3]=m=>i.type=m),placeholder:"请选择类型",clearable:"",style:{width:"100%"}},{default:r(()=>[t(o,{key:"new",label:"导入新产品",value:"new"}),t(o,{key:"update",label:"更新产品",value:"update"}),t(o,{key:"all",label:"导入所有产品",value:"all"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","width"])}}}),Vl={class:"dialog-footer"},Il=Q({__name:"export",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(c,{emit:s}){const a=c,b=s,n=N({get:()=>a.visible,set:_=>b("update:visible",_)}),l=f({brands:[],levelCustom:0,levelCodes:[]}),y=()=>{l.value={brands:[],levelCustom:0,levelCodes:[]}},d=f([]),i=()=>L(null,null,function*(){var _;try{const e=yield _l({custom:l.value.levelCustom});e.code===1&&((_=e.data)!=null&&_.items)&&(d.value=e.data.items.map(o=>({label:o.name,value:o.code})))}catch(e){console.error("获取会员级别失败:",e)}}),h=f(!1),P=()=>L(null,null,function*(){if(!h.value){h.value=!0;try{const _={};l.value.brands.length>0&&(_.brands=l.value.brands),_.levelCustom=l.value.levelCustom,l.value.levelCodes.length>0&&(_.levelCodes=l.value.levelCodes),yield ll(_),_e.success("导出成功"),n.value=!1}catch(_){console.error("导出失败:",_),_e.error(_.message||"导出失败")}finally{h.value=!1}}}),x=()=>{n.value=!1,y()};return j(()=>a.visible,_=>{_&&(y(),i())}),j(()=>l.value.levelCustom,()=>{l.value.levelCodes=[],i()}),Ce(()=>{i()}),(_,e)=>{const o=g("el-option"),v=g("el-select"),S=g("el-form-item"),I=g("el-radio"),q=g("el-radio-group"),F=g("el-form"),U=g("el-button"),m=g("el-dialog");return V(),R(m,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=C=>n.value=C),title:"导出产品价格",width:"500px","destroy-on-close":"",onClose:x},{footer:r(()=>[W("div",Vl,[t(U,{onClick:x},{default:r(()=>e[6]||(e[6]=[T("取消")])),_:1}),t(U,{type:"primary",loading:h.value,onClick:P},{default:r(()=>[T(ue(h.value?"导出中...":"导出"),1)]),_:1},8,["loading"])])]),default:r(()=>[t(F,{model:l.value,"label-width":"120px","label-position":"right"},{default:r(()=>[t(S,{label:"品牌筛选"},{default:r(()=>[t(v,{modelValue:l.value.brands,"onUpdate:modelValue":e[0]||(e[0]=C=>l.value.brands=C),multiple:"",placeholder:"选择品牌（不选择则导出所有品牌）",style:{width:"100%"},"collapse-tags":"","collapse-tags-tooltip":""},{default:r(()=>[(V(!0),M(Z,null,K(u(H),C=>(V(),R(o,{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"会员级别类型"},{default:r(()=>[t(q,{modelValue:l.value.levelCustom,"onUpdate:modelValue":e[1]||(e[1]=C=>l.value.levelCustom=C)},{default:r(()=>[t(I,{value:0},{default:r(()=>e[4]||(e[4]=[T("基础级别")])),_:1}),t(I,{value:1},{default:r(()=>e[5]||(e[5]=[T("定制级别")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(S,{label:"会员级别"},{default:r(()=>[t(v,{modelValue:l.value.levelCodes,"onUpdate:modelValue":e[2]||(e[2]=C=>l.value.levelCodes=C),multiple:"",placeholder:"选择级别（不选择则导出所有级别）",style:{width:"100%"},"collapse-tags":"","collapse-tags-tooltip":""},{default:r(()=>[(V(!0),M(Z,null,K(d.value,C=>(V(),R(o,{key:C.value,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),zl=Q({__name:"cost",props:{visible:{type:Boolean},id:{}},emits:["update:visible","success"],setup(c,{emit:s}){const a=c,b=s,n=f(!1),l=f({price:{},alternative_standard_price:{},alternative_wildcard_price:{}}),y=f([]),d=f([]),i=N({get:()=>a.visible,set:e=>b("update:visible",e)}),h=()=>{const e={price:z({},l.value.price||{})};d.value.includes("standard")&&(e.alternative_standard_price=z({},l.value.alternative_standard_price||{})),d.value.includes("wildcard")&&(e.alternative_wildcard_price=z({},l.value.alternative_wildcard_price||{})),y.value.forEach(o=>{const v=o.toString();e.price[v]||(e.price[v]=0),d.value.includes("standard")&&e.alternative_standard_price&&(e.alternative_standard_price[v]||(e.alternative_standard_price[v]=0)),d.value.includes("wildcard")&&e.alternative_wildcard_price&&(e.alternative_wildcard_price[v]||(e.alternative_wildcard_price[v]=0))}),l.value=e};j(()=>a.visible,e=>L(null,null,function*(){e&&a.id>0&&(yield P())})),j(()=>a.id,e=>L(null,null,function*(){e&&a.visible&&(yield P())})),j([()=>y.value,()=>d.value],()=>{h()});const P=()=>L(null,null,function*(){n.value=!0;try{al(a.id).then(({data:e})=>{y.value=e.periods||[],d.value=e.alternative_name_types||[];const o=z({price:{}},e.cost||{});o.price||(o.price={}),l.value=o,h()})}finally{n.value=!1}}),x=()=>{b("update:visible",!1)},_=()=>L(null,null,function*(){n.value=!0;const e={price:z({},l.value.price)};d.value.includes("standard")&&l.value.alternative_standard_price&&(e.alternative_standard_price=z({},l.value.alternative_standard_price)),d.value.includes("wildcard")&&l.value.alternative_wildcard_price&&(e.alternative_wildcard_price=z({},l.value.alternative_wildcard_price)),tl(a.id,e).then(()=>{G("更新成本成功",{type:"success"}),x(),b("success")}).finally(()=>{n.value=!1})});return(e,o)=>{const v=g("el-table-column"),S=g("el-input-number"),I=g("el-table"),q=g("el-button"),F=g("el-dialog"),U=Pe("loading");return V(),R(F,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=m=>i.value=m),title:"编辑成本",width:"800px","destroy-on-close":"",onClosed:x},{footer:r(()=>[t(q,{onClick:x},{default:r(()=>o[1]||(o[1]=[T("取消")])),_:1}),t(q,{type:"primary",loading:n.value,onClick:_},{default:r(()=>o[2]||(o[2]=[T(" 确定 ")])),_:1},8,["loading"])]),default:r(()=>[we((V(),M("div",null,[t(I,{data:y.value,border:"",style:{width:"100%"}},{default:r(()=>[t(v,{label:"周期",width:"100",align:"center"},{default:r(({row:m})=>[T(ue(m)+"个月 ",1)]),_:1}),t(v,{label:"基础价格",align:"center"},{default:r(({row:m})=>[t(S,{modelValue:l.value.price[m],"onUpdate:modelValue":C=>l.value.price[m]=C,min:0,precision:2,"controls-position":"right",style:{width:"160px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),d.value.includes("standard")?(V(),R(v,{key:0,label:"附加标准域名价格",align:"center"},{default:r(({row:m})=>{var C;return[t(S,{"model-value":((C=l.value.alternative_standard_price)==null?void 0:C[m])||0,min:0,precision:2,"controls-position":"right",style:{width:"160px"},"onUpdate:modelValue":$=>{l.value.alternative_standard_price||(l.value.alternative_standard_price={}),l.value.alternative_standard_price[m]=$}},null,8,["model-value","onUpdate:modelValue"])]}),_:1})):ne("",!0),d.value.includes("wildcard")?(V(),R(v,{key:1,label:"附加通配符价格",align:"center"},{default:r(({row:m})=>{var C;return[t(S,{"model-value":((C=l.value.alternative_wildcard_price)==null?void 0:C[m])||0,min:0,precision:2,"controls-position":"right",style:{width:"160px"},"onUpdate:modelValue":$=>{l.value.alternative_wildcard_price||(l.value.alternative_wildcard_price={}),l.value.alternative_wildcard_price[m]=$}},null,8,["model-value","onUpdate:modelValue"])]}),_:1})):ne("",!0)]),_:1},8,["data"])])),[[U,n.value]])]),_:1},8,["modelValue"])}}}),Dl=Se(zl,[["__scopeId","data-v-1cb892b8"]]),Rl={class:"main"},ql={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[12px] overflow-auto"},Fl={key:0,class:"bg-[var(--el-fill-color-light)] w-full h-[46px] mb-2 pl-3 pr-2 flex items-center"},Ul={class:"flex-auto"},Ol={style:{"font-size":"var(--el-font-size-base)"},class:"text-[rgba(42,46,54,0.5)] dark:text-[rgba(220,220,242,0.5)] ml-2"},Al=Q({name:"Product",__name:"index",setup(c){const{drawerSize:s}=Ye(),{sourcesList:a,getSourcesList:b}=kl(),{tableRef:n,selectedIds:l,handleSelectionChange:y,handleSelectionCancel:d,tableColumns:i,handleRowClick:h}=xl(a),{loading:P,search:x,dataList:_,pagination:e,isSinglePage:o,handleSizeChange:v,handleCurrentChange:S,onSearch:I,handleDestroy:q,handleBatchDestroy:F}=wl(n),{searchColumns:U,debouncedSearch:m}=Pl(()=>I()),{storeRef:C,showStore:$,storeId:xe,storeColumns:ke,rules:Te,storeValues:X,openStoreForm:de,confirmStoreForm:Ve,closeStoreForm:Ie}=Sl(()=>I(),a),ee=f(!1),ze=()=>{ee.value=!0},le=f(!1),pe=f(0),De=O=>{pe.value=O.id,le.value=!0},te=f(!1),ce=f(null),Re=O=>{var p;ce.value=(p=O==null?void 0:O.id)!=null?p:null,te.value=!0},ae=f(!1),qe=()=>{ae.value=!0},me=O=>{const p=w=>{if(w==null)return!0;if(typeof w=="number")return w===0;if(typeof w=="string"){const D=w.trim();if(D==="")return!0;const A=Number(D);return!Number.isNaN(A)&&A===0}if(Array.isArray(w))return w.length===0?!0:w.every(D=>p(D));if(typeof w=="object"){const D=Object.values(w!=null?w:{});return D.length===0?!0:D.every(A=>p(A))}return!1};return p(O)};return Ce(()=>{b(),I()}),(O,p)=>{const w=g("el-button"),D=g("el-tooltip"),A=g("el-popconfirm"),Fe=g("pure-table"),Ue=Pe("motion-fade");return V(),M("div",Rl,[W("div",ql,[t(u(Me),{modelValue:u(x),"onUpdate:modelValue":p[0]||(p[0]=k=>ge(x)?x.value=k:null),columns:u(U),"show-number":6,"col-props":{xs:24,sm:24,md:24,lg:24,xl:24},"label-width":"80","label-position":"right","label-suffix":"","has-footer":!1,onChange:u(m)},null,8,["modelValue","columns","onChange"])]),t(u($e),{title:"产品管理",columns:u(i),onRefresh:u(I)},{buttons:r(()=>[t(w,{type:"primary",onClick:ze},{default:r(()=>p[8]||(p[8]=[T("导入产品")])),_:1}),t(w,{type:"primary",onClick:p[1]||(p[1]=k=>u(de)())},{default:r(()=>p[9]||(p[9]=[T("新增产品")])),_:1}),t(w,{type:"success",onClick:qe},{default:r(()=>p[10]||(p[10]=[T("导出价格")])),_:1})]),default:r(({size:k,dynamicColumns:Oe})=>[u(l).length>0?we((V(),M("div",Fl,[W("div",Ul,[t(D,{placement:"top",content:"取消选择"},{default:r(()=>[t(w,{type:"primary",size:"small",class:"!w-[15px] !p-0 !h-[15px] !rounded-[3px]",icon:u(yl)(u(hl)),onClick:u(d)},null,8,["icon","onClick"])]),_:1}),W("span",Ol," 已选 "+ue(u(l).length)+" 项 ",1)]),t(A,{title:"确定要删除吗？",width:"160px",onConfirm:p[2]||(p[2]=B=>u(F)(u(l)))},{reference:r(()=>[t(w,{type:"danger",size:"small"},{default:r(()=>p[11]||(p[11]=[T(" 批量删除 ")])),_:1})]),_:1})])),[[Ue]]):ne("",!0),t(Fe,{ref_key:"tableRef",ref:n,"row-key":"id","align-whole":"left","table-layout":"auto",loading:u(P),size:k,adaptive:"",adaptiveConfig:{offsetBottom:u(o)?44:108},data:u(_),columns:Oe,pagination:re(z({},u(e)),{size:k}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onRowClick:u(h),onSelectionChange:u(y),onPageSizeChange:u(v),onPageCurrentChange:u(S)},{operation:r(({row:B})=>[t(w,{class:"reset-margin !outline-none",type:"primary",link:"",size:k,onClick:oe=>u(de)(B.id)},{default:r(()=>p[12]||(p[12]=[T(" 编辑 ")])),_:2},1032,["size","onClick"]),t(w,{class:"reset-margin !outline-none",type:me(B.cost)?"danger":"primary",link:"",size:k,onClick:oe=>De(B)},{default:r(()=>p[13]||(p[13]=[T(" 成本 ")])),_:2},1032,["type","size","onClick"]),t(w,{class:"reset-margin !outline-none",type:me(B.prices)?"danger":"primary",link:"",size:k,onClick:oe=>Re(B)},{default:r(()=>p[14]||(p[14]=[T(" 价格 ")])),_:2},1032,["type","size","onClick"]),t(A,{title:"确定要删除吗？",width:"160px",onConfirm:oe=>u(q)(B.id)},{reference:r(()=>[t(w,{class:"reset-margin !outline-none",link:"",type:"danger",size:k},{default:r(()=>p[15]||(p[15]=[T(" 删除 ")])),_:2},1032,["size"])]),_:2},1032,["onConfirm"])]),_:2},1032,["loading","size","adaptiveConfig","data","columns","pagination","onRowClick","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"]),t(u(Cl),{ref_key:"storeRef",ref:C,modelValue:u(X),"onUpdate:modelValue":p[3]||(p[3]=k=>ge(X)?X.value=k:null),visible:u($),form:{columns:u(ke),rules:u(Te),labelPosition:"right",labelSuffix:"",labelWidth:"150px"},size:u(s),closeOnClickModal:!0,title:u(xe)>0?"编辑产品":"新增产品",confirmText:"提交",cancelText:"取消",onConfirm:u(Ve),onCancel:u(Ie)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"]),t(Tl,{visible:ee.value,"onUpdate:visible":p[4]||(p[4]=k=>ee.value=k),"sources-list":u(a),onSuccess:u(I)},null,8,["visible","sources-list","onSuccess"]),t(Dl,{id:pe.value,visible:le.value,"onUpdate:visible":p[5]||(p[5]=k=>le.value=k),onSuccess:u(I)},null,8,["id","visible","onSuccess"]),t(gl,{modelValue:te.value,"onUpdate:modelValue":p[6]||(p[6]=k=>te.value=k),"product-id":ce.value,onSaved:u(I)},null,8,["modelValue","product-id","onSaved"]),t(Il,{visible:ae.value,"onUpdate:visible":p[7]||(p[7]=k=>ae.value=k)},null,8,["visible"])])}}}),et=Se(Al,[["__scopeId","data-v-11b75ff0"]]);export{et as default};
