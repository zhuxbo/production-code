var M=Object.defineProperty,j=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var P=(t,e,a)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,_=(t,e)=>{for(var a in e||(e={}))H.call(e,a)&&P(t,a,e[a]);if(y)for(var a of y(e))U.call(e,a)&&P(t,a,e[a]);return t},S=(t,e)=>j(t,q(e));import{P as O,a as G}from"./plus-search-DsTBMFwC.js";import{b as J,i as K,L as Q}from"./levels-CEK299qH.js";import{r as f,l as X,m as Z,t as ee,n as le,p as oe,f as u,s as te,d as ae,o as ne,c as w,e as k,v as x,i as o,j as re,w as h,x as se,y as ie,h as v,z as ce,A as z,B as ue,_ as de}from"./index-y8QMp6Ai.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-Bcw0k9Xp.js";import{p as R}from"./dictionary-DjBTu35G.js";import{u as pe}from"./hooks-kqzw-jIO.js";import{C as me}from"./close-bold-BqGPjZ0Y.js";import"./index-DPhin83c.js";import"./epTheme-l5vfs7Oj.js";import"./product-BD54aJcB.js";import"./userLevel-k3VPNzYe.js";function he(t){const e=f({}),a=f([]),r=f(!0),n=X({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]});function g(c){n.pageSize=c,d()}function l(c){n.currentPage=c,d()}const i=c=>{J(c).then(()=>{Z("删除成功",{type:"success"}),d()})};function d(){r.value=!0;const c=S(_({},ee(e.value)),{pageSize:n.pageSize,currentPage:n.currentPage});K(c).then(({data:m})=>{a.value=m.items,n.total=m.total,n.pageSize=m.pageSize,n.currentPage=m.currentPage,le(()=>{t.value&&t.value.getTableRef().clearSelection()})}).finally(()=>{r.value=!1})}return{loading:r,search:e,dataList:a,pagination:n,handleSizeChange:g,handleCurrentChange:l,onSearch:d,handleBatchDestroy:i}}const fe=t=>{const e=oe(()=>{t()},500);return{searchColumns:[{label:"产品",prop:"product_id",valueType:"select",fieldProps:{clearable:!0},renderField:(r,n)=>u(F,{modelValue:r,uri:"/product",searchField:"quickSearch",labelField:"name",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择产品",onChange:n},null)},{label:"级别",prop:"level_code",valueType:"select",fieldProps:{clearable:!0},renderField:(r,n)=>u(F,{modelValue:r,uri:"/user-level",searchField:"quickSearch",labelField:"name",valueField:"code",itemsField:"items",totalField:"total",placeholder:"请选择级别",onChange:n},null)},{label:"周期",prop:"period",valueType:"select",fieldProps:{clearable:!0,placeholder:"请选择周期"},options:R}],debouncedSearch:e}},ge=()=>{const t=f(),e=f([]);return{tableRef:t,selectedIds:e,handleSelectionChange:l=>{e.value=l.map(i=>i.id),t.value.setAdaptive()},handleSelectionCancel:()=>{var l;(l=t.value)==null||l.getTableRef().clearSelection()},tableColumns:[{label:"勾选列",type:"selection",reserveSelection:!0},{label:"ID",prop:"id",minWidth:80},{label:"产品",prop:"product.name",minWidth:100},{label:"级别",prop:"level.name",minWidth:100},{label:"周期",prop:"period",minWidth:80,formatter:({period:l})=>{var i;return(i=R.find(d=>d.value===l))==null?void 0:i.label}},{label:"价格",prop:"price",minWidth:100,formatter:({price:l})=>`¥${l}`},{label:"附加标准域名价格",prop:"alternative_standard_price",minWidth:120,formatter:({alternative_standard_price:l})=>l?`¥${l}`:"-"},{label:"附加通配符价格",prop:"alternative_wildcard_price",minWidth:120,formatter:({alternative_wildcard_price:l})=>l?`¥${l}`:"-"},{label:"创建时间",prop:"created_at",width:180,formatter:({created_at:l})=>l?te(l).format("YYYY-MM-DD HH:mm:ss"):"-"}],handleRowClick:l=>{var i;(i=t.value)==null||i.getTableRef().toggleRowSelection(l)}}},be={class:"main"},ve={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[12px] overflow-auto"},Ce={key:0,class:"bg-[var(--el-fill-color-light)] w-full h-[46px] mb-2 pl-3 pr-2 flex items-center"},_e={class:"flex-auto"},Se={style:{"font-size":"var(--el-font-size-base)"},class:"text-[rgba(42,46,54,0.5)] dark:text-[rgba(220,220,242,0.5)] ml-2"},xe=ae({name:"ProductPrice",__name:"index",setup(t){const e=f(!1),{tableRef:a,selectedIds:r,tableColumns:n,handleSelectionChange:g,handleSelectionCancel:l,handleRowClick:i}=ge(),{loading:d,search:c,dataList:m,pagination:V,handleSizeChange:B,handleCurrentChange:T,onSearch:b,handleBatchDestroy:D}=he(a),{searchColumns:W,debouncedSearch:$}=fe(()=>b());ne(()=>{b()});function A(){a.value.setAdaptive()}return(ye,s)=>{const C=v("el-button"),E=v("el-tooltip"),I=v("el-popconfirm"),L=v("pure-table"),N=ue("motion-fade");return k(),w("div",be,[u(Q,{modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=p=>e.value=p),onSaved:o(b)},null,8,["modelValue","onSaved"]),x("div",ve,[u(o(O),{modelValue:o(c),"onUpdate:modelValue":s[1]||(s[1]=p=>re(c)?c.value=p:null),columns:o(W),"show-number":3,"row-props":{gutter:12},"col-props":{xs:24,sm:12,md:8,lg:6,xl:4},"label-width":"80","label-position":"right","label-suffix":"","has-footer":!1,onChange:o($)},null,8,["modelValue","columns","onChange"])]),u(o(G),{title:"产品价格",columns:o(n),onRefresh:o(b),onFullscreen:A},{buttons:h(()=>[u(C,{type:"primary",onClick:s[2]||(s[2]=p=>e.value=!0)},{default:h(()=>s[4]||(s[4]=[z(" 设置价格 ")])),_:1})]),default:h(({size:p,dynamicColumns:Y})=>[o(r).length>0?se((k(),w("div",Ce,[x("div",_e,[u(E,{placement:"top",content:"取消选择"},{default:h(()=>[u(C,{type:"primary",size:"small",class:"!w-[15px] !p-0 !h-[15px] !rounded-[3px]",icon:o(pe)(o(me)),onClick:o(l)},null,8,["icon","onClick"])]),_:1}),x("span",Se," 已选 "+ce(o(r).length)+" 项 ",1)]),u(I,{title:"确定要删除吗？",width:"160px",onConfirm:s[3]||(s[3]=Pe=>o(D)(o(r)))},{reference:h(()=>[u(C,{type:"danger",size:"small"},{default:h(()=>s[5]||(s[5]=[z(" 批量删除 ")])),_:1})]),_:1})])),[[N]]):ie("",!0),u(L,{ref_key:"tableRef",ref:a,"row-key":"id","align-whole":"left","table-layout":"auto",loading:o(d),size:p,adaptive:"",adaptiveConfig:{offsetBottom:108},data:o(m),columns:Y,pagination:S(_({},o(V)),{size:p}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onRowClick:o(i),onSelectionChange:o(g),onPageSizeChange:o(B),onPageCurrentChange:o(T)},null,8,["loading","size","data","columns","pagination","onRowClick","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"])])}}}),Ee=de(xe,[["__scopeId","data-v-dc927aac"]]);export{Ee as default};
