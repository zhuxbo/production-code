var te=Object.defineProperty,oe=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var N=(e,a,t)=>a in e?te(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,B=(e,a)=>{for(var t in a||(a={}))re.call(a,t)&&N(e,t,a[t]);if(I)for(var t of I(a))ne.call(a,t)&&N(e,t,a[t]);return e},D=(e,a)=>oe(e,ue(a));import{P as se,a as ie}from"./plus-search-Ddeza9d1.js";import{k as _,r as m,l as be,m as O,t as ve,n as pe,p as ce,f as b,I as de,s as me,d as ge,o as fe,c as G,e as V,v as k,i as l,j as L,w as f,x as he,y as Ce,h as M,z as Se,A as x,B as ye,_ as _e}from"./index-2hNLZh7L.js";import{c as Te,p as Re}from"./utils-DJcWIqxh.js";import{g as Pe}from"./datePicker-WHgduTab.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-B9my04-j.js";import{u as xe}from"./hooks-DA7uylxy.js";import{u as ze}from"./drawer-ay3FHH3-.js";import{C as we}from"./close-bold--5XrO9rQ.js";import{P as Be}from"./index-BIWxoMG3.js";import"./index-1hLbQr-8.js";import"./epTheme-i6e0-oRO.js";function De(e){return _.get("/organization",{params:e})}const K={user_id:0,name:"",registration_number:"",country:"CN",state:"",city:"",address:"",phone:0,postcode:""},ke=Object.keys(K);function Ae(e){return _.post("/organization",{data:e})}function Ee(e,a){return _.put(`/organization/${e}`,{data:a})}function Fe(e){return _.get(`/organization/${e}`)}function Ie(e){return _.delete(`/organization/${e}`)}function Ne(e){return _.delete("/organization/batch",{data:{ids:e}})}function Oe(e){const a=m({}),t=m([]),u=m(!0),r=be({total:0,pageSize:10,currentPage:1,background:!0,pageSizes:[10,20,50,100]});function y(o){r.pageSize=o,g()}function s(o){r.currentPage=o,g()}const v=m(!1),p=m(0),c=o=>{v.value=!0,o?p.value=o:p.value=0},C=o=>{Ie(o).then(()=>{O("删除成功",{type:"success"}),g()})},T=o=>{Ne(o).then(()=>{O("删除成功",{type:"success"}),g()})};function g(){u.value=!0;const o=D(B({},ve(a.value)),{pageSize:r.pageSize,currentPage:r.currentPage});o.created_at&&(o.created_at=Te(o.created_at)),De(o).then(({data:S})=>{t.value=S.items,r.total=S.total,r.pageSize=S.pageSize,r.currentPage=S.currentPage,pe(()=>{e.value&&e.value.getTableRef().clearSelection()})}).finally(()=>{u.value=!1})}return{loading:u,search:a,dataList:t,pagination:r,handleSizeChange:y,handleCurrentChange:s,onSearch:g,onReset:()=>{g()},onCollapse:()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},500)},showStore:v,updateId:p,handleStore:c,handleDestroy:C,handleBatchDestroy:T}}const A=[{value:"AF",label:"阿富汗"},{value:"AL",label:"阿尔巴尼亚"},{value:"DZ",label:"阿尔及利亚"},{value:"AD",label:"安道尔"},{value:"AO",label:"安哥拉"},{value:"AG",label:"安提瓜和巴布达"},{value:"AR",label:"阿根廷"},{value:"AM",label:"亚美尼亚"},{value:"AU",label:"澳大利亚"},{value:"AT",label:"奥地利"},{value:"AZ",label:"阿塞拜疆"},{value:"BS",label:"巴哈马"},{value:"BH",label:"巴林"},{value:"BD",label:"孟加拉国"},{value:"BB",label:"巴巴多斯"},{value:"BY",label:"白俄罗斯"},{value:"BE",label:"比利时"},{value:"BZ",label:"伯利兹"},{value:"BJ",label:"贝宁"},{value:"BT",label:"不丹"},{value:"BO",label:"玻利维亚"},{value:"BA",label:"波斯尼亚和黑塞哥维那"},{value:"BW",label:"博茨瓦纳"},{value:"BR",label:"巴西"},{value:"BN",label:"文莱"},{value:"BG",label:"保加利亚"},{value:"BF",label:"布基纳法索"},{value:"BI",label:"布隆迪"},{value:"KH",label:"柬埔寨"},{value:"CM",label:"喀麦隆"},{value:"CA",label:"加拿大"},{value:"CV",label:"佛得角"},{value:"CF",label:"中非共和国"},{value:"TD",label:"乍得"},{value:"CL",label:"智利"},{value:"CN",label:"中国"},{value:"CO",label:"哥伦比亚"},{value:"KM",label:"科摩罗"},{value:"CG",label:"刚果（布）"},{value:"CD",label:"刚果（金）"},{value:"CR",label:"哥斯达黎加"},{value:"CI",label:"科特迪瓦"},{value:"HR",label:"克罗地亚"},{value:"CU",label:"古巴"},{value:"CY",label:"塞浦路斯"},{value:"CZ",label:"捷克"},{value:"DK",label:"丹麦"},{value:"DJ",label:"吉布提"},{value:"DM",label:"多米尼克"},{value:"DO",label:"多米尼加共和国"},{value:"EC",label:"厄瓜多尔"},{value:"EG",label:"埃及"},{value:"SV",label:"萨尔瓦多"},{value:"GQ",label:"赤道几内亚"},{value:"ER",label:"厄立特里亚"},{value:"EE",label:"爱沙尼亚"},{value:"ET",label:"埃塞俄比亚"},{value:"FJ",label:"斐济"},{value:"FI",label:"芬兰"},{value:"FR",label:"法国"},{value:"GA",label:"加蓬"},{value:"GM",label:"冈比亚"},{value:"GE",label:"格鲁吉亚"},{value:"DE",label:"德国"},{value:"GH",label:"加纳"},{value:"GR",label:"希腊"},{value:"GD",label:"格林纳达"},{value:"GT",label:"危地马拉"},{value:"GN",label:"几内亚"},{value:"GW",label:"几内亚比绍"},{value:"GY",label:"圭亚那"},{value:"HT",label:"海地"},{value:"HN",label:"洪都拉斯"},{value:"HU",label:"匈牙利"},{value:"IS",label:"冰岛"},{value:"IN",label:"印度"},{value:"ID",label:"印度尼西亚"},{value:"IR",label:"伊朗"},{value:"IQ",label:"伊拉克"},{value:"IE",label:"爱尔兰"},{value:"IL",label:"以色列"},{value:"IT",label:"意大利"},{value:"JM",label:"牙买加"},{value:"JP",label:"日本"},{value:"JO",label:"约旦"},{value:"KZ",label:"哈萨克斯坦"},{value:"KE",label:"肯尼亚"},{value:"KI",label:"基里巴斯"},{value:"KP",label:"朝鲜"},{value:"KR",label:"韩国"},{value:"KW",label:"科威特"},{value:"KG",label:"吉尔吉斯斯坦"},{value:"LA",label:"老挝"},{value:"LV",label:"拉脱维亚"},{value:"LB",label:"黎巴嫩"},{value:"LS",label:"莱索托"},{value:"LR",label:"利比里亚"},{value:"LY",label:"利比亚"},{value:"LI",label:"列支敦士登"},{value:"LT",label:"立陶宛"},{value:"LU",label:"卢森堡"},{value:"MK",label:"北马其顿"},{value:"MG",label:"马达加斯加"},{value:"MW",label:"马拉维"},{value:"MY",label:"马来西亚"},{value:"MV",label:"马尔代夫"},{value:"ML",label:"马里"},{value:"MT",label:"马耳他"},{value:"MH",label:"马绍尔群岛"},{value:"MR",label:"毛里塔尼亚"},{value:"MU",label:"毛里求斯"},{value:"MX",label:"墨西哥"},{value:"FM",label:"密克罗尼西亚"},{value:"MD",label:"摩尔多瓦"},{value:"MC",label:"摩纳哥"},{value:"MN",label:"蒙古"},{value:"ME",label:"黑山"},{value:"MA",label:"摩洛哥"},{value:"MZ",label:"莫桑比克"},{value:"MM",label:"缅甸"},{value:"NA",label:"纳米比亚"},{value:"NR",label:"瑙鲁"},{value:"NP",label:"尼泊尔"},{value:"NL",label:"荷兰"},{value:"NZ",label:"新西兰"},{value:"NI",label:"尼加拉瓜"},{value:"NE",label:"尼日尔"},{value:"NG",label:"尼日利亚"},{value:"NO",label:"挪威"},{value:"OM",label:"阿曼"},{value:"PK",label:"巴基斯坦"},{value:"PW",label:"帕劳"},{value:"PA",label:"巴拿马"},{value:"PG",label:"巴布亚新几内亚"},{value:"PY",label:"巴拉圭"},{value:"PE",label:"秘鲁"},{value:"PH",label:"菲律宾"},{value:"PL",label:"波兰"},{value:"PT",label:"葡萄牙"},{value:"QA",label:"卡塔尔"},{value:"RO",label:"罗马尼亚"},{value:"RU",label:"俄罗斯"},{value:"RW",label:"卢旺达"},{value:"KN",label:"圣基茨和尼维斯"},{value:"LC",label:"圣卢西亚"},{value:"VC",label:"圣文森特和格林纳丁斯"},{value:"WS",label:"萨摩亚"},{value:"SM",label:"圣马力诺"},{value:"ST",label:"圣多美和普林西比"},{value:"SA",label:"沙特阿拉伯"},{value:"SN",label:"塞内加尔"},{value:"RS",label:"塞尔维亚"},{value:"SC",label:"塞舌尔"},{value:"SL",label:"塞拉利昂"},{value:"SG",label:"新加坡"},{value:"SK",label:"斯洛伐克"},{value:"SI",label:"斯洛文尼亚"},{value:"SB",label:"所罗门群岛"},{value:"SO",label:"索马里"},{value:"ZA",label:"南非"},{value:"SS",label:"南苏丹"},{value:"ES",label:"西班牙"},{value:"LK",label:"斯里兰卡"},{value:"SD",label:"苏丹"},{value:"SR",label:"苏里南"},{value:"SZ",label:"斯威士兰"},{value:"SE",label:"瑞典"},{value:"CH",label:"瑞士"},{value:"SY",label:"叙利亚"},{value:"TJ",label:"塔吉克斯坦"},{value:"TZ",label:"坦桑尼亚"},{value:"TH",label:"泰国"},{value:"TL",label:"东帝汶"},{value:"TG",label:"多哥"},{value:"TO",label:"汤加"},{value:"TT",label:"特立尼达和多巴哥"},{value:"TN",label:"突尼斯"},{value:"TR",label:"土耳其"},{value:"TM",label:"土库曼斯坦"},{value:"TV",label:"图瓦卢"},{value:"UG",label:"乌干达"},{value:"UA",label:"乌克兰"},{value:"AE",label:"阿拉伯联合酋长国"},{value:"GB",label:"英国"},{value:"US",label:"美国"},{value:"UY",label:"乌拉圭"},{value:"UZ",label:"乌兹别克斯坦"},{value:"VU",label:"瓦努阿图"},{value:"VA",label:"梵蒂冈"},{value:"VE",label:"委内瑞拉"},{value:"VN",label:"越南"},{value:"YE",label:"也门"},{value:"ZM",label:"赞比亚"},{value:"ZW",label:"津巴布韦"},{value:"HK",label:"中国香港"},{value:"MO",label:"中国澳门"},{value:"TW",label:"中国台湾"}];function Ge(e){const a=ce(()=>{e()},500);return{searchColumns:[{label:"快速搜索",prop:"quickSearch",valueType:"input",fieldProps:{placeholder:"用户名/名称/注册号/电话"},onChange:()=>{a()}},{label:"用户名",prop:"username",valueType:"input",fieldProps:{placeholder:"请输入用户名"},onChange:()=>{a()}},{label:"名称",prop:"name",valueType:"input",fieldProps:{placeholder:"请输入组织名称"}},{label:"注册号",prop:"registration_number",valueType:"input",fieldProps:{placeholder:"请输入注册号"}},{label:"国家",prop:"country",valueType:"select",fieldProps:{placeholder:"请选择国家"},options:A.map(u=>({label:u.label,value:u.value}))},{label:"电话",prop:"phone",valueType:"input",fieldProps:{placeholder:"请输入电话",type:"number"}},{label:"创建时间",prop:"created_at",valueType:"date-picker",fieldProps:{type:"daterange",rangeSeparator:"至",startPlaceholder:"开始日期",endPlaceholder:"结束日期",valueFormat:"YYYY-MM-DD",shortcuts:Pe()}}]}}function Ve(e){const a=m(!1),t=m(),u=m(0),r=m({}),y=[{label:"用户",prop:"user_id",valueType:"select",renderField:(d,i)=>b(Me,{modelValue:d,uri:"/user",searchField:"quickSearch",labelField:"username",valueField:"id",itemsField:"items",totalField:"total",placeholder:"请选择用户",onChange:i,refreshKey:u.value},null)},{label:"名称",prop:"name",valueType:"input",fieldProps:{placeholder:"请输入组织名称"}},{label:"注册号",prop:"registration_number",valueType:"input",fieldProps:{placeholder:"请输入注册号"}},{label:"国家",prop:"country",valueType:"select",fieldProps:{placeholder:"请选择国家"},options:A},{label:"省份",prop:"state",valueType:"input",fieldProps:{placeholder:"请输入省份"}},{label:"城市",prop:"city",valueType:"input",fieldProps:{placeholder:"请输入城市"}},{label:"地址",prop:"address",valueType:"textarea",fieldProps:{placeholder:"请输入地址",rows:3}},{label:"电话",prop:"phone",valueType:"input",fieldProps:{placeholder:"请输入电话",type:"number"}},{label:"邮编",prop:"postcode",valueType:"input",fieldProps:{placeholder:"请输入邮编"}}],s={user_id:[{required:!0,message:"请选择用户",trigger:"blur"}],name:[{required:!0,message:"请输入组织名称",trigger:"blur"}],registration_number:[{required:!0,message:"请输入注册号",trigger:"blur"}],country:[{required:!0,message:"请选择国家",trigger:"blur"}],state:[{required:!0,message:"请输入省份",trigger:"blur"}],city:[{required:!0,message:"请输入城市",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{pattern:/^[0-9]{1,15}$/,message:"请输入正确的格式",trigger:"blur"}],postcode:[{required:!0,message:"请输入邮编",trigger:"blur"}]};function v(d=0){var i,o;a.value=!0,d>0?u.value!==d&&C(d):((o=(i=t.value)==null?void 0:i.formInstance)==null||o.resetFields(),r.value=Object.fromEntries(Object.entries(K).filter(([S,P])=>P!==0&&P!==""))),u.value=d}function p(){u.value>0?g():T()}function c(){a.value=!1}const C=d=>{Fe(d).then(({data:i})=>{r.value=Re(i,ke)})},T=()=>{Ae(r.value).then(()=>{e(),a.value=!1})},g=()=>{Ee(u.value,r.value).then(()=>{e(),a.value=!1})};return{showStore:a,storeRef:t,storeId:u,storeValues:r,storeColumns:y,rules:s,openStoreForm:v,confirmStoreForm:p,closeStoreForm:c}}function Le(){const e=m(),a=m([]),t=s=>{a.value=s.map(v=>v.id),e.value.setAdaptive()},u=()=>{a.value=[],e.value.getTableRef().clearSelection()},r=[{label:"勾选列",type:"selection",reserveSelection:!0},{label:"ID",prop:"id",minWidth:80},{label:"用户名",prop:"user.username",minWidth:100,cellRenderer:de("user.username")},{label:"名称",prop:"name",minWidth:120},{label:"注册号",prop:"registration_number",minWidth:120},{label:"国家",prop:"country",minWidth:100,formatter:({country:s})=>{var v;return(v=A.find(p=>p.value===s))==null?void 0:v.label}},{label:"电话",prop:"phone",minWidth:120},{label:"创建时间",prop:"created_at",minWidth:180,formatter:({created_at:s})=>s?me(s).format("YYYY-MM-DD HH:mm:ss"):"-"},{label:"操作",fixed:"right",width:110,slot:"operation"}];return{tableRef:e,selectedIds:a,tableColumns:r,handleSelectionChange:t,handleCancelSelection:u,handleRowClick:(s,v,p)=>{var C;const c=p.target;c.tagName==="BUTTON"||c.closest("button")||c.closest(".el-button")||(C=e.value)==null||C.getTableRef().toggleRowSelection(s)}}}const Ke={class:"main"},Ue={class:"search bg-bg_color w-[99/100] pl-4 pr-4 pt-[24px] pb-[12px] overflow-auto"},Ye={key:0,class:"bg-[var(--el-fill-color-light)] w-full h-[46px] mb-2 pl-3 pr-2 flex items-center"},We={class:"flex-auto"},He={style:{"font-size":"var(--el-font-size-base)"},class:"text-[rgba(42,46,54,0.5)] dark:text-[rgba(220,220,242,0.5)] ml-2"},Ze=ge({name:"Organization",__name:"index",setup(e){const{drawerSize:a}=ze(),{tableRef:t,selectedIds:u,handleSelectionChange:r,handleCancelSelection:y,tableColumns:s,handleRowClick:v}=Le(),{loading:p,search:c,dataList:C,pagination:T,handleSizeChange:g,handleCurrentChange:d,onSearch:i,onReset:o,onCollapse:S,handleDestroy:P,handleBatchDestroy:U}=Oe(t),{searchColumns:Y}=Ge(()=>i()),{storeRef:W,showStore:H,storeId:Z,storeColumns:q,rules:$,storeValues:z,openStoreForm:E,confirmStoreForm:J,closeStoreForm:j}=Ve(()=>i());return fe(()=>{i()}),(qe,n)=>{const R=M("el-button"),Q=M("el-tooltip"),F=M("el-popconfirm"),X=M("pure-table"),ee=ye("motion-fade");return V(),G("div",Ke,[k("div",Ue,[b(l(se),{modelValue:l(c),"onUpdate:modelValue":n[0]||(n[0]=h=>L(c)?c.value=h:null),columns:l(Y),"show-number":1,"row-props":{gutter:12},"col-props":{xs:24,sm:12,md:8,lg:6,xl:4},"label-width":"80","label-position":"right","label-suffix":"","search-text":"搜索","reset-text":"重置","expand-text":"展开","retract-text":"收起",onSearch:l(i),onReset:l(o),onCollapse:l(S)},null,8,["modelValue","columns","onSearch","onReset","onCollapse"])]),b(l(ie),{title:"组织管理",columns:l(s),onRefresh:l(i)},{buttons:f(()=>[b(R,{type:"primary",onClick:n[1]||(n[1]=h=>l(E)())},{default:f(()=>n[4]||(n[4]=[x("新增组织")])),_:1})]),default:f(({size:h,dynamicColumns:le})=>[l(u).length>0?he((V(),G("div",Ye,[k("div",We,[b(Q,{placement:"top",content:"取消选择"},{default:f(()=>[b(R,{type:"primary",size:"small",class:"!w-[15px] !p-0 !h-[15px] !rounded-[3px]",icon:l(xe)(l(we)),onClick:l(y)},null,8,["icon","onClick"])]),_:1}),k("span",He," 已选 "+Se(l(u).length)+" 项 ",1)]),b(F,{title:"确定要删除吗？",width:"160px",onConfirm:n[2]||(n[2]=w=>l(U)(l(u)))},{reference:f(()=>[b(R,{type:"danger",size:"small"},{default:f(()=>n[5]||(n[5]=[x(" 批量删除 ")])),_:1})]),_:1})])),[[ee]]):Ce("",!0),b(X,{ref_key:"tableRef",ref:t,"row-key":"id","align-whole":"left","table-layout":"auto",loading:l(p),size:h,adaptive:"",adaptiveConfig:{offsetBottom:108},data:l(C),columns:le,pagination:D(B({},l(T)),{size:h}),"header-cell-style":{background:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)"},onRowClick:l(v),onSelectionChange:l(r),onPageSizeChange:l(g),onPageCurrentChange:l(d)},{operation:f(({row:w})=>[b(R,{class:"reset-margin !outline-none",type:"primary",link:"",size:h,onClick:ae=>l(E)(w.id)},{default:f(()=>n[6]||(n[6]=[x(" 编辑 ")])),_:2},1032,["size","onClick"]),b(F,{title:"确定要删除吗？",width:"160px",onConfirm:ae=>l(P)(w.id)},{reference:f(()=>[b(R,{class:"reset-margin !outline-none",link:"",type:"danger",size:h},{default:f(()=>n[7]||(n[7]=[x(" 删除 ")])),_:2},1032,["size"])]),_:2},1032,["onConfirm"])]),_:2},1032,["loading","size","data","columns","pagination","onRowClick","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"]),b(l(Be),{ref_key:"storeRef",ref:W,modelValue:l(z),"onUpdate:modelValue":n[3]||(n[3]=h=>L(z)?z.value=h:null),visible:l(H),form:{columns:l(q),rules:l($),labelPosition:"right",labelSuffix:""},size:l(a),closeOnClickModal:!0,title:l(Z)>0?"编辑组织":"新增组织",confirmText:"提交",cancelText:"取消",onConfirm:l(J),onCancel:l(j)},null,8,["modelValue","visible","form","size","title","onConfirm","onCancel"])])}}}),nl=_e(Ze,[["__scopeId","data-v-b3c2c414"]]);export{nl as default};
